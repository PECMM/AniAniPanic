<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:title" content="ポポイントカード履歴管理">
  <meta property="og:url"   content="https://pecmm.github.io/popoint/ReportGenerator.html" />
  <meta property="og:image" content="https://pecmm.github.io/popoint/thumb/ReportGenerator.png?08226fe9">
  <title>ポポイントカード履歴管理</title>
  <link rel='stylesheet' href='../assets/accordion.css' />
  <link rel='stylesheet' href='../assets/tooltip.css' />
  <style>
    #userInputArea {
      margin-bottom: 1em;
    }
    #userInputArea label {
      user-select: none;
    }
    #userInputArea #settingTable th {
      text-align: right;
    }
    #userInputArea > table {
      margin-bottom: 1em;
    }
    #imageTypeUserImageArea > #files {
      text-align: right;
    }
    #imageTypeUserImageArea input[type='file'] {
      margin-top: 5px;
      padding: 20px;
      width: 360px;
      background-color: #DDDDDD;
    }
    
    .numberinput {
      width: 6em;
      text-align: right;
    }
    .textinput {
      min-width: 32em;
    }
    
    #logEntryTable {
      margin-top: 1em;
      border-collapse: collapse;
      white-space: nowrap;
    }
    #logEntryTable thead {
      border-bottom-style: double;
    }
    #logEntryTable tr:hover td {
      background-color: #FFFFCC;
    }
    #logEntryTable button {
      font-size: 75%;
    }
    #logEntryTable .number-cell {
      text-align: right;
      padding-left : 0.5em;
      padding-right: 0.5em;
    }
    #logEntryTable .text-cell {
      padding-left : 0.5em;
      padding-right: 0.5em;
    }
    
    #resultArea canvas {
      border: solid 2px blue;
    }
    #resultArea canvas:hover {
      border-color: red;
    }
    
    #helpArea * {
      font-size: 0.95em;
    }
    #helpArea .titleHeader {
      border-bottom: solid #999999 1px;
      margin-bottom: 0.2em;
      padding-left: 0.5em;
      background-color: #EEEEEE;
    }
    #helpArea #accordion-ontime-item > ul {
      margin-top    : 0px;
      margin-bottom : 0.5em;
      padding-top   : 0.2em;
      padding-bottom: 0.2em;
    }
  </style>
</head>

<body>
  <h1>ポポイントカード履歴管理</h1>
  
  <div>ver: <span id="version"></span></div>
  <div id='helpArea' class='accordion-box'>
    <input id='help-accordion-check' class='accordion-check' type='checkbox' />
    <label for='help-accordion-check' class='accordion-ontime' >■Helpを隠す</label>
    <label for='help-accordion-check' class='accordion-offtime'>■Helpを表示</label>
    <div class='accordion-ontime'>
      <div class='accordion-ontime-item'>
        <span class='titleHeader' style='display:block;'>ログの保存・公開</span>
        <ul>
          <li>ブラウザの機能でログを記録しているので、複数環境でのログ共有は対応していません。<br />(ページ表示以降は通信によるデータ送受信はしていま
          せん)</li>
          <li>他ユーザへのログ公開はレポートの画像保存機能のみで対応しています。</li>
        </ul>
        <span class='titleHeader' style='display:block;'>操作</span>
        <ul>
          <li>元に戻す機能はないので、『入力をブラウザに保存』せずに画面リロードなどで前回保存直後に戻してください。</li>
        </ul>
        <span class='titleHeader' style='display:block;'>カード・スタンプの画像について</span>
        <ul>
          <li>サイズおよびスタンプ・名前の位置さえ合っていれば、好きな画像を使用できます。
            <ul>
              <li>カードの画像： 1074x649(px)</li>
              <li>スタンプ画像： 300x250(px)</li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </div>
  
  <div id='userInputArea'>
    <table id='logEntryTable' border='1'>
      <caption>ログ</caption>
      <thead></thead>
      <tbody></tbody>
    </table>
    <table id='settingTable' border='1' cellpadding='5'>
      <caption>レポート設定</caption>
      <tr> <th>なまえ</th> <td><input type='text' id='userName' /></td> </tr>
      <tr> <th>スタンプ</th> <td><label><input type='checkbox' id='randomStamping' class='tltp-on-hover tltp-always'>雑にスタンプを押す</label></td> </tr>
      <tr> <th>画像タイプ</th> <td>
        <select id='imageTypeSelector'>
          <option value='simple'>シンプル</option>
          <option value='userImage'>ユーザの画像</option>
        </select>
        <div id='imageTypeUserImageArea'>
          <hr />
          <div id='files'>
              <label>カード画像：<input type='file' accept='image/*' id='cardUserImage' ></label><br />
            <label>スタンプ画像：<input type='file' accept='image/*' id='stampUserImage'></label><br />
          </div>
          <div id='errorMessageArea'></div>
        </div>
      </td> </tr>
    </table>
    
    <hr />
    <button id='saveInput'>入力をブラウザに保存</button>
    <button id='showReport' class='tltp-on-hover tltp-always tltp-top' data-tltp-text=''>レポート表示</button>
    <button id='clearReport'>表示クリア</button>
  </div>
  <div id='resultArea'>
  </div>
  
  
  <script>
    const AppVersion = "1.1.0";
    
    // ここから
const _0x20799b=_0x27d6;(function(_0xfc853e,_0x1b2b75){const _0x42eaf4=_0x27d6,_0x5c6689=_0xfc853e();while(!![]){try{const _0x466b45=-parseInt(_0x42eaf4(0x18a))/0x1*(-parseInt(_0x42eaf4(0x25e))/0x2)+parseInt(_0x42eaf4(0x19a))/0x3+-parseInt(_0x42eaf4(0x277))/0x4+parseInt(_0x42eaf4(0x271))/0x5+parseInt(_0x42eaf4(0x27a))/0x6*(-parseInt(_0x42eaf4(0x1cd))/0x7)+-parseInt(_0x42eaf4(0x1f4))/0x8+-parseInt(_0x42eaf4(0x1cf))/0x9;if(_0x466b45===_0x1b2b75)break;else _0x5c6689['push'](_0x5c6689['shift']());}catch(_0xe5a981){_0x5c6689['push'](_0x5c6689['shift']());}}}(_0x397a,0xadf48),document['querySelector'](_0x20799b(0x233))['textContent']=AppVersion);function randomRangedInt(_0x37894c,_0xe45ea0){const _0x5cec92=_0x20799b;return Math[_0x5cec92(0x1ad)](Math[_0x5cec92(0x1b0)]()*(_0xe45ea0-_0x37894c+0x1))+_0x37894c;}function newElem(_0x10ddc8,_0x5745e2=[],_0x537806=[],_0x2f8637={}){const _0x3de3b8=_0x20799b,_0x3cb642=document[_0x3de3b8(0x1de)](_0x10ddc8);return _0x537806[_0x3de3b8(0x1a3)]>0x0&&_0x3cb642[_0x3de3b8(0x1b3)]['add'](..._0x537806),Object[_0x3de3b8(0x18e)](_0x2f8637)[_0x3de3b8(0x202)](_0x671773=>{const _0x4f580c=_0x3de3b8;_0x3cb642[_0x4f580c(0x1c5)](_0x671773,_0x2f8637[_0x671773]);}),_0x5745e2[_0x3de3b8(0x202)](_0x16d35a=>{const _0x49ca24=_0x3de3b8;typeof _0x16d35a===_0x49ca24(0x1c9)?_0x3cb642[_0x49ca24(0x23f)](document['createTextNode'](_0x16d35a)):_0x3cb642['appendChild'](_0x16d35a);}),_0x3cb642;}function loadSyncImage(_0x36def5){return new Promise((_0x52d21f,_0xe40454)=>{const _0x255a9e=_0x27d6,_0x362a4c=new Image();_0x362a4c['onload']=()=>_0x52d21f(_0x362a4c),_0x362a4c['onerror']=_0x1ecb8e=>_0xe40454(_0x1ecb8e),_0x362a4c[_0x255a9e(0x1b7)]=_0x36def5;});}function readInputFileSrc(_0x301144){return new Promise((_0x526303,_0x439a64)=>{const _0x51e71d=_0x27d6,_0x13dad1=new FileReader();_0x13dad1[_0x51e71d(0x1ca)]=()=>_0x526303(_0x13dad1[_0x51e71d(0x270)]),_0x13dad1[_0x51e71d(0x227)]=_0x2bcf7b=>_0x439a64(_0x2bcf7b),_0x13dad1['readAsDataURL'](_0x301144);});}function srcToURL(_0x1cfa69){const _0x2e5ca4=_0x20799b,_0x58794d=atob(_0x1cfa69[_0x2e5ca4(0x1e9)](',')[0x1]),_0x15053c=/:([a-zA-Z\/]+);/[_0x2e5ca4(0x241)](_0x1cfa69)[0x1],_0xa097af=Uint8Array[_0x2e5ca4(0x1a5)](_0x58794d[_0x2e5ca4(0x1e9)](''),_0x139675=>_0x139675['charCodeAt']()),_0x174fed=new Blob([_0xa097af],{'type':_0x15053c});return URL[_0x2e5ca4(0x1fd)](_0x174fed);}function pad0String(_0xce90d0,_0x1ab5e3){const _0xf83832=_0x20799b;return _0x1ab5e3[_0xf83832(0x200)]()['padStart'](_0xce90d0,'0');}function getDateStringForFile(_0x3087d1){const _0x4b6d2f=_0x20799b;return _0x3087d1[_0x4b6d2f(0x1c8)]()+'年'+pad0String(0x2,_0x3087d1[_0x4b6d2f(0x197)]()+0x1)+'月'+pad0String(0x2,_0x3087d1['getDate']())+'日-'+pad0String(0x2,_0x3087d1[_0x4b6d2f(0x292)]())+'時'+pad0String(0x2,_0x3087d1[_0x4b6d2f(0x1ec)]())+'分'+pad0String(0x2,_0x3087d1[_0x4b6d2f(0x19f)]())+'秒';}function getDateForDisplay(_0x19434a){const _0x30545f=_0x20799b;return _0x19434a[_0x30545f(0x1c8)]()+'/'+pad0String(0x2,_0x19434a[_0x30545f(0x197)]()+0x1)+'/'+pad0String(0x2,_0x19434a[_0x30545f(0x295)]());}function toValueFromDate(_0x15acd8){const _0x591b67=_0x20799b;return _0x15acd8[_0x591b67(0x1c8)]()+'-'+pad0String(0x2,_0x15acd8[_0x591b67(0x197)]()+0x1)+'-'+pad0String(0x2,_0x15acd8[_0x591b67(0x295)]());}const parseIntOr=(_0x10dfa3,_0x123e4c,_0x54f0d1)=>{const _0x3e7e2c=parseInt(_0x10dfa3,_0x123e4c);return Number['isNaN'](_0x3e7e2c)?_0x54f0d1:_0x3e7e2c;};function getInnerValue(_0xa94222,_0x187bf1,_0x57dc51){if(_0xa94222<_0x187bf1)return _0x187bf1;if(_0xa94222>_0x57dc51)return _0x57dc51;return _0xa94222;}function toSignedIntString(_0x1468ab){return(_0x1468ab<0x0?'':'+')+_0x1468ab;}function removeChildren(_0x4cd985){const _0x15437e=_0x20799b;while(_0x4cd985[_0x15437e(0x1f1)]){_0x4cd985['removeChild'](_0x4cd985[_0x15437e(0x1f1)]);}}function showConfirmTextDialog(_0x3e126f,_0x482c3f){const _0x4dabba=_0x20799b,_0x41d9bc=newElem('p',[_0x3e126f]);return _0x41d9bc[_0x4dabba(0x21d)][_0x4dabba(0x1f5)]=_0x4dabba(0x1d0),showConfirmDialog(_0x41d9bc,_0x482c3f);}function showConfirmDialog(_0x5369ad,_0x203d38){const _0x488345=_0x20799b;_0x203d38=Object['assign']({'baseElement':document[_0x488345(0x290)],'focusable':![],'yesLabel':'OK','noLabel':_0x488345(0x188),'defaultIsYes':!![],'positionElement':window},_0x203d38);const _0x79eb94=_0x203d38[_0x488345(0x29d)],_0x1af2f3=_0x203d38[_0x488345(0x22a)],_0xa6678f=_0x203d38[_0x488345(0x1dc)],_0x174a53=_0x203d38[_0x488345(0x24a)],_0x3ca0c6=_0x203d38['defaultIsYes'],_0x1e5201=_0x203d38[_0x488345(0x1e4)],_0x467547=_0x174a53==='',_0x37f81a=newElem(_0x488345(0x21b),[_0xa6678f]),_0x3662b0=newElem(_0x488345(0x21b),[_0x174a53]);_0x467547&&(_0x3662b0['style'][_0x488345(0x1c1)]='none');const _0x472470=_0x467547?[_0x37f81a]:[_0x37f81a,_0x3662b0],_0x4feed2=newElem(_0x488345(0x286),_0x472470),_0x37eb53=newElem('div',[_0x5369ad,newElem('hr'),_0x4feed2],[_0x488345(0x196)]),_0x11352c=newElem(_0x488345(0x286)),_0x8376d0=0xf423f;_0x37eb53[_0x488345(0x21d)][_0x488345(0x273)]=_0x488345(0x229),_0x37eb53['style'][_0x488345(0x210)]=_0x8376d0,_0x37eb53[_0x488345(0x21d)][_0x488345(0x28c)]='240px',_0x37eb53[_0x488345(0x21d)][_0x488345(0x20f)]='border-box',_0x37eb53[_0x488345(0x21d)][_0x488345(0x194)]=_0x488345(0x1a1),_0x37eb53[_0x488345(0x21d)][_0x488345(0x1fc)]='20px',_0x37eb53['style'][_0x488345(0x226)]=0x0,_0x37eb53[_0x488345(0x21d)][_0x488345(0x1a8)]='5px\x2030px\x2010px',_0x37eb53[_0x488345(0x21d)][_0x488345(0x1ea)]=_0x488345(0x1bd),_0x4feed2[_0x488345(0x21d)]['display']=_0x488345(0x297),_0x4feed2[_0x488345(0x21d)][_0x488345(0x1bf)]=_0x488345(0x269),_0x11352c[_0x488345(0x21d)][_0x488345(0x273)]='fixed',_0x11352c[_0x488345(0x21d)][_0x488345(0x210)]=_0x8376d0-0x1,_0x11352c[_0x488345(0x21d)]['top']=0x0,_0x11352c['style'][_0x488345(0x203)]=0x0,_0x11352c[_0x488345(0x21d)]['width']='100%',_0x11352c['style']['height']=_0x488345(0x27f),_0x11352c[_0x488345(0x21d)][_0x488345(0x194)]=_0x488345(0x282),_0x11352c[_0x488345(0x21d)][_0x488345(0x1a8)]='0px',_0x11352c[_0x488345(0x21d)]['margin']=_0x488345(0x282),_0x11352c['style'][_0x488345(0x1ea)]=_0x488345(0x20c),_0x11352c['style'][_0x488345(0x1c7)]=0.3;!_0x5369ad[_0x488345(0x21d)]['margin']&&!_0x5369ad[_0x488345(0x21d)][_0x488345(0x230)]&&!_0x5369ad['style'][_0x488345(0x1c2)]&&(_0x5369ad['style'][_0x488345(0x226)]=_0x488345(0x221));const _0x1d2ba7=function(_0x2d812a){const _0x3d7164=_0x488345,_0xf24ea1=_0x2d812a[0x0],_0x34a478=_0x2d812a[_0x2d812a[_0x3d7164(0x1a3)]-0x1],_0x50c983=[_0x34a478,_0x2d812a,_0xf24ea1][_0x3d7164(0x26f)]();return _0x21f704=>{const _0x53256d=_0x3d7164;if(_0x21f704[_0x53256d(0x19b)]===_0x53256d(0x261)&&!_0x21f704['altKey']&&!_0x21f704[_0x53256d(0x27c)]&&!_0x21f704[_0x53256d(0x232)]){_0x21f704['stopPropagation'](),_0x21f704['preventDefault']();const _0x402ca1=_0x50c983[_0x53256d(0x18f)](_0x21f704[_0x53256d(0x29a)],0x1);_0x402ca1===-0x1?(_0x21f704[_0x53256d(0x248)]?_0x34a478:_0xf24ea1)[_0x53256d(0x287)]():_0x50c983[_0x402ca1+(_0x21f704[_0x53256d(0x248)]?-0x1:0x1)][_0x53256d(0x287)]();}else _0x21f704[_0x53256d(0x19b)]==='Escape'&&!_0x21f704[_0x53256d(0x28e)]&&!_0x21f704[_0x53256d(0x27c)]&&!_0x21f704[_0x53256d(0x248)]&&!_0x21f704[_0x53256d(0x232)]&&(_0x21f704['stopPropagation'](),_0x21f704['preventDefault'](),_0x3662b0['click']());};},_0x5d50d3=Array[_0x488345(0x235)](_0x1af2f3)?_0x1af2f3[_0x488345(0x245)](_0x472470):_0x472470,_0x49fd3b=_0x1d2ba7(_0x5d50d3);_0x5d50d3['concat'](_0x37eb53,_0x11352c)[_0x488345(0x202)](_0x3dd728=>{const _0x5a5eca=_0x488345;_0x3dd728[_0x5a5eca(0x238)](_0x5a5eca(0x225),_0x49fd3b),_0x3dd728['addEventListener']('keypress',_0x49fd3b);}),_0x79eb94[_0x488345(0x23f)](_0x11352c),_0x79eb94[_0x488345(0x23f)](_0x37eb53);const _0x21d08b=window[_0x488345(0x19e)](_0x37eb53),_0x324ea7=_0x1e5201===window?{'width':window[_0x488345(0x1b1)],'height':window[_0x488345(0x1aa)]}:_0x1e5201[_0x488345(0x244)]();return _0x37eb53[_0x488345(0x21d)][_0x488345(0x23e)]=(_0x324ea7['height']-parseInt(_0x21d08b[_0x488345(0x1f9)],0xa))/0x2+'px',_0x37eb53[_0x488345(0x21d)][_0x488345(0x203)]=(_0x324ea7['width']-parseInt(_0x21d08b[_0x488345(0x1d4)],0xa))/0x2+'px',_0x467547||_0x3ca0c6?_0x37f81a['focus']():_0x3662b0[_0x488345(0x287)](),new Promise((_0x4530f2,_0x1da5ae)=>{const _0x38a840=_0x488345;_0x37f81a[_0x38a840(0x238)]('click',()=>{const _0x4fe2a8=_0x38a840;_0x472470[_0x4fe2a8(0x202)](_0x294db8=>_0x294db8[_0x4fe2a8(0x1c5)]('disabled',_0x4fe2a8(0x289))),_0x79eb94['removeChild'](_0x11352c),_0x79eb94[_0x4fe2a8(0x1d3)](_0x37eb53),_0x4530f2(!![]);}),_0x3662b0[_0x38a840(0x238)](_0x38a840(0x26e),()=>{const _0x2cc0b9=_0x38a840;_0x472470[_0x2cc0b9(0x202)](_0x364e43=>_0x364e43[_0x2cc0b9(0x1c5)](_0x2cc0b9(0x289),_0x2cc0b9(0x289))),_0x79eb94[_0x2cc0b9(0x1d3)](_0x11352c),_0x79eb94[_0x2cc0b9(0x1d3)](_0x37eb53),_0x4530f2(![]);});});}const StorageKey=_0x20799b(0x22c);async function generateReportCanvas(_0x3b693e,_0x3ab49c,_0x17309a,_0x5b4298){const _0x2adb8d=_0x20799b,_0x3383e0=newElem(_0x2adb8d(0x240));{_0x3383e0['width']=_0x5b4298[_0x2adb8d(0x258)],_0x3383e0[_0x2adb8d(0x1f9)]=_0x5b4298[_0x2adb8d(0x1e0)];const _0x5effe4=_0x3383e0['getContext']('2d');_0x5effe4['fillStyle']=_0x2adb8d(0x1bd),_0x5effe4[_0x2adb8d(0x1f8)](0x0,0x0,_0x5b4298[_0x2adb8d(0x258)],_0x5b4298['cardHeight']),_0x5effe4[_0x2adb8d(0x1fb)](_0x3b693e,0x0,0x0,_0x5b4298[_0x2adb8d(0x258)],_0x5b4298[_0x2adb8d(0x1e0)]),_0x5effe4[_0x2adb8d(0x1f0)]=0.5,_0x5effe4[_0x2adb8d(0x223)]=0x1,_0x5effe4[_0x2adb8d(0x1bc)]='#333333',_0x5effe4[_0x2adb8d(0x1ba)](0x0,0x0),_0x5effe4[_0x2adb8d(0x213)](_0x3383e0['width'],0x0),_0x5effe4[_0x2adb8d(0x213)](_0x3383e0[_0x2adb8d(0x1d4)],_0x3383e0[_0x2adb8d(0x1f9)]),_0x5effe4[_0x2adb8d(0x213)](0x0,_0x3383e0[_0x2adb8d(0x1f9)]),_0x5effe4[_0x2adb8d(0x213)](0x0,0x0),_0x5effe4['stroke']();}const _0xb47c67=newElem(_0x2adb8d(0x240));{_0xb47c67[_0x2adb8d(0x1d4)]=_0x3383e0[_0x2adb8d(0x1d4)],_0xb47c67['height']=_0x3383e0['height'];const _0x3a6576=_0xb47c67[_0x2adb8d(0x281)]('2d');_0x3a6576[_0x2adb8d(0x1fb)](_0x3383e0,0x0,0x0);{_0x3a6576['save'](),_0x3a6576[_0x2adb8d(0x294)]=_0x5b4298[_0x2adb8d(0x217)]+_0x2adb8d(0x1ab)+_0x17309a[_0x2adb8d(0x25d)]+'\x22';const _0x1231b3=_0x3a6576[_0x2adb8d(0x18c)](_0x17309a[_0x2adb8d(0x20e)]),_0x324324=_0x5b4298['userNameFontSize']*Math['min'](0x1,Math[_0x2adb8d(0x275)](_0x5b4298[_0x2adb8d(0x1e8)]/_0x1231b3[_0x2adb8d(0x1d4)],_0x5b4298[_0x2adb8d(0x29f)]/(_0x1231b3['actualBoundingBoxAscent']+_0x1231b3['actualBoundingBoxDescent'])));_0x3a6576[_0x2adb8d(0x20b)]='center',_0x3a6576[_0x2adb8d(0x280)]=_0x2adb8d(0x296),_0x3a6576[_0x2adb8d(0x23a)]=_0x2adb8d(0x1d1),_0x3a6576[_0x2adb8d(0x294)]=_0x324324+_0x2adb8d(0x1ab)+_0x17309a[_0x2adb8d(0x25d)]+'\x22';const _0x13685f=_0x3a6576['measureText'](_0x17309a['userName']);_0x3a6576['fillText'](_0x17309a[_0x2adb8d(0x20e)],_0x5b4298[_0x2adb8d(0x1a7)],_0x5b4298[_0x2adb8d(0x26d)]-_0x13685f[_0x2adb8d(0x254)]),_0x3a6576[_0x2adb8d(0x25f)]();}const _0x749ab=newElem(_0x2adb8d(0x240));{const _0x15f419=_0x5b4298[_0x2adb8d(0x247)]*_0x5b4298['stampSizeRate'],_0xa7fbe8=_0x5b4298['stampHeight']*_0x5b4298[_0x2adb8d(0x18d)];_0x749ab[_0x2adb8d(0x1d4)]=_0x749ab[_0x2adb8d(0x1f9)]=Math[_0x2adb8d(0x1a2)](_0x15f419,_0xa7fbe8);const _0x4463b=_0x749ab['getContext']('2d');_0x4463b[_0x2adb8d(0x1fb)](_0x3ab49c,(_0x749ab[_0x2adb8d(0x1d4)]-_0x15f419)/0x2,(_0x749ab[_0x2adb8d(0x1f9)]-_0xa7fbe8)/0x2,_0x15f419,_0xa7fbe8);}let _0x1a4f94=(_0x5818e8=>_0x5818e8%0x14===0x0&&_0x5818e8>=0x14?0x14:_0x5818e8%0x14)(_0x17309a[_0x2adb8d(0x195)]);for(let _0x15f347=0x0;_0x1a4f94>0x0;_0x1a4f94-=0x5,_0x15f347++){const _0x1338fb=Math[_0x2adb8d(0x275)](_0x1a4f94,0x5);for(let _0x421079=0x0;_0x421079<_0x1338fb;_0x421079++){const _0x1a8d09=_0x5b4298[_0x2adb8d(0x220)]+_0x5b4298[_0x2adb8d(0x1c3)]*_0x421079-_0x5b4298[_0x2adb8d(0x198)]/0x2,_0x47590a=_0x5b4298['stampOffsetY']+_0x5b4298[_0x2adb8d(0x228)]*_0x15f347,_0x368142=_0x5b4298[_0x2adb8d(0x22e)]+randomRangedInt(-_0x5b4298[_0x2adb8d(0x243)],_0x5b4298['stampRandomPosHalfRange']),_0x3f4d45=_0x5b4298[_0x2adb8d(0x26b)]+randomRangedInt(-_0x5b4298[_0x2adb8d(0x243)],_0x5b4298[_0x2adb8d(0x243)]);_0x17309a['randomStamping']?(_0x3a6576[_0x2adb8d(0x22f)](),_0x3a6576['translate'](_0x1a8d09+_0x368142,_0x47590a+_0x3f4d45),_0x3a6576[_0x2adb8d(0x219)](0x2*Math['PI']*Math['random']()),_0x3a6576['drawImage'](_0x749ab,-_0x368142,-_0x3f4d45),_0x3a6576[_0x2adb8d(0x25f)]()):_0x3a6576['drawImage'](_0x749ab,_0x1a8d09,_0x47590a);}}}{const _0x511c69=newElem(_0x2adb8d(0x240));_0x511c69[_0x2adb8d(0x1d4)]=_0x5b4298[_0x2adb8d(0x29e)],_0x511c69[_0x2adb8d(0x1f9)]=_0x5b4298[_0x2adb8d(0x1ac)];let _0x33d013=_0x511c69['getContext']('2d');{_0x33d013[_0x2adb8d(0x22f)](),_0x33d013[_0x2adb8d(0x23a)]=_0x5b4298[_0x2adb8d(0x208)],_0x33d013[_0x2adb8d(0x294)]=_0x5b4298['titleFontSize']+_0x2adb8d(0x1ab)+_0x17309a[_0x2adb8d(0x25d)]+'\x22',_0x33d013[_0x2adb8d(0x20b)]='center',_0x33d013[_0x2adb8d(0x280)]=_0x2adb8d(0x296);const _0x4b6939=_0x33d013[_0x2adb8d(0x18c)](_0x5b4298[_0x2adb8d(0x242)]);_0x33d013[_0x2adb8d(0x1da)](_0x5b4298[_0x2adb8d(0x242)],_0x5b4298['reportWidth']/0x2,_0x5b4298[_0x2adb8d(0x21e)]-_0x4b6939[_0x2adb8d(0x254)]),_0x33d013[_0x2adb8d(0x25f)]();}const _0x1f7e3d=Math[_0x2adb8d(0x1a2)](Math[_0x2adb8d(0x1df)](_0x17309a[_0x2adb8d(0x195)]/0x14),0x1);let _0x38799d;{const _0x5d00be=_0x5b4298[_0x2adb8d(0x258)]+(_0x1f7e3d-0x1)*_0x5b4298[_0x2adb8d(0x201)];_0x38799d=(_0x5b4298[_0x2adb8d(0x29e)]-_0x5d00be)/0x2,Array['from']({'length':_0x1f7e3d-0x1},_0x13abdc=>_0x3383e0)[_0x2adb8d(0x245)](_0xb47c67)['forEach']((_0x1780b3,_0x463d6c)=>{const _0x31cd0f=_0x2adb8d;_0x33d013[_0x31cd0f(0x1fb)](_0x1780b3,_0x38799d+_0x463d6c*_0x5b4298[_0x31cd0f(0x201)],_0x5b4298[_0x31cd0f(0x276)]+_0x463d6c*_0x5b4298[_0x31cd0f(0x201)]);});}const _0x58daea=_0x5b4298[_0x2adb8d(0x276)]+_0x5b4298[_0x2adb8d(0x1e0)]+_0x5b4298['cardOffset']*_0x1f7e3d+_0x5b4298[_0x2adb8d(0x246)];{_0x33d013[_0x2adb8d(0x22f)](),_0x33d013[_0x2adb8d(0x23a)]=_0x5b4298[_0x2adb8d(0x208)],_0x33d013[_0x2adb8d(0x294)]=_0x5b4298['logSummaryFontSize']+_0x2adb8d(0x1ab)+_0x17309a[_0x2adb8d(0x25d)]+'\x22',_0x33d013[_0x2adb8d(0x280)]=_0x2adb8d(0x23e),_0x33d013[_0x2adb8d(0x20b)]=_0x2adb8d(0x203);const _0x53dd67=_0x2adb8d(0x193)+getDateForDisplay(new Date()),_0x36fb18=_0x33d013[_0x2adb8d(0x18c)](_0x53dd67);_0x33d013['fillText'](_0x53dd67,_0x38799d,_0x58daea-_0x36fb18['actualBoundingBoxDescent']),_0x33d013[_0x2adb8d(0x20b)]=_0x2adb8d(0x28d);const _0x1b1cdb=_0x2adb8d(0x239)+_0x17309a['stampCount'],_0x37313a=_0x33d013[_0x2adb8d(0x18c)](_0x1b1cdb);_0x33d013[_0x2adb8d(0x1da)](_0x1b1cdb,_0x5b4298[_0x2adb8d(0x29e)]-_0x38799d,_0x58daea-_0x37313a[_0x2adb8d(0x254)]),_0x33d013[_0x2adb8d(0x25f)]();}const _0x4e4423=_0x58daea+_0x5b4298[_0x2adb8d(0x24e)],_0x361f69=newElem('canvas');_0x361f69['width']=_0x511c69[_0x2adb8d(0x1d4)],_0x361f69['height']=_0x4e4423+_0x17309a['logEntries'][_0x2adb8d(0x1a3)]*_0x5b4298[_0x2adb8d(0x24f)]+_0x5b4298[_0x2adb8d(0x204)],_0x33d013=_0x361f69[_0x2adb8d(0x281)]('2d'),_0x33d013[_0x2adb8d(0x23a)]=_0x5b4298[_0x2adb8d(0x1b5)],_0x33d013[_0x2adb8d(0x1f8)](0x0,0x0,_0x5b4298[_0x2adb8d(0x29e)],_0x361f69[_0x2adb8d(0x1f9)]),_0x33d013[_0x2adb8d(0x1fb)](_0x511c69,0x0,0x0);{_0x33d013['save'](),_0x33d013[_0x2adb8d(0x23a)]=_0x5b4298['reportTextColor'],_0x33d013[_0x2adb8d(0x294)]=_0x5b4298[_0x2adb8d(0x1cb)]+_0x2adb8d(0x1ab)+_0x17309a['fontName']+'\x22';const _0x2ee024=(_0x5235a9,_0x49d469,_0x50f05a,_0x181cde,_0x3090f5)=>{const _0x1cd41e=_0x2adb8d;_0x33d013[_0x1cd41e(0x18c)](_0x5235a9)[_0x1cd41e(0x1d4)]>_0x181cde?(_0x33d013[_0x1cd41e(0x22f)](),_0x33d013['beginPath'](),_0x33d013['rect'](_0x49d469,_0x50f05a-_0x3090f5,_0x181cde,_0x3090f5*0x2),_0x33d013[_0x1cd41e(0x267)](),_0x33d013[_0x1cd41e(0x1da)](_0x5235a9,_0x49d469,_0x50f05a),_0x33d013[_0x1cd41e(0x25f)](),_0x33d013[_0x1cd41e(0x1da)](_0x1cd41e(0x249),_0x49d469+_0x181cde+0x3,_0x50f05a)):_0x33d013[_0x1cd41e(0x1da)](_0x5235a9,_0x49d469,_0x50f05a);},_0x3a86af=Array[_0x2adb8d(0x1a5)](new Set(_0x17309a[_0x2adb8d(0x291)][_0x2adb8d(0x1a9)](_0x4bb983=>_0x4bb983['ppt'])))[_0x2adb8d(0x285)]((_0x7d137e,_0x4106bb)=>_0x33d013['measureText'](toSignedIntString(_0x4106bb))[_0x2adb8d(0x1d4)],0x0)+_0x5b4298[_0x2adb8d(0x259)],_0x372c6c=_0x5b4298['logEntryFontSize'];_0x17309a[_0x2adb8d(0x291)][_0x2adb8d(0x285)]((_0x1a0ffb,_0x21f118,_0x55872e)=>{const _0x1be52d=_0x2adb8d;return _0x33d013[_0x1be52d(0x20b)]=_0x1be52d(0x28d),_0x33d013[_0x1be52d(0x1da)](_0x55872e+0x1,_0x5b4298['logItemIndexTextRight'],_0x1a0ffb),_0x33d013[_0x1be52d(0x20b)]=_0x1be52d(0x203),_0x33d013[_0x1be52d(0x1da)](_0x21f118[_0x1be52d(0x1d8)],_0x5b4298[_0x1be52d(0x222)],_0x1a0ffb),_0x33d013[_0x1be52d(0x20b)]='right',_0x33d013[_0x1be52d(0x1da)](toSignedIntString(_0x21f118[_0x1be52d(0x1b9)]),_0x5b4298[_0x1be52d(0x20d)]+_0x3a86af,_0x1a0ffb),_0x33d013[_0x1be52d(0x20b)]=_0x1be52d(0x203),_0x2ee024(_0x21f118[_0x1be52d(0x279)],_0x5b4298[_0x1be52d(0x1ff)]+_0x3a86af,_0x1a0ffb,_0x5b4298[_0x1be52d(0x1fe)],_0x372c6c),_0x2ee024(_0x21f118['remarks'],_0x5b4298[_0x1be52d(0x274)]+_0x3a86af,_0x1a0ffb,_0x5b4298[_0x1be52d(0x212)]-_0x3a86af,_0x372c6c),_0x1a0ffb+_0x5b4298[_0x1be52d(0x24f)];},_0x4e4423),_0x33d013[_0x2adb8d(0x25f)]();}return _0x361f69;}}function _0x27d6(_0x5a3081,_0x4a0be7){const _0x397a1c=_0x397a();return _0x27d6=function(_0x27d612,_0x386f55){_0x27d612=_0x27d612-0x186;let _0x2293f6=_0x397a1c[_0x27d612];return _0x2293f6;},_0x27d6(_0x5a3081,_0x4a0be7);}function _0x397a(){const _0x1e7395=['yesLabel','preventDefault','createElement','ceil','cardHeight','debugValues','nameLabelBorderWidth','ログ追加','positionElement','getItem','tltp-on-hover','circleLineWidth','userNameAreaWidth','split','backgroundColor','tltp-for-prev-input','getMinutes','font-weight:bold;','files','block','globalAlpha','firstChild','outerBorderWidth','stringify','9159192HcHiWo','whiteSpace','color','的ちゃん','fillRect','height','splice','drawImage','borderRadius','createObjectURL','logItemURLTextWidth','logItemURLTextLeft','toString','cardOffset','forEach','left','reportBottomMargin','tbody','getDay','nameLabelColor','reportTextColor','defaultValues','selectedIndex','textAlign','#000000','logItemPopointRight','userName','boxSizing','zIndex','debugMode','logItemRemarksTextWidth','lineTo','numberPaddingRight','sortLogEntries','#stampUserImage','userNameFontSize','#cardUserImage','rotate','value','button','#errorMessageArea','style','titleBottomY','logEntryDate','stampOffsetX','12px\x200','logItemDateTextLeft','lineWidth','text','keydown','margin','onerror','stampStepY','fixed','focusable','#resultArea','popointCard-lastInputValues','#randomStamping','stampCenterX','save','marginTop','setItem','metaKey','#version','#clearReport','isArray','logEntryURL','textinput','addEventListener','総スタンプ数：','fillStyle','innerBorderColor','表示確認用','#userName','top','appendChild','canvas','exec','titleText','stampRandomPosHalfRange','getBoundingClientRect','concat','logSummaryYOffset','stampWidth','shiftKey','...','noLabel','actualBoundingBoxAscent','numberinput','display:inline-block;\x20padding:0.5em;\x20color:#FF0000;\x20background-color:#FFFF00;\x20white-space:pre;','logEntryYOffset','logEntryLineHeight','randomStamping','#showReport','catch','maxIdNumber','actualBoundingBoxDescent','dataset','outerBorderColor','#logEntryTable','cardWidth','logItemPopointPadding','localStorage','circleRadius','localeCompare','fontName','1579140gCPHIi','restore','input','Tab','checked','numberPaddingBottom','toDataURL','imageType','画像の読み込みに失敗しました','clip','change','space-around','text-cell','stampCenterY','img','userNameBottomY','click','flat','result','6915055BztKHe','name','position','logItemRemarksTextLeft','min','cardStartY','219768XpzLut','then','url','76416VgUuVT','備考\x20','ctrlKey','stampHeight','label','100%','textBaseline','getContext','0px','logEntryPopoint','helps','reduce','div','focus','readonly','disabled','center','numberFontColor','minWidth','right','altKey','arc','body','logEntries','getHours','tltpText','font','getDate','bottom','flex','number','simple','target','nameLabelText','number-cell','baseElement','reportWidth','userNameAreaHeight','#imageTypeUserImageArea','now','nameLabelMarginHorizontal','Cancel','thead','1xYhiIR','dummyLogEntryURL','measureText','stampSizeRate','getOwnPropertyNames','indexOf','selfmadeStamp','fileInput','userImage','更新日：','border','drawingStampCount','confirmDialog','getMonth','stampOffsetXRightMarginForNumber','stroke','1986294ZXrJfA','key','dummyStampCount','ポポイントカード履歴-','getComputedStyle','getSeconds','numberFontHeightRate','solid\x20#DDDDDD\x203px','max','length','スタンプ画像が選択されていません。','from','#saveInput','userNameCenterX','padding','map','innerHeight','px\x20\x22','reportTempHeight','floor','ppt.\x20','tltp-always','random','innerWidth','px\x20\x22\x22','classList','土曜は２倍デー！','reportBackgroundColor','data-tltp-text','src','selfmadeCard','ppt','moveTo','tltpTexts','strokeStyle','#FFFFFF','fontSize','justifyContent','querySelector','display','marginBottom','stampStepX','logEntryRemarks','setAttribute','beginPath','opacity','getFullYear','string','onload','logEntryFontSize','nameLabelFontSize','56lBPlXX','none','7383870vlwoHk','pre-line','#666666','nameLabelPaddingBottom','removeChild','width','sort','join','remarks','date','push','fillText','layout'];_0x397a=function(){return _0x1e7395;};return _0x397a();}async function showReportImage(_0x210d4c,_0x193785){const _0x289cd0=_0x20799b,_0x189c5f=newElem(_0x289cd0(0x240));_0x189c5f[_0x289cd0(0x1d4)]=_0x193785['width'],_0x189c5f[_0x289cd0(0x1f9)]=_0x193785[_0x289cd0(0x1f9)],_0x189c5f[_0x289cd0(0x281)]('2d')[_0x289cd0(0x1fb)](_0x193785,0x0,0x0),_0x189c5f[_0x289cd0(0x238)]('contextmenu',_0x53e56e=>{const _0x15740=_0x289cd0;_0x53e56e[_0x15740(0x1dd)]();}),document[_0x289cd0(0x1c0)](_0x289cd0(0x22b))[_0x289cd0(0x23f)](newElem('a',[_0x189c5f],[],{'download':_0x289cd0(0x19d)+getDateStringForFile(new Date()),'href':srcToURL(_0x189c5f[_0x289cd0(0x264)]())}));}function generateCardAndStampImage(_0x291278){const _0x5e1b8e=_0x20799b,_0x1eb923=newElem('canvas');{_0x1eb923[_0x5e1b8e(0x1d4)]=_0x291278[_0x5e1b8e(0x258)],_0x1eb923['height']=_0x291278[_0x5e1b8e(0x1e0)];const _0x3f8efb=_0x1eb923[_0x5e1b8e(0x281)]('2d');_0x3f8efb[_0x5e1b8e(0x23a)]=_0x291278[_0x5e1b8e(0x1b8)]['backgroundColor'],_0x3f8efb[_0x5e1b8e(0x1f8)](0x0,0x0,_0x291278[_0x5e1b8e(0x258)],_0x291278[_0x5e1b8e(0x1e0)]);{const _0x106365=_0x291278['stampOffsetX']+_0x291278[_0x5e1b8e(0x22e)]-_0x291278[_0x5e1b8e(0x1c3)]/0x2,_0x402c1f=_0x291278['stampOffsetY']+_0x291278[_0x5e1b8e(0x26b)]-_0x291278[_0x5e1b8e(0x228)]/0x2,_0x151984=0x5*_0x291278[_0x5e1b8e(0x1c3)],_0x1b088c=0x4*_0x291278[_0x5e1b8e(0x228)],_0x1d4580=_0x291278[_0x5e1b8e(0x1b8)][_0x5e1b8e(0x1f2)];_0x3f8efb[_0x5e1b8e(0x22f)](),_0x3f8efb[_0x5e1b8e(0x23a)]=_0x291278['selfmadeCard'][_0x5e1b8e(0x256)],_0x3f8efb[_0x5e1b8e(0x1f8)](_0x106365-_0x1d4580,_0x402c1f-_0x1d4580,_0x151984+0x2*_0x1d4580,_0x1b088c+0x2*_0x1d4580),_0x3f8efb[_0x5e1b8e(0x23a)]=_0x5e1b8e(0x1bd),_0x3f8efb[_0x5e1b8e(0x1f8)](_0x106365,_0x402c1f,_0x151984,_0x1b088c),_0x3f8efb[_0x5e1b8e(0x1bc)]=_0x291278['selfmadeCard'][_0x5e1b8e(0x23b)],_0x3f8efb['lineWidth']=_0x291278[_0x5e1b8e(0x1b8)]['innerBorderWidth'],_0x3f8efb['beginPath']();for(let _0x4b15ce=0x1;_0x4b15ce<0x5;_0x4b15ce++){_0x3f8efb[_0x5e1b8e(0x1ba)](_0x106365+_0x4b15ce*_0x291278[_0x5e1b8e(0x1c3)],_0x402c1f),_0x3f8efb[_0x5e1b8e(0x213)](_0x106365+_0x4b15ce*_0x291278[_0x5e1b8e(0x1c3)],_0x402c1f+_0x1b088c);}for(let _0x155c8d=0x1;_0x155c8d<0x4;_0x155c8d++){_0x3f8efb[_0x5e1b8e(0x1ba)](_0x106365,_0x402c1f+_0x155c8d*_0x291278['stampStepY']),_0x3f8efb[_0x5e1b8e(0x213)](_0x106365+_0x151984,_0x402c1f+_0x155c8d*_0x291278[_0x5e1b8e(0x228)]);}_0x3f8efb[_0x5e1b8e(0x23a)]=_0x291278['selfmadeCard'][_0x5e1b8e(0x28b)],_0x3f8efb[_0x5e1b8e(0x294)]=_0x291278['stampStepY']*_0x291278[_0x5e1b8e(0x1b8)][_0x5e1b8e(0x1a0)]+'px\x20\x22\x22',_0x3f8efb['textAlign']='right',_0x3f8efb[_0x5e1b8e(0x280)]='top';for(let _0x4bad38=0x0;_0x4bad38<0x4;_0x4bad38++){for(let _0x328e2f=0x0;_0x328e2f<0x5;_0x328e2f++){const _0x5211a2=0x5*_0x4bad38+_0x328e2f+0x1,_0x25c5aa=_0x3f8efb[_0x5e1b8e(0x18c)](_0x5211a2);_0x3f8efb[_0x5e1b8e(0x1da)](_0x5211a2,_0x106365+(_0x328e2f+0x1)*_0x291278[_0x5e1b8e(0x1c3)]-_0x291278[_0x5e1b8e(0x1b8)][_0x5e1b8e(0x214)],_0x402c1f+(_0x4bad38+0x1)*_0x291278[_0x5e1b8e(0x228)]-_0x291278[_0x5e1b8e(0x1b8)][_0x5e1b8e(0x263)]-_0x25c5aa['actualBoundingBoxDescent']);}}_0x3f8efb[_0x5e1b8e(0x199)](),_0x3f8efb[_0x5e1b8e(0x25f)]();}{_0x3f8efb[_0x5e1b8e(0x22f)](),_0x3f8efb[_0x5e1b8e(0x294)]=_0x291278[_0x5e1b8e(0x1b8)][_0x5e1b8e(0x1cc)]+_0x5e1b8e(0x1ab)+_0x291278['selfmadeCard']['nameLabelFontName']+'\x22',_0x3f8efb[_0x5e1b8e(0x23a)]=_0x291278[_0x5e1b8e(0x1b8)][_0x5e1b8e(0x207)],_0x3f8efb[_0x5e1b8e(0x280)]='top';const _0xe698b6=_0x3f8efb[_0x5e1b8e(0x18c)](_0x291278['selfmadeCard'][_0x5e1b8e(0x29b)]),_0x3b501c=_0x291278[_0x5e1b8e(0x1a7)]-_0x291278[_0x5e1b8e(0x1e8)]/0x2-_0x291278[_0x5e1b8e(0x1b8)]['nameLabelPaddingRight']-_0xe698b6['width'],_0x3f5a71=_0x291278[_0x5e1b8e(0x1a7)]+_0x291278['userNameAreaWidth']/0x2;_0x3f8efb['fillText'](_0x291278[_0x5e1b8e(0x1b8)][_0x5e1b8e(0x29b)],_0x3b501c,_0x291278['userNameBottomY']-_0xe698b6[_0x5e1b8e(0x254)]);const _0x1d26af=_0x291278[_0x5e1b8e(0x26d)]+_0x291278[_0x5e1b8e(0x1b8)][_0x5e1b8e(0x1d2)];_0x3f8efb[_0x5e1b8e(0x1bc)]=_0x291278[_0x5e1b8e(0x1b8)]['nameLabelColor'],_0x3f8efb[_0x5e1b8e(0x223)]=_0x291278['selfmadeCard'][_0x5e1b8e(0x1e2)],_0x3f8efb[_0x5e1b8e(0x1c6)](),_0x3f8efb[_0x5e1b8e(0x1ba)](_0x3b501c-_0x291278[_0x5e1b8e(0x1b8)]['nameLabelMarginHorizontal'],_0x1d26af),_0x3f8efb[_0x5e1b8e(0x213)](_0x3f5a71+_0x291278[_0x5e1b8e(0x1b8)][_0x5e1b8e(0x187)],_0x1d26af),_0x3f8efb[_0x5e1b8e(0x199)](),_0x3f8efb[_0x5e1b8e(0x25f)]();}}const _0x2c74a0=newElem('canvas');{_0x2c74a0['width']=_0x291278[_0x5e1b8e(0x247)],_0x2c74a0['height']=_0x291278[_0x5e1b8e(0x27d)];const _0x161802=_0x2c74a0[_0x5e1b8e(0x281)]('2d');_0x161802[_0x5e1b8e(0x1bc)]=_0x291278[_0x5e1b8e(0x190)][_0x5e1b8e(0x1f6)],_0x161802['lineWidth']=_0x291278['selfmadeStamp'][_0x5e1b8e(0x1e7)],_0x161802[_0x5e1b8e(0x1c6)](),_0x161802[_0x5e1b8e(0x28f)](_0x291278[_0x5e1b8e(0x247)]/0x2,_0x291278[_0x5e1b8e(0x27d)]/0x2,_0x291278[_0x5e1b8e(0x190)][_0x5e1b8e(0x25b)],0x0,Math['PI']*0x2),_0x161802[_0x5e1b8e(0x199)](),_0x161802['fillStyle']=_0x291278['selfmadeStamp']['color'],_0x161802[_0x5e1b8e(0x20b)]=_0x5e1b8e(0x28a),_0x161802[_0x5e1b8e(0x280)]=_0x5e1b8e(0x23e),_0x161802[_0x5e1b8e(0x294)]=_0x291278['selfmadeStamp'][_0x5e1b8e(0x1be)]+_0x5e1b8e(0x1b2);const _0x57f8ee=_0x161802[_0x5e1b8e(0x18c)](_0x291278[_0x5e1b8e(0x190)][_0x5e1b8e(0x224)]);_0x161802['fillText'](_0x291278[_0x5e1b8e(0x190)][_0x5e1b8e(0x224)],_0x291278[_0x5e1b8e(0x247)]/0x2,_0x291278[_0x5e1b8e(0x27d)]/0x2+(_0x57f8ee[_0x5e1b8e(0x24b)]-_0x57f8ee['actualBoundingBoxDescent'])/0x2);}return[_0x1eb923,_0x2c74a0];}(async _0x8b3839=>{const _0x399b89=_0x20799b,_0x17f48f=document[_0x399b89(0x1c0)](_0x399b89(0x23d)),_0x153e9f=document[_0x399b89(0x1c0)](_0x399b89(0x22d)),_0x1e794a=document[_0x399b89(0x1c0)]('#imageTypeSelector'),_0x4255c7=document['querySelector'](_0x399b89(0x2a0)),_0x26adee=document[_0x399b89(0x1c0)](_0x399b89(0x218)),_0x2026f2=document[_0x399b89(0x1c0)](_0x399b89(0x216)),_0x1851c7=document['querySelector'](_0x399b89(0x251)),_0x5eeafc=document[_0x399b89(0x1c0)](_0x399b89(0x21c)),_0x434af4=()=>{const _0x41ba4d=_0x399b89;while(_0x5eeafc[_0x41ba4d(0x1f1)])_0x5eeafc[_0x41ba4d(0x1d3)](_0x5eeafc[_0x41ba4d(0x1f1)]);_0x5eeafc['textContent']='';},_0x14319d=_0x51ab5b=>{const _0x113630=_0x399b89,_0x2f6998=_0x51ab5b[_0x113630(0x1d6)]('\x0a')['trim']();_0x5eeafc[_0x113630(0x23f)](newElem('p',[_0x2f6998],[],{'style':_0x113630(0x24d)}));},_0x24ca95={};_0x24ca95['logEntries']=[],_0x24ca95['maxIdNumber']=null;{const _0x5d0a85=window[_0x399b89(0x25a)]?JSON['parse'](window['localStorage'][_0x399b89(0x1e5)](StorageKey)):null,_0x2ae2ed=(_0x417453,_0x29c18a)=>_0x5d0a85?_0x5d0a85[_0x417453]??_0x29c18a:_0x29c18a,_0x36983a=()=>{const _0x2aae11=_0x399b89,_0x2122a8=(_0x4a31da,_0x5a15f6)=>{const _0x242f60=_0x27d6;return _0x4a31da?(_0x1851c7['removeAttribute'](_0x242f60(0x289)),_0x1851c7[_0x242f60(0x1c5)](_0x242f60(0x1b6),_0x8b3839[_0x242f60(0x284)][_0x242f60(0x1bb)]['showReportOKMesage'])):(_0x1851c7[_0x242f60(0x1c5)](_0x242f60(0x289),'disabled'),_0x1851c7[_0x242f60(0x1c5)](_0x242f60(0x1b6),_0x5a15f6)),_0x4a31da;};if(_0x1e794a[_0x2aae11(0x21a)]===_0x2aae11(0x192)){if(_0x26adee[_0x2aae11(0x1ee)]['length']<0x1)return _0x2122a8(![],'カード画像が選択されていません。');if(_0x2026f2[_0x2aae11(0x1ee)][_0x2aae11(0x1a3)]<0x1)return _0x2122a8(![],_0x2aae11(0x1a4));}return _0x2122a8(!![]);};_0x8b3839[_0x399b89(0x1e1)][_0x399b89(0x211)]?_0x17f48f[_0x399b89(0x21a)]=_0x399b89(0x1f7):_0x17f48f[_0x399b89(0x21a)]=_0x2ae2ed(_0x399b89(0x20e),_0x8b3839[_0x399b89(0x209)][_0x399b89(0x20e)]);_0x153e9f[_0x399b89(0x262)]=_0x2ae2ed(_0x399b89(0x250),_0x8b3839['defaultValues']['randomStamping']),_0x153e9f[_0x399b89(0x255)][_0x399b89(0x293)]=_0x8b3839['helps'][_0x399b89(0x1bb)]['settingsRandomStamping'],_0x1e794a[_0x399b89(0x21a)]=_0x2ae2ed('imageType',_0x8b3839['defaultValues'][_0x399b89(0x265)]);_0x1e794a[_0x399b89(0x20a)]===-0x1&&(_0x1e794a[_0x399b89(0x20a)]=0x0);const _0x1032f2=_0x87a113=>{const _0x475d09=_0x399b89;_0x4255c7['style']['display']=_0x1e794a[_0x475d09(0x21a)]===_0x475d09(0x192)?_0x475d09(0x1ef):_0x475d09(0x1ce),_0x434af4(),_0x36983a();};_0x1e794a[_0x399b89(0x238)](_0x399b89(0x268),_0x1032f2),_0x1032f2(),[_0x26adee,_0x2026f2][_0x399b89(0x202)](_0x439a7a=>_0x439a7a['addEventListener'](_0x399b89(0x268),_0x36983a));{_0x8b3839[_0x399b89(0x1e1)][_0x399b89(0x211)]?(_0x24ca95[_0x399b89(0x291)]=[],Array['from']({'length':_0x8b3839['debugValues'][_0x399b89(0x19c)]??0x64})[_0x399b89(0x285)]((_0x16972a,_0xd10075,_0x5a5d71)=>{const _0x5687b0=_0x399b89,_0x3a96af=new Date(_0x16972a);return _0x24ca95[_0x5687b0(0x291)][_0x5687b0(0x1d9)]({'id':_0x5a5d71+0x1,'date':toValueFromDate(_0x3a96af),'ppt':_0x3a96af[_0x5687b0(0x206)]()===0x6?0x2:0x1,'url':_0x8b3839[_0x5687b0(0x1e1)][_0x5687b0(0x18b)],'remarks':_0x3a96af[_0x5687b0(0x206)]()===0x6?_0x5687b0(0x1b4):_0x5687b0(0x23c)}),_0x16972a+0x5265c00;},(_0x523e69=>_0x523e69-_0x523e69%0x5265c00)(Date[_0x399b89(0x186)]()))):(_0x24ca95[_0x399b89(0x291)]=_0x2ae2ed(_0x399b89(0x291),[]),_0x24ca95['logEntries']['forEach'](_0x2b39cd=>_0x2b39cd[_0x399b89(0x1b9)]=_0x2b39cd['ppt']??0x1)),_0x24ca95['maxIdNumber']=_0x24ca95[_0x399b89(0x291)]['reduce']((_0x5a2004,_0x397c71)=>Math[_0x399b89(0x1a2)](_0x5a2004,_0x397c71['id']),0x1),_0x24ca95[_0x399b89(0x215)]=()=>{const _0x5d6f0d=_0x399b89;_0x24ca95['logEntries'][_0x5d6f0d(0x1d5)]((_0xbd283f,_0x67085a)=>{const _0xfba889=_0x5d6f0d,_0x739486=_0xbd283f[_0xfba889(0x1d8)][_0xfba889(0x25c)](_0x67085a[_0xfba889(0x1d8)]);return _0x739486===0x0?_0xbd283f['id']-_0x67085a['id']:_0x739486;});};}}{const _0x2b9149=async(_0x153bbb,_0x164bc1,_0x307841=![])=>{const _0x22b167=_0x399b89,_0x22d6e3=newElem(_0x22b167(0x260),[],[],{'type':_0x22b167(0x1d8),'value':_0x164bc1[_0x22b167(0x1d8)]??toValueFromDate(new Date())}),_0x4320e4=newElem(_0x22b167(0x260),[],[_0x22b167(0x24c)],{'type':_0x22b167(0x298),'value':_0x164bc1[_0x22b167(0x1b9)]??0x1}),_0x5de2e8=newElem(_0x22b167(0x260),[],['textinput'],{'type':_0x22b167(0x224),'value':_0x164bc1[_0x22b167(0x279)]??''}),_0xbeac88=newElem(_0x22b167(0x260),[],[_0x22b167(0x237)],{'type':_0x22b167(0x224),'value':_0x164bc1['remarks']??''});_0x307841&&(_0x22d6e3['setAttribute'](_0x22b167(0x288),_0x22b167(0x288)),_0x4320e4[_0x22b167(0x1c5)](_0x22b167(0x288),_0x22b167(0x288)),_0x5de2e8['setAttribute']('readonly',_0x22b167(0x288)),_0xbeac88[_0x22b167(0x1c5)](_0x22b167(0x288),'readonly'));const _0x275fb6=newElem(_0x22b167(0x286),[newElem('p',[_0x153bbb],[],{'style':_0x22b167(0x1ed)}),newElem(_0x22b167(0x27e),['日付\x20',_0x22d6e3]),newElem('br'),newElem(_0x22b167(0x27e),[_0x22b167(0x1ae),_0x4320e4,newElem(_0x22b167(0x286),[_0x8b3839['helps'][_0x22b167(0x1bb)][_0x22b167(0x283)]],[_0x22b167(0x1eb)])]),newElem('br'),newElem(_0x22b167(0x27e),['URL\x20',_0x5de2e8,newElem(_0x22b167(0x286),[_0x8b3839[_0x22b167(0x284)][_0x22b167(0x1bb)][_0x22b167(0x236)]],['tltp-for-prev-input'])]),newElem('br'),newElem(_0x22b167(0x27e),[_0x22b167(0x27b),_0xbeac88,newElem(_0x22b167(0x286),[_0x8b3839[_0x22b167(0x284)][_0x22b167(0x1bb)]['logEntryRemarks']],['tltp-for-prev-input'])])]),_0x2455c0=_0x307841?![]:[_0x22d6e3,_0x4320e4,_0x5de2e8,_0xbeac88],_0x3f585e=await showConfirmDialog(_0x275fb6,{'focusable':_0x2455c0,'defaultIsYes':![]});if(_0x3f585e){if(!_0x22d6e3[_0x22b167(0x21a)])return![];_0x164bc1[_0x22b167(0x1d8)]=_0x22d6e3['value'],_0x164bc1[_0x22b167(0x1b9)]=parseIntOr(_0x4320e4[_0x22b167(0x21a)],0xa,0x0),_0x164bc1[_0x22b167(0x279)]=_0x5de2e8[_0x22b167(0x21a)],_0x164bc1[_0x22b167(0x1d7)]=_0xbeac88[_0x22b167(0x21a)];}return _0x3f585e;},_0x433d7a=document['querySelector'](_0x399b89(0x257)),_0xf20884=()=>{const _0x50db91=_0x399b89;_0x433d7a['removeChild'](_0x433d7a[_0x50db91(0x1c0)](_0x50db91(0x205)));const _0x2e4b11=newElem(_0x50db91(0x205),_0x24ca95['logEntries'][_0x50db91(0x1a9)]((_0x45e784,_0x1e72aa)=>{const _0x311688=_0x50db91,_0xee0784=newElem(_0x311688(0x21b),['編集']);_0xee0784[_0x311688(0x238)](_0x311688(0x26e),async()=>{const _0x4731fa=_0x311688,_0x13982f=await _0x2b9149('編集',_0x45e784);_0x13982f&&(_0x24ca95[_0x4731fa(0x215)](),_0xf20884());});const _0x4b92df=newElem(_0x311688(0x21b),['削除']);return _0x4b92df[_0x311688(0x238)]('click',async()=>{const _0x1e9ec4=_0x311688,_0x74b173=_0x24ca95[_0x1e9ec4(0x291)][_0x1e9ec4(0x18f)](_0x45e784);if(_0x74b173!==-0x1){const _0x39a82b=await _0x2b9149('削除しますか？',_0x45e784,!![]);_0x39a82b&&(_0x24ca95[_0x1e9ec4(0x291)][_0x1e9ec4(0x1fa)](_0x74b173,0x1),_0xf20884());}}),newElem('tr',[newElem('td',[_0x1e72aa+0x1+''],['number-cell']),newElem('td',[_0x45e784[_0x311688(0x1d8)]],[_0x311688(0x26a)]),newElem('td',[toSignedIntString(_0x45e784['ppt'])],[_0x311688(0x29c)]),newElem('td',[newElem('a',[_0x45e784['url']],['text-cell'],{'href':_0x45e784['url']})]),newElem('td',[_0x45e784[_0x311688(0x1d7)]],[_0x311688(0x26a)]),newElem('td',[_0xee0784,_0x4b92df])]);}));_0x433d7a[_0x50db91(0x23f)](_0x2e4b11);},_0x58e5e0=newElem(_0x399b89(0x21b),[_0x399b89(0x1e3)]);_0x433d7a[_0x399b89(0x1c0)](_0x399b89(0x189))['appendChild'](newElem('tr',[newElem('th',['No.']),newElem('th',['日付'],[_0x399b89(0x1e6),'tltp-always'],{'data-tltp-text':_0x8b3839['helps'][_0x399b89(0x1bb)][_0x399b89(0x21f)]}),newElem('th',[_0x399b89(0x1b9)],['tltp-on-hover',_0x399b89(0x1af)],{'data-tltp-text':_0x8b3839[_0x399b89(0x284)][_0x399b89(0x1bb)]['logEntryPopoint']}),newElem('th',['URL'],[_0x399b89(0x237),'tltp-on-hover',_0x399b89(0x1af)],{'data-tltp-text':_0x8b3839[_0x399b89(0x284)][_0x399b89(0x1bb)]['logEntryURL']}),newElem('th',['備考'],[_0x399b89(0x237),'tltp-on-hover',_0x399b89(0x1af)],{'data-tltp-text':_0x8b3839[_0x399b89(0x284)]['tltpTexts'][_0x399b89(0x1c4)]}),newElem('th',[_0x58e5e0])])),_0x58e5e0[_0x399b89(0x238)](_0x399b89(0x26e),async()=>{const _0x5354ac=_0x399b89,_0x4c256a={'id':_0x24ca95[_0x5354ac(0x253)]+0x1},_0x50137a=await _0x2b9149('追加',_0x4c256a);_0x50137a&&(_0x24ca95[_0x5354ac(0x253)]+=0x1,_0x24ca95[_0x5354ac(0x291)][_0x5354ac(0x1d9)](_0x4c256a),_0x24ca95[_0x5354ac(0x215)](),_0xf20884());}),_0xf20884();}document['querySelector'](_0x399b89(0x234))[_0x399b89(0x238)](_0x399b89(0x26e),async()=>{const _0xd6ad65=_0x399b89;removeChildren(document[_0xd6ad65(0x1c0)](_0xd6ad65(0x22b)));}),document[_0x399b89(0x1c0)](_0x399b89(0x1a6))[_0x399b89(0x238)](_0x399b89(0x26e),async()=>{const _0x13eb6b=_0x399b89;if(window[_0x13eb6b(0x25a)]){const _0x177acf={'userName':_0x17f48f[_0x13eb6b(0x21a)],'randomStamping':_0x153e9f['checked'],'logEntries':_0x24ca95[_0x13eb6b(0x291)],'imageType':_0x1e794a[_0x13eb6b(0x21a)]===_0x13eb6b(0x192)?_0x13eb6b(0x299):_0x1e794a[_0x13eb6b(0x21a)]};window[_0x13eb6b(0x25a)][_0x13eb6b(0x231)](StorageKey,JSON[_0x13eb6b(0x1f3)](_0x177acf));}}),_0x1851c7[_0x399b89(0x238)](_0x399b89(0x26e),async()=>{const _0x9d5190=_0x399b89,_0x25e95e=Object['assign']({},_0x8b3839['pageOptions'][_0x9d5190(0x1db)]),_0x286f85=_0x24ca95[_0x9d5190(0x291)][_0x9d5190(0x285)]((_0xb81804,_0x10f4ea)=>_0xb81804+_0x10f4ea[_0x9d5190(0x1b9)],0x0),_0x2dee3a={'randomStamping':_0x153e9f[_0x9d5190(0x262)],'fontName':_0x8b3839['defaultValues'][_0x9d5190(0x25d)],'userName':_0x17f48f['value']||_0x9d5190(0x1f7),'logEntries':_0x24ca95[_0x9d5190(0x291)],'stampCount':_0x286f85,'drawingStampCount':getInnerValue(_0x286f85,0x0,0x64)};_0x434af4();let _0x2b215f,_0x2663e2;const _0xdbc94c=_0x1e794a['value'];if(_0xdbc94c===_0x9d5190(0x299))[_0x2b215f,_0x2663e2]=generateCardAndStampImage(_0x25e95e);else{const _0x518f57=[{'fileInput':_0x26adee},{'fileInput':_0x2026f2}],_0x36f713=(await Promise['all'](_0x518f57[_0x9d5190(0x1a9)](_0x83da41=>readInputFileSrc(_0x83da41[_0x9d5190(0x191)][_0x9d5190(0x1ee)][0x0])[_0x9d5190(0x278)](loadSyncImage)[_0x9d5190(0x252)](_0x244790=>({'error':_0x244790})))))[_0x9d5190(0x285)]((_0x1ec59c,_0x37104f,_0x5a3930)=>{const _0x342e48=_0x9d5190;return _0x37104f instanceof HTMLImageElement?_0x518f57[_0x5a3930][_0x342e48(0x26c)]=_0x37104f:_0x1ec59c[_0x342e48(0x1d9)](_0x518f57[_0x5a3930]['fileInput'][_0x342e48(0x1ee)][0x0][_0x342e48(0x272)]),_0x1ec59c;},[]);if(_0x36f713['length']>0x0){_0x14319d([_0x9d5190(0x266)][_0x9d5190(0x245)](_0x36f713));return;}[_0x2b215f,_0x2663e2]=_0x518f57[_0x9d5190(0x1a9)](_0x3fc7ac=>_0x3fc7ac[_0x9d5190(0x26c)]);}const _0x2ecd89=document[_0x9d5190(0x1c0)](_0x9d5190(0x22b));removeChildren(_0x2ecd89);const _0x256097=await generateReportCanvas(_0x2b215f,_0x2663e2,_0x2dee3a,_0x25e95e);await showReportImage(_0x2ecd89,_0x256097);}),_0x8b3839[_0x399b89(0x1e1)]['debugMode']&&_0x1851c7[_0x399b89(0x26e)]();})(getInitValues());
    
    function getInitValues() {
      return {
        helps: {
          tltpTexts: {
            settingsRandomStamping: 'onの場合、ポポちゃんらしく元気に押印します！\noffの場合、正確に中心＆回転無しで押印します。',
            showReportOKMesage: '表示されたレポートをクリックで画像として保存できます。',
            
            logEntryDate: 'ポポイントを貰った日付 (土曜は２倍)',
            logEntryPopoint: 'ポポイント',
            logEntryURL: 'ポポイントを貰ったことを確認できる配信やツイートのURL',
            logEntryRemarks: '配信のタイムスタンプや貰った理由・メモなど',
          },
        },
        
        defaultValues: {
          userName: '',
          imageType:'simple',
          fontName: '',
          //fontName: 'たぬき油性マジック',
          randomStamping: true,
        },
        debugValues: {
          debugMode: false,
          dummyStampCount: 88, // 土曜日2倍を考慮して必ず100pptを超える日数
          dummyLogEntryURL: 'https://twitter.com/Popo_Ieiri/status/1464024238676144129',
        },
        pageOptions: {
          // 1カード20スタンプ＆最大100ポポイントは決め打ちで変更不可能とします
          layout: {
            // 参考にしたカード画像のサイズ
            cardWidth  : 1074,
            cardHeight :  649,
            stampWidth :  300,
            stampHeight:  250,
            // カード内の配置
            stampOffsetXRightMarginForNumber: 20, // スタンプが数字に被らないようにマス目の中心から左にずらす
            stampOffsetX:  70,
            stampOffsetY:  25,
            stampStepX  : 196, //192, 198, 203, 191
            stampStepY  : 125,
            stampSizeRate: 0.50,
            stampCenterX: 75,
            stampCenterY: 75,
            stampRandomPosHalfRange: 6,
            userNameCenterX: 800,
            userNameBottomY: 616,
            userNameAreaWidth : 444,
            userNameAreaHeight:  64,
            userNameFontSize: 60, // 最大値
            // レポート全体
            reportWidth : 1200,
            reportTempHeight: 2000,
            reportBottomMargin: 5,
            reportBackgroundColor: '#FFFFFF',
            reportTextColor: '#333333',
            titleText: 'ポポイントカード履歴',
            titleFontSize: 72,
            titleBottomY:  96,
            cardStartY: 135,
            cardOffset: 15,
            logSummaryYOffset: 80,
            logSummaryFontSize: 32,
            logEntryYOffset: 36,
            logEntryFontSize: 14,
            logEntryLineHeight: 18,
            logItemIndexTextRight  : 40,
            logItemDateTextLeft    : 65,
            logItemPopointRight    : 158,
            logItemPopointPadding  :   5,
            logItemURLTextLeft     : 175,
            logItemRemarksTextLeft : 680,
            logItemURLTextWidth    : 470,
            logItemRemarksTextWidth: 480,
            
            // カード画像自前作成
            selfmadeCard: {
              backgroundColor: '#FFC803',
              outerBorderColor: '#999999',
              innerBorderColor: '#CCCCCC',
              outerBorderWidth: 8,
              innerBorderWidth: 3,
              numberFontColor: '#CCCCCC',
              numberFontHeightRate: 0.34,
              numberPaddingRight: 5,
              numberPaddingBottom: 10,
              nameLabelColor: '#888888',
              nameLabelBorderWidth: 8,
              nameLabelPaddingRight: 8,
              nameLabelPaddingBottom: 12,
              nameLabelMarginHorizontal: 6,
              nameLabelText: 'なまえ',
              nameLabelFontSize: 42,
              nameLabelFontName: '',
            },
            // スタンプ画像自前作成
            selfmadeStamp: {
              color: '#EE9900',
              circleRadius: 110,
              circleLineWidth: 3,
              fontSize: 160,
              text: 'ポ',
            },
          },
          
          imageSets: [
            // 今のところ未実装
          ],
        },
      };
    }
  </script>
</body>
</html>
