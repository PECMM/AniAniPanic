<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:title" content="ポポイントカード履歴管理">
  <meta property="og:url"   content="https://pecmm.github.io/popoint/ReportGenerator.html" />
  <meta property="og:image" content="https://pecmm.github.io/popoint/thumb/ReportGenerator.png?5817b097">
  <title>ポポイントカード履歴管理</title>
  <link rel='stylesheet' href='../assets/accordion.css' />
  <link rel='stylesheet' href='../assets/tooltip.css' />
  <style>
    #userInputArea {
      margin-bottom: 1em;
    }
    #userInputArea label {
      user-select: none;
    }
    #userInputArea #settingTable th {
      text-align: right;
    }
    #userInputArea > table {
      margin-bottom: 1em;
    }
    #imageTypeUserImageArea > #files {
      text-align: right;
    }
    #imageTypeUserImageArea input[type='file'] {
      margin-top: 5px;
      padding: 20px;
      width: 360px;
      background-color: #DDDDDD;
    }
    
    .textinput {
     min-width: 32em;
    }
    
    #logEntryTable {
      margin-top: 1em;
      border-collapse: collapse;
      white-space: nowrap;
    }
    #logEntryTable thead {
      border-bottom-style: double;
    }
    #logEntryTable tr:hover td {
      background-color: #FFFFCC;
    }
    #logEntryTable button {
      font-size: 75%;
    }
    #logEntryTable .number-cell {
      text-align: right;
      padding-left : 0.5em;
      padding-right: 0.5em;
    }
    #logEntryTable .text-cell {
      padding-left : 0.5em;
      padding-right: 0.5em;
    }
    
    #resultArea canvas {
      border: solid 2px blue;
    }
    #resultArea canvas:hover {
      border-color: red;
    }
    
    #helpArea * {
      font-size: 0.95em;
    }
    #helpArea .titleHeader {
      border-bottom: solid #999999 1px;
      margin-bottom: 0.2em;
      padding-left: 0.5em;
      background-color: #EEEEEE;
    }
    #helpArea #accordion-ontime-item > ul {
      margin-top    : 0px;
      margin-bottom : 0.5em;
      padding-top   : 0.2em;
      padding-bottom: 0.2em;
    }
  </style>
</head>

<body>
  <h1>ポポイントカード履歴管理</h1>
  
  <div>ver: <span id="version"></span></div>
  <div id='helpArea' class='accordion-box'>
    <input id='help-accordion-check' class='accordion-check' type='checkbox' />
    <label for='help-accordion-check' class='accordion-ontime' >■Helpを隠す</label>
    <label for='help-accordion-check' class='accordion-offtime'>■Helpを表示</label>
    <div class='accordion-ontime'>
      <div class='accordion-ontime-item'>
        <span class='titleHeader' style='display:block;'>ログの保存・公開</span>
        <ul>
          <li>ブラウザの機能でログを記録しているので、複数環境でのログ共有は対応していません。<br />(ページ表示以降は通信によるデータ送受信はしていま
          せん)</li>
          <li>他ユーザへのログ公開はレポートの画像保存機能のみで対応しています。</li>
        </ul>
        <span class='titleHeader' style='display:block;'>操作</span>
        <ul>
          <li>元に戻す機能はないので、『入力をブラウザに保存』せずに画面リロードなどで前回保存直後に戻してください。</li>
        </ul>
        <span class='titleHeader' style='display:block;'>カード・スタンプの画像について</span>
        <ul>
          <li>サイズおよびスタンプ・名前の位置さえ合っていれば、好きな画像を使用できます。
            <ul>
              <li>カードの画像： 1074x649(px)</li>
              <li>スタンプ画像： 300x250(px)</li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </div>
  
  <div id='userInputArea'>
    <table id='logEntryTable' border='1'>
      <caption>ログ</caption>
      <thead></thead>
      <tbody></tbody>
    </table>
    <table id='settingTable' border='1' cellpadding='5'>
      <caption>レポート設定</caption>
      <tr> <th>なまえ</th> <td><input type='text' id='userName' /></td> </tr>
      <tr> <th>スタンプ</th> <td><label><input type='checkbox' id='randomStamping' class='tltp-on-hover tltp-always'>雑にスタンプを押す</label></td> </tr>
      <tr> <th>画像タイプ</th> <td>
        <select id='imageTypeSelector'>
          <option value='simple'>シンプル</option>
          <option value='userImage'>ユーザの画像</option>
        </select>
        <div id='imageTypeUserImageArea'>
          <hr />
          <div id='files'>
              <label>カード画像：<input type='file' accept='image/*' id='cardUserImage' ></label><br />
            <label>スタンプ画像：<input type='file' accept='image/*' id='stampUserImage'></label><br />
          </div>
          <div id='errorMessageArea'></div>
        </div>
      </td> </tr>
    </table>
    
    <hr />
    <button id='saveInput'>入力をブラウザに保存</button>
    <button id='showReport' class='tltp-on-hover tltp-always tltp-top' data-tltp-text=''>レポート表示</button>
    <button id='clearReport'>表示クリア</button>
  </div>
  <div id='resultArea'>
  </div>
  
  
  <script>
    const AppVersion = "1.0.0";
    
    // ここから
const _0x2b9d82=_0x171f;(function(_0x26717a,_0x1ea9ba){const _0x1c1592=_0x171f,_0x468b5b=_0x26717a();while(!![]){try{const _0x5c94c4=-parseInt(_0x1c1592(0x1d4))/0x1*(parseInt(_0x1c1592(0x164))/0x2)+-parseInt(_0x1c1592(0x230))/0x3+-parseInt(_0x1c1592(0x1d3))/0x4*(parseInt(_0x1c1592(0x1b6))/0x5)+parseInt(_0x1c1592(0x16d))/0x6*(-parseInt(_0x1c1592(0x19b))/0x7)+parseInt(_0x1c1592(0x22f))/0x8*(-parseInt(_0x1c1592(0x1d9))/0x9)+-parseInt(_0x1c1592(0x170))/0xa*(parseInt(_0x1c1592(0x226))/0xb)+-parseInt(_0x1c1592(0x250))/0xc*(-parseInt(_0x1c1592(0x190))/0xd);if(_0x5c94c4===_0x1ea9ba)break;else _0x468b5b['push'](_0x468b5b['shift']());}catch(_0x3f9a6c){_0x468b5b['push'](_0x468b5b['shift']());}}}(_0x151b,0xbe23c),document['querySelector']('#version')[_0x2b9d82(0x204)]=AppVersion);function _0x151b(){const _0x47efce=['fontName','#000000','logItemIndexTextRight','numberFontHeightRate','nameLabelText','tltp-on-hover','map','numberPaddingRight','1805058kjXAGP','toString','floor','nameLabelFontSize','logItemURLTextLeft','cardStartY','nameLabelPaddingBottom','add','outerBorderWidth','6umKpIO','block','files','65730MVeVpH','lineWidth','querySelector','preventDefault','logEntries','img','shiftKey','removeChild','fillStyle','#imageTypeUserImageArea','center','from','position','#333333','slice','logItemDateTextLeft','#cardUserImage','setItem','style','push','logEntryRemarks','altKey','numberFontColor','selfmadeStamp','minWidth','clip','textBaseline','url','的ちゃん','userName','stopPropagation','100%','66446783BrMNVe','font-weight:bold;','reportWidth','getDate','logSummaryYOffset','#errorMessageArea','12px\x200','土曜は２倍デー！','getItem','toDataURL','削除しますか？','8822366ZlPehP','reportMaxHeight','getMonth','setAttribute','stampSizeRate','selfmadeCard','div','onload','change','label','catch','getContext','titleText','length','logItemRemarksTextWidth','right','outerBorderColor','click','font','Escape','localeCompare','boxSizing','#showReport','userImage','selectedIndex','contextmenu','5px\x2030px\x2010px','10uxWEBj','join','isArray','reportBackgroundColor','string','#randomStamping','arc','fontSize','firstChild','classList','userNameCenterX','removeAttribute','stampCenterX','beginPath','pre-line','reduce','pageOptions','tltp-always','lineTo','tltpTexts','color','getMinutes','fixed','innerHeight','focusable','actualBoundingBoxDescent','reportBottomMargin','stampWidth','スタンプ画像が選択されていません。','326512whCHLE','1EzfKjK','height','name','split','localStorage','9FgoBgh','textinput','display','240px','fillText','exec','nameLabelMarginHorizontal','noLabel','addEventListener','remarks','ポポイントカード履歴-','border','px\x20\x22','logItemRemarksTextLeft','stampStepX','px\x20\x22\x22','min','indexOf','confirmDialog','charCodeAt','drawImage','flat','appendChild','debugMode','createElement','solid\x20#DDDDDD\x203px','numberPaddingBottom','nameLabelPaddingRight','keypress','width','padding','nameLabelColor','imageType','rect','stampOffsetXRightMarginForNumber','tltpText','userNameAreaWidth','ceil','stampStepY','target','cardOffset','settingsRandomStamping','keydown','textContent','URL\x20','metaKey','layout','backgroundColor','sortLogEntries','strokeStyle','20px','rotate','dataset','margin','更新日：','disabled','stampRandomPosHalfRange','No.','body','readAsDataURL','fillRect','forEach','whiteSpace','parse','randomStamping','opacity','onerror','ctrlKey','restore','marginBottom','moveTo','#saveInput','assign','cardWidth','text','logItemURLTextWidth','helps','1485BykbPA','concat','button','画像の読み込みに失敗しました','random','save','popointCard-lastInputValues','stampHeight','src','990968wACCJc','2985390zRvSPu','text-cell','checked','input','measureText','備考\x20','getBoundingClientRect','getSeconds','reportTextColor','top','#resultArea','createTextNode','日付\x20','translate','innerBorderWidth','#clearReport','max','actualBoundingBoxAscent','stampCenterY','textAlign','logEntryLineHeight','none','canvas','marginTop','getFullYear','readonly','sort','defaultIsYes','positionElement','focus','titleFontSize','zIndex','12SdbJFv','value','cardHeight','表示確認用','globalAlpha','0px','data-tltp-text','maxIdNumber','circleLineWidth','display:inline-block;\x20padding:0.5em;\x20color:#FF0000;\x20background-color:#FFFF00;\x20white-space:pre;','showReportOKMesage','getDay','left','stroke','#imageTypeSelector','key','#stampUserImage','...','logEntryURL','titleBottomY','date','stampOffsetY','defaultValues','stringify','debugValues','tbody','#FFFFFF','innerBorderColor','userNameBottomY','logEntryFontSize','simple','flex','thead','fileInput'];_0x151b=function(){return _0x47efce;};return _0x151b();}function randomRangedInt(_0xe05107,_0x4c7cf3){const _0x55a1d4=_0x2b9d82;return Math[_0x55a1d4(0x166)](Math[_0x55a1d4(0x22a)]()*(_0x4c7cf3-_0xe05107+0x1))+_0xe05107;}function newElem(_0x312ac3,_0x318bb1=[],_0x321d3f=[],_0x46f4f4={}){const _0x3157ac=_0x2b9d82,_0x6896ea=document[_0x3157ac(0x1f1)](_0x312ac3);return _0x321d3f[_0x3157ac(0x1a8)]>0x0&&_0x6896ea[_0x3157ac(0x1bf)][_0x3157ac(0x16b)](..._0x321d3f),Object['getOwnPropertyNames'](_0x46f4f4)['forEach'](_0x39d2f5=>{const _0x574bb8=_0x3157ac;_0x6896ea[_0x574bb8(0x19e)](_0x39d2f5,_0x46f4f4[_0x39d2f5]);}),_0x318bb1[_0x3157ac(0x216)](_0x3181e8=>{const _0x5a8364=_0x3157ac;typeof _0x3181e8===_0x5a8364(0x1ba)?_0x6896ea[_0x5a8364(0x1ef)](document[_0x5a8364(0x23b)](_0x3181e8)):_0x6896ea[_0x5a8364(0x1ef)](_0x3181e8);}),_0x6896ea;}function loadSyncImage(_0x12a10c){return new Promise((_0x269ee7,_0x75614)=>{const _0x3c0bae=_0x171f,_0x1d7c96=new Image();_0x1d7c96[_0x3c0bae(0x1a2)]=()=>_0x269ee7(_0x1d7c96),_0x1d7c96[_0x3c0bae(0x21b)]=_0xe24167=>_0x75614(_0xe24167),_0x1d7c96[_0x3c0bae(0x22e)]=_0x12a10c;});}function readInputFileSrc(_0x54c654){return new Promise((_0x1b9986,_0xb38425)=>{const _0xb91cbc=_0x171f,_0x6f0749=new FileReader();_0x6f0749[_0xb91cbc(0x1a2)]=()=>_0x1b9986(_0x6f0749['result']),_0x6f0749[_0xb91cbc(0x21b)]=_0x8d59cb=>_0xb38425(_0x8d59cb),_0x6f0749[_0xb91cbc(0x214)](_0x54c654);});}function srcToURL(_0x1bf9cd){const _0x4fcef1=_0x2b9d82,_0x773822=atob(_0x1bf9cd[_0x4fcef1(0x1d7)](',')[0x1]),_0xe59d4=/:([a-zA-Z\/]+);/[_0x4fcef1(0x1de)](_0x1bf9cd)[0x1],_0xfed173=Uint8Array[_0x4fcef1(0x17b)](_0x773822[_0x4fcef1(0x1d7)](''),_0xb76fea=>_0xb76fea[_0x4fcef1(0x1ec)]()),_0x2d0c9b=new Blob([_0xfed173],{'type':_0xe59d4});return URL['createObjectURL'](_0x2d0c9b);}function pad0String(_0x1439d6,_0xb51788){const _0x16ac49=_0x2b9d82;return _0xb51788[_0x16ac49(0x165)]()['padStart'](_0x1439d6,'0');}function getDateStringForFile(_0x210976){const _0xecaec5=_0x2b9d82;return _0x210976['getFullYear']()+'年'+pad0String(0x2,_0x210976[_0xecaec5(0x19d)]()+0x1)+'月'+pad0String(0x2,_0x210976[_0xecaec5(0x193)]())+'日-'+pad0String(0x2,_0x210976['getHours']())+'時'+pad0String(0x2,_0x210976[_0xecaec5(0x1cb)]())+'分'+pad0String(0x2,_0x210976[_0xecaec5(0x237)]())+'秒';}function getDateForDisplay(_0x5dc021){const _0x2a232a=_0x2b9d82;return _0x5dc021[_0x2a232a(0x248)]()+'/'+pad0String(0x2,_0x5dc021[_0x2a232a(0x19d)]()+0x1)+'/'+pad0String(0x2,_0x5dc021[_0x2a232a(0x193)]());}function toValueFromDate(_0x4e6847){const _0x18ca3e=_0x2b9d82;return _0x4e6847['getFullYear']()+'-'+pad0String(0x2,_0x4e6847[_0x18ca3e(0x19d)]()+0x1)+'-'+pad0String(0x2,_0x4e6847[_0x18ca3e(0x193)]());}function removeChildren(_0x2b2386){const _0x591def=_0x2b9d82;while(_0x2b2386[_0x591def(0x1be)]){_0x2b2386[_0x591def(0x177)](_0x2b2386['firstChild']);}}function showConfirmTextDialog(_0x8516d7,_0x4fdce3){const _0x26e76e=_0x2b9d82,_0x54ab63=newElem('p',[_0x8516d7]);return _0x54ab63['style'][_0x26e76e(0x217)]=_0x26e76e(0x1c4),showConfirmDialog(_0x54ab63,_0x4fdce3);}function showConfirmDialog(_0x196372,_0xc0de34){const _0x1168f6=_0x2b9d82;_0xc0de34=Object['assign']({'baseElement':document[_0x1168f6(0x213)],'focusable':![],'yesLabel':'OK','noLabel':'Cancel','defaultIsYes':!![],'positionElement':window},_0xc0de34);const _0x175b7b=_0xc0de34['baseElement'],_0x9e54b5=_0xc0de34[_0x1168f6(0x1ce)],_0x3b1963=_0xc0de34['yesLabel'],_0x52d99f=_0xc0de34[_0x1168f6(0x1e0)],_0x509c23=_0xc0de34[_0x1168f6(0x24b)],_0x524bed=_0xc0de34[_0x1168f6(0x24c)],_0x27c998=_0x52d99f==='',_0x1a2d22=newElem(_0x1168f6(0x228),[_0x3b1963]),_0x16d2a2=newElem(_0x1168f6(0x228),[_0x52d99f]);_0x27c998&&(_0x16d2a2[_0x1168f6(0x182)][_0x1168f6(0x1db)]=_0x1168f6(0x245));const _0x23f73c=_0x27c998?[_0x1a2d22]:[_0x1a2d22,_0x16d2a2],_0x2b7a6e=newElem(_0x1168f6(0x1a1),_0x23f73c),_0x3fd085=newElem(_0x1168f6(0x1a1),[_0x196372,newElem('hr'),_0x2b7a6e],[_0x1168f6(0x1eb)]),_0x186b86=newElem(_0x1168f6(0x1a1)),_0xc7a99b=0xf423f;_0x3fd085[_0x1168f6(0x182)][_0x1168f6(0x17c)]=_0x1168f6(0x1cc),_0x3fd085['style'][_0x1168f6(0x24f)]=_0xc7a99b,_0x3fd085[_0x1168f6(0x182)][_0x1168f6(0x188)]=_0x1168f6(0x1dc),_0x3fd085['style'][_0x1168f6(0x1b0)]='border-box',_0x3fd085[_0x1168f6(0x182)][_0x1168f6(0x1e4)]=_0x1168f6(0x1f2),_0x3fd085['style']['borderRadius']=_0x1168f6(0x20b),_0x3fd085[_0x1168f6(0x182)]['margin']=0x0,_0x3fd085[_0x1168f6(0x182)]['padding']=_0x1168f6(0x1b5),_0x3fd085[_0x1168f6(0x182)][_0x1168f6(0x208)]=_0x1168f6(0x26a),_0x2b7a6e[_0x1168f6(0x182)][_0x1168f6(0x1db)]=_0x1168f6(0x26f),_0x2b7a6e[_0x1168f6(0x182)]['justifyContent']='space-around',_0x186b86[_0x1168f6(0x182)][_0x1168f6(0x17c)]=_0x1168f6(0x1cc),_0x186b86[_0x1168f6(0x182)][_0x1168f6(0x24f)]=_0xc7a99b-0x1,_0x186b86[_0x1168f6(0x182)][_0x1168f6(0x239)]=0x0,_0x186b86[_0x1168f6(0x182)][_0x1168f6(0x25c)]=0x0,_0x186b86['style'][_0x1168f6(0x1f6)]=_0x1168f6(0x18f),_0x186b86[_0x1168f6(0x182)]['height']=_0x1168f6(0x18f),_0x186b86[_0x1168f6(0x182)]['border']=_0x1168f6(0x255),_0x186b86[_0x1168f6(0x182)][_0x1168f6(0x1f7)]=_0x1168f6(0x255),_0x186b86[_0x1168f6(0x182)][_0x1168f6(0x20e)]=_0x1168f6(0x255),_0x186b86[_0x1168f6(0x182)][_0x1168f6(0x208)]=_0x1168f6(0x273),_0x186b86[_0x1168f6(0x182)][_0x1168f6(0x21a)]=0.3;!_0x196372[_0x1168f6(0x182)][_0x1168f6(0x20e)]&&!_0x196372[_0x1168f6(0x182)][_0x1168f6(0x247)]&&!_0x196372['style'][_0x1168f6(0x21e)]&&(_0x196372['style'][_0x1168f6(0x20e)]=_0x1168f6(0x196));const _0x309f2b=function(_0x2450a4){const _0x330a4c=_0x1168f6,_0x42947e=_0x2450a4[0x0],_0x483350=_0x2450a4[_0x2450a4[_0x330a4c(0x1a8)]-0x1],_0x459ea0=[_0x483350,_0x2450a4,_0x42947e][_0x330a4c(0x1ee)]();return _0xd6d8d9=>{const _0x25f895=_0x330a4c;if(_0xd6d8d9[_0x25f895(0x25f)]==='Tab'&&!_0xd6d8d9[_0x25f895(0x185)]&&!_0xd6d8d9[_0x25f895(0x21c)]&&!_0xd6d8d9[_0x25f895(0x206)]){_0xd6d8d9[_0x25f895(0x18e)](),_0xd6d8d9[_0x25f895(0x173)]();const _0x504b03=_0x459ea0[_0x25f895(0x1ea)](_0xd6d8d9[_0x25f895(0x200)],0x1);_0x504b03===-0x1?(_0xd6d8d9[_0x25f895(0x176)]?_0x483350:_0x42947e)[_0x25f895(0x24d)]():_0x459ea0[_0x504b03+(_0xd6d8d9[_0x25f895(0x176)]?-0x1:0x1)][_0x25f895(0x24d)]();}else _0xd6d8d9['key']===_0x25f895(0x1ae)&&!_0xd6d8d9[_0x25f895(0x185)]&&!_0xd6d8d9[_0x25f895(0x21c)]&&!_0xd6d8d9['shiftKey']&&!_0xd6d8d9[_0x25f895(0x206)]&&(_0xd6d8d9[_0x25f895(0x18e)](),_0xd6d8d9[_0x25f895(0x173)](),_0x16d2a2[_0x25f895(0x1ac)]());};},_0x5c002c=Array[_0x1168f6(0x1b8)](_0x9e54b5)?_0x9e54b5[_0x1168f6(0x227)](_0x23f73c):_0x23f73c,_0x2570f7=_0x309f2b(_0x5c002c);_0x5c002c['concat'](_0x3fd085,_0x186b86)[_0x1168f6(0x216)](_0x110cde=>{const _0x23e8d7=_0x1168f6;_0x110cde[_0x23e8d7(0x1e1)](_0x23e8d7(0x203),_0x2570f7),_0x110cde[_0x23e8d7(0x1e1)](_0x23e8d7(0x1f5),_0x2570f7);}),_0x175b7b[_0x1168f6(0x1ef)](_0x186b86),_0x175b7b[_0x1168f6(0x1ef)](_0x3fd085);const _0x513789=window['getComputedStyle'](_0x3fd085),_0x334dcc=_0x524bed===window?{'width':window['innerWidth'],'height':window[_0x1168f6(0x1cd)]}:_0x524bed[_0x1168f6(0x236)]();return _0x3fd085[_0x1168f6(0x182)][_0x1168f6(0x239)]=(_0x334dcc[_0x1168f6(0x1d5)]-parseInt(_0x513789['height'],0xa))/0x2+'px',_0x3fd085[_0x1168f6(0x182)][_0x1168f6(0x25c)]=(_0x334dcc[_0x1168f6(0x1f6)]-parseInt(_0x513789[_0x1168f6(0x1f6)],0xa))/0x2+'px',_0x27c998||_0x509c23?_0x1a2d22['focus']():_0x16d2a2[_0x1168f6(0x24d)](),new Promise((_0x334c28,_0x1c0703)=>{const _0x29816e=_0x1168f6;_0x1a2d22['addEventListener']('click',()=>{const _0x428458=_0x171f;_0x23f73c[_0x428458(0x216)](_0x4e5e2f=>_0x4e5e2f[_0x428458(0x19e)](_0x428458(0x210),_0x428458(0x210))),_0x175b7b[_0x428458(0x177)](_0x186b86),_0x175b7b['removeChild'](_0x3fd085),_0x334c28(!![]);}),_0x16d2a2[_0x29816e(0x1e1)](_0x29816e(0x1ac),()=>{const _0xa897a1=_0x29816e;_0x23f73c['forEach'](_0x245b2f=>_0x245b2f[_0xa897a1(0x19e)](_0xa897a1(0x210),_0xa897a1(0x210))),_0x175b7b[_0xa897a1(0x177)](_0x186b86),_0x175b7b[_0xa897a1(0x177)](_0x3fd085),_0x334c28(![]);});});}const StorageKey=_0x2b9d82(0x22c);async function generateReportCanvas(_0x57239a,_0x2c055a,_0x147ebe,_0x30d078){const _0x216290=_0x2b9d82,_0x3ced9d=newElem('canvas');{_0x3ced9d[_0x216290(0x1f6)]=_0x30d078['cardWidth'],_0x3ced9d[_0x216290(0x1d5)]=_0x30d078[_0x216290(0x252)];const _0x5c0b4d=_0x3ced9d[_0x216290(0x1a6)]('2d');_0x5c0b4d['fillStyle']=_0x216290(0x26a),_0x5c0b4d[_0x216290(0x215)](0x0,0x0,_0x30d078[_0x216290(0x222)],_0x30d078[_0x216290(0x252)]),_0x5c0b4d[_0x216290(0x1ed)](_0x57239a,0x0,0x0,_0x30d078[_0x216290(0x222)],_0x30d078[_0x216290(0x252)]),_0x5c0b4d[_0x216290(0x254)]=0.5,_0x5c0b4d[_0x216290(0x171)]=0x1,_0x5c0b4d[_0x216290(0x20a)]=_0x216290(0x17d),_0x5c0b4d[_0x216290(0x21f)](0x0,0x0),_0x5c0b4d['lineTo'](_0x3ced9d[_0x216290(0x1f6)],0x0),_0x5c0b4d[_0x216290(0x1c8)](_0x3ced9d['width'],_0x3ced9d[_0x216290(0x1d5)]),_0x5c0b4d[_0x216290(0x1c8)](0x0,_0x3ced9d[_0x216290(0x1d5)]),_0x5c0b4d[_0x216290(0x1c8)](0x0,0x0),_0x5c0b4d['stroke']();}const _0x478932=newElem('canvas');{_0x478932[_0x216290(0x1f6)]=_0x3ced9d[_0x216290(0x1f6)],_0x478932['height']=_0x3ced9d['height'];const _0x131631=_0x478932[_0x216290(0x1a6)]('2d');_0x131631[_0x216290(0x1ed)](_0x3ced9d,0x0,0x0);{_0x131631[_0x216290(0x22b)](),_0x131631[_0x216290(0x1ad)]=_0x30d078['userNameFontSize']+_0x216290(0x1e5)+_0x147ebe['fontName']+'\x22';const _0x40ee6b=_0x131631['measureText'](_0x147ebe[_0x216290(0x18d)]),_0x4b9238=_0x30d078['userNameFontSize']*Math[_0x216290(0x1e9)](0x1,Math[_0x216290(0x1e9)](_0x30d078[_0x216290(0x1fd)]/_0x40ee6b['width'],_0x30d078['userNameAreaHeight']/(_0x40ee6b[_0x216290(0x241)]+_0x40ee6b[_0x216290(0x1cf)])));_0x131631[_0x216290(0x243)]='center',_0x131631['textBaseline']='bottom',_0x131631[_0x216290(0x178)]='#666666',_0x131631[_0x216290(0x1ad)]=_0x4b9238+'px\x20\x22'+_0x147ebe[_0x216290(0x272)]+'\x22';const _0x1bf43c=_0x131631[_0x216290(0x234)](_0x147ebe['userName']);_0x131631['fillText'](_0x147ebe[_0x216290(0x18d)],_0x30d078[_0x216290(0x1c0)],_0x30d078[_0x216290(0x26c)]-_0x1bf43c[_0x216290(0x1cf)]),_0x131631[_0x216290(0x21d)]();}const _0x3015ff=newElem('canvas');{const _0x244990=_0x30d078[_0x216290(0x1d1)]*_0x30d078[_0x216290(0x19f)],_0x48b7b3=_0x30d078[_0x216290(0x22d)]*_0x30d078[_0x216290(0x19f)];_0x3015ff[_0x216290(0x1f6)]=_0x3015ff['height']=Math[_0x216290(0x240)](_0x244990,_0x48b7b3);const _0x5c42b3=_0x3015ff[_0x216290(0x1a6)]('2d');_0x5c42b3[_0x216290(0x1ed)](_0x2c055a,(_0x3015ff['width']-_0x244990)/0x2,(_0x3015ff['height']-_0x48b7b3)/0x2,_0x244990,_0x48b7b3);}let _0x55bc12=(_0x3407=>_0x3407%0x14===0x0&&_0x3407>=0x14?0x14:_0x3407%0x14)(_0x147ebe[_0x216290(0x174)]['length']);for(let _0x1638e0=0x0;_0x55bc12>0x0;_0x55bc12-=0x5,_0x1638e0++){const _0xb3eb6d=Math[_0x216290(0x1e9)](_0x55bc12,0x5);for(let _0x541ae5=0x0;_0x541ae5<_0xb3eb6d;_0x541ae5++){const _0x46b58b=_0x30d078['stampOffsetX']+_0x30d078['stampStepX']*_0x541ae5-_0x30d078[_0x216290(0x1fb)]/0x2,_0x5bb19c=_0x30d078[_0x216290(0x265)]+_0x30d078[_0x216290(0x1ff)]*_0x1638e0,_0x6be418=_0x30d078[_0x216290(0x1c2)]+randomRangedInt(-_0x30d078[_0x216290(0x211)],_0x30d078['stampRandomPosHalfRange']),_0x19f41d=_0x30d078[_0x216290(0x242)]+randomRangedInt(-_0x30d078[_0x216290(0x211)],_0x30d078['stampRandomPosHalfRange']);_0x147ebe[_0x216290(0x219)]?(_0x131631['save'](),_0x131631[_0x216290(0x23d)](_0x46b58b+_0x6be418,_0x5bb19c+_0x19f41d),_0x131631[_0x216290(0x20c)](0x2*Math['PI']*Math[_0x216290(0x22a)]()),_0x131631[_0x216290(0x1ed)](_0x3015ff,-_0x6be418,-_0x19f41d),_0x131631[_0x216290(0x21d)]()):_0x131631['drawImage'](_0x3015ff,_0x46b58b,_0x5bb19c);}}}{const _0x1ed9a7=newElem('canvas');_0x1ed9a7[_0x216290(0x1f6)]=_0x30d078['reportWidth'],_0x1ed9a7[_0x216290(0x1d5)]=_0x30d078['reportMaxHeight'];const _0x44e205=_0x1ed9a7[_0x216290(0x1a6)]('2d');_0x44e205[_0x216290(0x178)]=_0x30d078[_0x216290(0x1b9)],_0x44e205[_0x216290(0x215)](0x0,0x0,_0x30d078[_0x216290(0x192)],_0x30d078[_0x216290(0x19c)]);{_0x44e205[_0x216290(0x22b)](),_0x44e205['fillStyle']=_0x30d078[_0x216290(0x238)],_0x44e205['font']=_0x30d078[_0x216290(0x24e)]+_0x216290(0x1e5)+_0x147ebe[_0x216290(0x272)]+'\x22',_0x44e205[_0x216290(0x243)]=_0x216290(0x17a),_0x44e205[_0x216290(0x18a)]='bottom';const _0xb3169b=_0x44e205[_0x216290(0x234)](_0x30d078[_0x216290(0x1a7)]);_0x44e205['fillText'](_0x30d078[_0x216290(0x1a7)],_0x30d078[_0x216290(0x192)]/0x2,_0x30d078[_0x216290(0x263)]-_0xb3169b[_0x216290(0x1cf)]),_0x44e205[_0x216290(0x21d)]();}const _0x48b79b=Math[_0x216290(0x1fe)](_0x147ebe[_0x216290(0x174)][_0x216290(0x1a8)]/0x14);let _0x3e44de;{const _0x2f5163=_0x30d078[_0x216290(0x222)]+(_0x48b79b-0x1)*_0x30d078[_0x216290(0x201)];_0x3e44de=(_0x30d078[_0x216290(0x192)]-_0x2f5163)/0x2,Array[_0x216290(0x17b)]({'length':_0x48b79b-0x1},_0x37f246=>_0x3ced9d)[_0x216290(0x227)](_0x478932)[_0x216290(0x216)]((_0x3c8dfd,_0x1a860f)=>{const _0x173b18=_0x216290;_0x44e205[_0x173b18(0x1ed)](_0x3c8dfd,_0x3e44de+_0x1a860f*_0x30d078[_0x173b18(0x201)],_0x30d078[_0x173b18(0x169)]+_0x1a860f*_0x30d078[_0x173b18(0x201)]);});}const _0x1e1c3f=_0x30d078['cardStartY']+_0x30d078[_0x216290(0x252)]+_0x30d078[_0x216290(0x201)]*_0x48b79b+_0x30d078[_0x216290(0x194)];{_0x44e205['save'](),_0x44e205[_0x216290(0x178)]=_0x30d078[_0x216290(0x238)],_0x44e205['font']=_0x30d078['logSummaryFontSize']+_0x216290(0x1e5)+_0x147ebe['fontName']+'\x22',_0x44e205[_0x216290(0x18a)]=_0x216290(0x239),_0x44e205[_0x216290(0x243)]=_0x216290(0x25c);const _0x3c2d69=_0x216290(0x20f)+getDateForDisplay(new Date()),_0x2fb2d5=_0x44e205[_0x216290(0x234)](_0x3c2d69);_0x44e205[_0x216290(0x1dd)](_0x3c2d69,_0x3e44de,_0x1e1c3f-_0x2fb2d5[_0x216290(0x1cf)]),_0x44e205[_0x216290(0x243)]='right';const _0x346252='総スタンプ数：'+_0x147ebe[_0x216290(0x174)][_0x216290(0x1a8)],_0x37b6a9=_0x44e205['measureText'](_0x346252);_0x44e205[_0x216290(0x1dd)](_0x346252,_0x30d078[_0x216290(0x192)]-_0x3e44de,_0x1e1c3f-_0x37b6a9['actualBoundingBoxDescent']),_0x44e205[_0x216290(0x21d)]();}const _0x1aeda5=_0x1e1c3f+_0x30d078['logEntryYOffset'];let _0x3c2016;{_0x44e205[_0x216290(0x22b)](),_0x44e205['fillStyle']=_0x30d078[_0x216290(0x238)],_0x44e205['font']=_0x30d078[_0x216290(0x26d)]+'px\x20\x22'+_0x147ebe['fontName']+'\x22';const _0x5aa2a5=(_0x265772,_0x3967ad,_0x4d7269,_0x24490f,_0x15081c)=>{const _0x43a4e9=_0x216290;_0x44e205[_0x43a4e9(0x234)](_0x265772)[_0x43a4e9(0x1f6)]>_0x24490f?(_0x44e205['save'](),_0x44e205[_0x43a4e9(0x1c3)](),_0x44e205[_0x43a4e9(0x1fa)](_0x3967ad,_0x4d7269-_0x15081c,_0x24490f,_0x15081c*0x2),_0x44e205[_0x43a4e9(0x189)](),_0x44e205['fillText'](_0x265772,_0x3967ad,_0x4d7269),_0x44e205[_0x43a4e9(0x21d)](),_0x44e205[_0x43a4e9(0x1dd)](_0x43a4e9(0x261),_0x3967ad+_0x24490f+0x3,_0x4d7269)):_0x44e205[_0x43a4e9(0x1dd)](_0x265772,_0x3967ad,_0x4d7269);},_0x570625=_0x30d078[_0x216290(0x26d)];_0x3c2016=_0x147ebe[_0x216290(0x174)][_0x216290(0x1c5)]((_0x183b44,_0x93453d,_0x180e56)=>{const _0x3090a5=_0x216290;return _0x44e205[_0x3090a5(0x243)]=_0x3090a5(0x1aa),_0x44e205[_0x3090a5(0x1dd)](_0x180e56+0x1,_0x30d078[_0x3090a5(0x274)],_0x183b44),_0x44e205['textAlign']=_0x3090a5(0x25c),_0x44e205[_0x3090a5(0x1dd)](_0x93453d[_0x3090a5(0x264)],_0x30d078[_0x3090a5(0x17f)],_0x183b44),_0x5aa2a5(_0x93453d[_0x3090a5(0x18b)],_0x30d078[_0x3090a5(0x168)],_0x183b44,_0x30d078[_0x3090a5(0x224)],_0x570625),_0x5aa2a5(_0x93453d[_0x3090a5(0x1e2)],_0x30d078[_0x3090a5(0x1e6)],_0x183b44,_0x30d078[_0x3090a5(0x1a9)],_0x570625),_0x183b44+_0x30d078[_0x3090a5(0x244)];},_0x1aeda5),_0x44e205['restore']();}const _0x14b57f=newElem(_0x216290(0x246));return _0x14b57f[_0x216290(0x1f6)]=_0x1ed9a7['width'],_0x14b57f[_0x216290(0x1d5)]=_0x3c2016+_0x30d078[_0x216290(0x1d0)],_0x14b57f[_0x216290(0x1a6)]('2d')[_0x216290(0x1ed)](_0x1ed9a7,0x0,0x0),_0x14b57f;}}async function showReportImage(_0x226ebe,_0x56691a){const _0x1d6f0b=_0x2b9d82,_0x53dc88=newElem(_0x1d6f0b(0x246));_0x53dc88[_0x1d6f0b(0x1f6)]=_0x56691a[_0x1d6f0b(0x1f6)],_0x53dc88[_0x1d6f0b(0x1d5)]=_0x56691a['height'],_0x53dc88['getContext']('2d')[_0x1d6f0b(0x1ed)](_0x56691a,0x0,0x0),_0x53dc88[_0x1d6f0b(0x1e1)](_0x1d6f0b(0x1b4),_0x810493=>{_0x810493['preventDefault']();}),document[_0x1d6f0b(0x172)](_0x1d6f0b(0x23a))[_0x1d6f0b(0x1ef)](newElem('a',[_0x53dc88],[],{'download':_0x1d6f0b(0x1e3)+getDateStringForFile(new Date()),'href':srcToURL(_0x53dc88[_0x1d6f0b(0x199)]())}));}function _0x171f(_0x36a38e,_0x56bbb0){const _0x151b4b=_0x151b();return _0x171f=function(_0x171f2f,_0x4984a4){_0x171f2f=_0x171f2f-0x162;let _0x24a3df=_0x151b4b[_0x171f2f];return _0x24a3df;},_0x171f(_0x36a38e,_0x56bbb0);}function generateCardAndStampImage(_0xae05ce){const _0xbbbc95=_0x2b9d82,_0x64698c=newElem(_0xbbbc95(0x246));{_0x64698c[_0xbbbc95(0x1f6)]=_0xae05ce[_0xbbbc95(0x222)],_0x64698c['height']=_0xae05ce['cardHeight'];const _0x1a97b9=_0x64698c[_0xbbbc95(0x1a6)]('2d');_0x1a97b9[_0xbbbc95(0x178)]=_0xae05ce[_0xbbbc95(0x1a0)][_0xbbbc95(0x208)],_0x1a97b9[_0xbbbc95(0x215)](0x0,0x0,_0xae05ce[_0xbbbc95(0x222)],_0xae05ce[_0xbbbc95(0x252)]);{const _0x1508ed=_0xae05ce['stampOffsetX']+_0xae05ce['stampCenterX']-_0xae05ce[_0xbbbc95(0x1e7)]/0x2,_0x5ccf66=_0xae05ce[_0xbbbc95(0x265)]+_0xae05ce[_0xbbbc95(0x242)]-_0xae05ce[_0xbbbc95(0x1ff)]/0x2,_0x18bd42=0x5*_0xae05ce[_0xbbbc95(0x1e7)],_0x4d5111=0x4*_0xae05ce[_0xbbbc95(0x1ff)],_0x3823ed=_0xae05ce['selfmadeCard'][_0xbbbc95(0x16c)];_0x1a97b9['save'](),_0x1a97b9[_0xbbbc95(0x178)]=_0xae05ce[_0xbbbc95(0x1a0)][_0xbbbc95(0x1ab)],_0x1a97b9['fillRect'](_0x1508ed-_0x3823ed,_0x5ccf66-_0x3823ed,_0x18bd42+0x2*_0x3823ed,_0x4d5111+0x2*_0x3823ed),_0x1a97b9[_0xbbbc95(0x178)]='#FFFFFF',_0x1a97b9[_0xbbbc95(0x215)](_0x1508ed,_0x5ccf66,_0x18bd42,_0x4d5111),_0x1a97b9[_0xbbbc95(0x20a)]=_0xae05ce[_0xbbbc95(0x1a0)][_0xbbbc95(0x26b)],_0x1a97b9[_0xbbbc95(0x171)]=_0xae05ce[_0xbbbc95(0x1a0)][_0xbbbc95(0x23e)],_0x1a97b9[_0xbbbc95(0x1c3)]();for(let _0x2b19e8=0x1;_0x2b19e8<0x5;_0x2b19e8++){_0x1a97b9[_0xbbbc95(0x21f)](_0x1508ed+_0x2b19e8*_0xae05ce['stampStepX'],_0x5ccf66),_0x1a97b9[_0xbbbc95(0x1c8)](_0x1508ed+_0x2b19e8*_0xae05ce[_0xbbbc95(0x1e7)],_0x5ccf66+_0x4d5111);}for(let _0x37be53=0x1;_0x37be53<0x4;_0x37be53++){_0x1a97b9[_0xbbbc95(0x21f)](_0x1508ed,_0x5ccf66+_0x37be53*_0xae05ce[_0xbbbc95(0x1ff)]),_0x1a97b9['lineTo'](_0x1508ed+_0x18bd42,_0x5ccf66+_0x37be53*_0xae05ce[_0xbbbc95(0x1ff)]);}_0x1a97b9[_0xbbbc95(0x178)]=_0xae05ce['selfmadeCard'][_0xbbbc95(0x186)],_0x1a97b9[_0xbbbc95(0x1ad)]=_0xae05ce[_0xbbbc95(0x1ff)]*_0xae05ce['selfmadeCard'][_0xbbbc95(0x275)]+_0xbbbc95(0x1e8),_0x1a97b9[_0xbbbc95(0x243)]=_0xbbbc95(0x1aa),_0x1a97b9['textBaseline']=_0xbbbc95(0x239);for(let _0x50c9ca=0x0;_0x50c9ca<0x4;_0x50c9ca++){for(let _0x4e3ebb=0x0;_0x4e3ebb<0x5;_0x4e3ebb++){const _0x10c705=0x5*_0x50c9ca+_0x4e3ebb+0x1,_0x1a386c=_0x1a97b9[_0xbbbc95(0x234)](_0x10c705);_0x1a97b9[_0xbbbc95(0x1dd)](_0x10c705,_0x1508ed+(_0x4e3ebb+0x1)*_0xae05ce[_0xbbbc95(0x1e7)]-_0xae05ce[_0xbbbc95(0x1a0)][_0xbbbc95(0x163)],_0x5ccf66+(_0x50c9ca+0x1)*_0xae05ce[_0xbbbc95(0x1ff)]-_0xae05ce['selfmadeCard'][_0xbbbc95(0x1f3)]-_0x1a386c[_0xbbbc95(0x1cf)]);}}_0x1a97b9[_0xbbbc95(0x25d)](),_0x1a97b9[_0xbbbc95(0x21d)]();}{_0x1a97b9[_0xbbbc95(0x22b)](),_0x1a97b9[_0xbbbc95(0x1ad)]=_0xae05ce[_0xbbbc95(0x1a0)][_0xbbbc95(0x167)]+'px\x20\x22'+_0xae05ce['selfmadeCard']['nameLabelFontName']+'\x22',_0x1a97b9[_0xbbbc95(0x178)]=_0xae05ce[_0xbbbc95(0x1a0)][_0xbbbc95(0x1f8)],_0x1a97b9[_0xbbbc95(0x18a)]=_0xbbbc95(0x239);const _0x119aac=_0x1a97b9['measureText'](_0xae05ce['selfmadeCard'][_0xbbbc95(0x276)]),_0x22b381=_0xae05ce[_0xbbbc95(0x1c0)]-_0xae05ce['userNameAreaWidth']/0x2-_0xae05ce[_0xbbbc95(0x1a0)][_0xbbbc95(0x1f4)]-_0x119aac[_0xbbbc95(0x1f6)],_0x509779=_0xae05ce[_0xbbbc95(0x1c0)]+_0xae05ce['userNameAreaWidth']/0x2;_0x1a97b9[_0xbbbc95(0x1dd)](_0xae05ce[_0xbbbc95(0x1a0)][_0xbbbc95(0x276)],_0x22b381,_0xae05ce[_0xbbbc95(0x26c)]-_0x119aac[_0xbbbc95(0x1cf)]);const _0x5437a5=_0xae05ce[_0xbbbc95(0x26c)]+_0xae05ce['selfmadeCard'][_0xbbbc95(0x16a)];_0x1a97b9[_0xbbbc95(0x20a)]=_0xae05ce[_0xbbbc95(0x1a0)][_0xbbbc95(0x1f8)],_0x1a97b9[_0xbbbc95(0x171)]=_0xae05ce[_0xbbbc95(0x1a0)]['nameLabelBorderWidth'],_0x1a97b9['beginPath'](),_0x1a97b9[_0xbbbc95(0x21f)](_0x22b381-_0xae05ce[_0xbbbc95(0x1a0)][_0xbbbc95(0x1df)],_0x5437a5),_0x1a97b9[_0xbbbc95(0x1c8)](_0x509779+_0xae05ce[_0xbbbc95(0x1a0)][_0xbbbc95(0x1df)],_0x5437a5),_0x1a97b9['stroke'](),_0x1a97b9[_0xbbbc95(0x21d)]();}}const _0x24cb30=newElem(_0xbbbc95(0x246));{_0x24cb30[_0xbbbc95(0x1f6)]=_0xae05ce[_0xbbbc95(0x1d1)],_0x24cb30[_0xbbbc95(0x1d5)]=_0xae05ce[_0xbbbc95(0x22d)];const _0x4893d1=_0x24cb30[_0xbbbc95(0x1a6)]('2d');_0x4893d1['strokeStyle']=_0xae05ce[_0xbbbc95(0x187)][_0xbbbc95(0x1ca)],_0x4893d1[_0xbbbc95(0x171)]=_0xae05ce[_0xbbbc95(0x187)][_0xbbbc95(0x258)],_0x4893d1[_0xbbbc95(0x1c3)](),_0x4893d1[_0xbbbc95(0x1bc)](_0xae05ce[_0xbbbc95(0x1d1)]/0x2,_0xae05ce['stampHeight']/0x2,_0xae05ce[_0xbbbc95(0x187)]['circleRadius'],0x0,Math['PI']*0x2),_0x4893d1[_0xbbbc95(0x25d)](),_0x4893d1['fillStyle']=_0xae05ce[_0xbbbc95(0x187)][_0xbbbc95(0x1ca)],_0x4893d1[_0xbbbc95(0x243)]=_0xbbbc95(0x17a),_0x4893d1[_0xbbbc95(0x18a)]=_0xbbbc95(0x239),_0x4893d1[_0xbbbc95(0x1ad)]=_0xae05ce[_0xbbbc95(0x187)][_0xbbbc95(0x1bd)]+_0xbbbc95(0x1e8);const _0x5a7fc0=_0x4893d1['measureText'](_0xae05ce[_0xbbbc95(0x187)][_0xbbbc95(0x223)]);_0x4893d1[_0xbbbc95(0x1dd)](_0xae05ce[_0xbbbc95(0x187)][_0xbbbc95(0x223)],_0xae05ce[_0xbbbc95(0x1d1)]/0x2,_0xae05ce[_0xbbbc95(0x22d)]/0x2+(_0x5a7fc0[_0xbbbc95(0x241)]-_0x5a7fc0[_0xbbbc95(0x1cf)])/0x2);}return[_0x64698c,_0x24cb30];}(async _0x2a98ea=>{const _0x376d72=_0x2b9d82,_0xb2e328=document[_0x376d72(0x172)]('#userName'),_0xf36078=document[_0x376d72(0x172)](_0x376d72(0x1bb)),_0x5020e7=document[_0x376d72(0x172)](_0x376d72(0x25e)),_0x209870=document[_0x376d72(0x172)](_0x376d72(0x179)),_0x5c9bf2=document[_0x376d72(0x172)](_0x376d72(0x180)),_0x585874=document[_0x376d72(0x172)](_0x376d72(0x260)),_0x50ac63=document[_0x376d72(0x172)](_0x376d72(0x1b1)),_0x27df2b=document[_0x376d72(0x172)](_0x376d72(0x195)),_0x2c6ec7=()=>{const _0x3db442=_0x376d72;while(_0x27df2b[_0x3db442(0x1be)])_0x27df2b[_0x3db442(0x177)](_0x27df2b[_0x3db442(0x1be)]);_0x27df2b[_0x3db442(0x204)]='';},_0x444e85=_0x4d2289=>{const _0x4a04c8=_0x376d72,_0x122f07=_0x4d2289[_0x4a04c8(0x1b7)]('\x0a')['trim']();_0x27df2b[_0x4a04c8(0x1ef)](newElem('p',[_0x122f07],[],{'style':_0x4a04c8(0x259)}));},_0x25339a={};_0x25339a[_0x376d72(0x174)]=[],_0x25339a[_0x376d72(0x257)]=null;{const _0x187b17=window['localStorage']?JSON[_0x376d72(0x218)](window[_0x376d72(0x1d8)][_0x376d72(0x198)](StorageKey)):null,_0x1593f7=(_0x2dddea,_0x48b654)=>_0x187b17?_0x187b17[_0x2dddea]??_0x48b654:_0x48b654,_0x362205=()=>{const _0x3dee46=_0x376d72,_0x2f4c56=(_0x1d7d76,_0x4c47cc)=>{const _0x414b61=_0x171f;return _0x1d7d76?(_0x50ac63[_0x414b61(0x1c1)](_0x414b61(0x210)),_0x50ac63['setAttribute'](_0x414b61(0x256),_0x2a98ea['helps'][_0x414b61(0x1c9)][_0x414b61(0x25a)])):(_0x50ac63[_0x414b61(0x19e)](_0x414b61(0x210),_0x414b61(0x210)),_0x50ac63[_0x414b61(0x19e)](_0x414b61(0x256),_0x4c47cc)),_0x1d7d76;};if(_0x5020e7['value']===_0x3dee46(0x1b2)){if(_0x5c9bf2[_0x3dee46(0x16f)][_0x3dee46(0x1a8)]<0x1)return _0x2f4c56(![],'カード画像が選択されていません。');if(_0x585874[_0x3dee46(0x16f)][_0x3dee46(0x1a8)]<0x1)return _0x2f4c56(![],_0x3dee46(0x1d2));}return _0x2f4c56(!![]);};_0x2a98ea['debugValues'][_0x376d72(0x1f0)]?_0xb2e328[_0x376d72(0x251)]=_0x376d72(0x18c):_0xb2e328[_0x376d72(0x251)]=_0x1593f7('userName',_0x2a98ea[_0x376d72(0x266)]['userName']);_0xf36078[_0x376d72(0x232)]=_0x1593f7('randomStamping',_0x2a98ea[_0x376d72(0x266)][_0x376d72(0x219)]),_0xf36078[_0x376d72(0x20d)][_0x376d72(0x1fc)]=_0x2a98ea[_0x376d72(0x225)][_0x376d72(0x1c9)][_0x376d72(0x202)],_0x5020e7['value']=_0x1593f7(_0x376d72(0x1f9),_0x2a98ea[_0x376d72(0x266)][_0x376d72(0x1f9)]);_0x5020e7[_0x376d72(0x1b3)]===-0x1&&(_0x5020e7[_0x376d72(0x1b3)]=0x0);const _0x33b094=_0x31ddc5=>{const _0x5e0124=_0x376d72;_0x209870[_0x5e0124(0x182)][_0x5e0124(0x1db)]=_0x5020e7[_0x5e0124(0x251)]===_0x5e0124(0x1b2)?_0x5e0124(0x16e):_0x5e0124(0x245),_0x2c6ec7(),_0x362205();};_0x5020e7[_0x376d72(0x1e1)](_0x376d72(0x1a3),_0x33b094),_0x33b094(),[_0x5c9bf2,_0x585874]['forEach'](_0x5e772f=>_0x5e772f[_0x376d72(0x1e1)](_0x376d72(0x1a3),_0x362205));{_0x2a98ea[_0x376d72(0x268)][_0x376d72(0x1f0)]?(_0x25339a['logEntries']=[],Array[_0x376d72(0x17b)]({'length':_0x2a98ea[_0x376d72(0x268)]['dummyStampCount']??0x64})['reduce']((_0x207345,_0x156832,_0x349139)=>{const _0x3ee1ed=_0x376d72,_0x3add55=new Date(_0x207345);return _0x25339a['logEntries'][_0x3ee1ed(0x183)]({'id':_0x349139+0x1,'date':toValueFromDate(_0x3add55),'url':_0x2a98ea['debugValues']['dummyLogEntryURL'],'remarks':_0x3add55[_0x3ee1ed(0x25b)]()===0x6?_0x3ee1ed(0x197):_0x3ee1ed(0x253)}),_0x207345+0x5265c00/(_0x3add55[_0x3ee1ed(0x25b)]()===0x6?0x2:0x1);},(_0x29fcb3=>_0x29fcb3-_0x29fcb3%0x5265c00)(Date['now']()))):_0x25339a[_0x376d72(0x174)]=_0x1593f7(_0x376d72(0x174),[]),_0x25339a[_0x376d72(0x257)]=_0x25339a['logEntries'][_0x376d72(0x1c5)]((_0x35e6cd,_0x2f3f31)=>Math['max'](_0x35e6cd,_0x2f3f31['id']),0x1),_0x25339a[_0x376d72(0x209)]=()=>{const _0x2a920b=_0x376d72;_0x25339a[_0x2a920b(0x174)][_0x2a920b(0x24a)]((_0x46e286,_0x5451f2)=>{const _0x25a4dd=_0x2a920b,_0x2e7c6e=_0x46e286[_0x25a4dd(0x264)][_0x25a4dd(0x1af)](_0x5451f2[_0x25a4dd(0x264)]);return _0x2e7c6e===0x0?_0x46e286['id']-_0x5451f2['id']:_0x2e7c6e;});};}}{const _0x435e3f=async(_0x33a7f8,_0x4464eb,_0x26b867=![])=>{const _0x28b372=_0x376d72,_0xf65e7=newElem(_0x28b372(0x233),[],[],{'type':_0x28b372(0x264),'value':_0x4464eb[_0x28b372(0x264)]??toValueFromDate(new Date())}),_0x548827=newElem(_0x28b372(0x233),[],[_0x28b372(0x1da)],{'type':_0x28b372(0x223),'value':_0x4464eb['url']??''}),_0x37f832=newElem(_0x28b372(0x233),[],[_0x28b372(0x1da)],{'type':_0x28b372(0x223),'value':_0x4464eb[_0x28b372(0x1e2)]??''});_0x26b867&&(_0xf65e7[_0x28b372(0x19e)](_0x28b372(0x249),'readonly'),_0x548827['setAttribute'](_0x28b372(0x249),_0x28b372(0x249)),_0x37f832['setAttribute'](_0x28b372(0x249),_0x28b372(0x249)));const _0xeb81a3=newElem(_0x28b372(0x1a1),[newElem('p',[_0x33a7f8],[],{'style':_0x28b372(0x191)}),newElem('label',[_0x28b372(0x23c),_0xf65e7]),newElem('br'),newElem(_0x28b372(0x1a4),[_0x28b372(0x205),_0x548827,newElem(_0x28b372(0x1a1),[_0x2a98ea[_0x28b372(0x225)][_0x28b372(0x1c9)]['logEntryURL']],['tltp-for-prev-input'])]),newElem('br'),newElem(_0x28b372(0x1a4),[_0x28b372(0x235),_0x37f832,newElem('div',[_0x2a98ea[_0x28b372(0x225)][_0x28b372(0x1c9)][_0x28b372(0x184)]],['tltp-for-prev-input'])])]),_0x45f749=_0x26b867?![]:[_0xf65e7,_0x548827,_0x37f832],_0x2259a7=await showConfirmDialog(_0xeb81a3,{'focusable':_0x45f749,'defaultIsYes':![]});if(_0x2259a7){if(!_0xf65e7[_0x28b372(0x251)])return![];_0x4464eb['date']=_0xf65e7[_0x28b372(0x251)],_0x4464eb[_0x28b372(0x18b)]=_0x548827[_0x28b372(0x251)],_0x4464eb['remarks']=_0x37f832[_0x28b372(0x251)];}return _0x2259a7;},_0x3f84d0=document['querySelector']('#logEntryTable'),_0x34552f=()=>{const _0x1fab54=_0x376d72;_0x3f84d0[_0x1fab54(0x177)](_0x3f84d0[_0x1fab54(0x172)](_0x1fab54(0x269)));const _0x5e031e=newElem('tbody',_0x25339a[_0x1fab54(0x174)][_0x1fab54(0x162)]((_0x3ab15e,_0x3e42e0)=>{const _0x16c18f=_0x1fab54,_0x50faec=newElem(_0x16c18f(0x228),['編集']);_0x50faec[_0x16c18f(0x1e1)](_0x16c18f(0x1ac),async()=>{const _0x21b6f4=await _0x435e3f('編集',_0x3ab15e);_0x21b6f4&&(_0x25339a['sortLogEntries'](),_0x34552f());});const _0x2a08ec=newElem(_0x16c18f(0x228),['削除']);return _0x2a08ec[_0x16c18f(0x1e1)]('click',async()=>{const _0x515b7d=_0x16c18f,_0x1a7c05=_0x25339a[_0x515b7d(0x174)][_0x515b7d(0x1ea)](_0x3ab15e);if(_0x1a7c05!==-0x1){const _0x2435aa=await _0x435e3f(_0x515b7d(0x19a),_0x3ab15e,!![]);_0x2435aa&&(_0x25339a[_0x515b7d(0x174)]['splice'](_0x1a7c05,0x1),_0x34552f());}}),newElem('tr',[newElem('td',[_0x3e42e0+0x1+''],['number-cell']),newElem('td',[_0x3ab15e[_0x16c18f(0x264)]],[_0x16c18f(0x231)]),newElem('td',[newElem('a',[_0x3ab15e[_0x16c18f(0x18b)]],[_0x16c18f(0x231)],{'href':_0x3ab15e[_0x16c18f(0x18b)]})]),newElem('td',[_0x3ab15e[_0x16c18f(0x1e2)]],[_0x16c18f(0x231)]),newElem('td',[_0x50faec,_0x2a08ec])]);}));_0x3f84d0[_0x1fab54(0x1ef)](_0x5e031e);},_0x476912=newElem(_0x376d72(0x228),['ログ追加']);_0x3f84d0[_0x376d72(0x172)](_0x376d72(0x270))['appendChild'](newElem('tr',[newElem('th',[_0x376d72(0x212)]),newElem('th',['日付'],['tltp-on-hover',_0x376d72(0x1c7)],{'data-tltp-text':_0x2a98ea[_0x376d72(0x225)][_0x376d72(0x1c9)]['logEntryDate']}),newElem('th',['URL'],[_0x376d72(0x1da),_0x376d72(0x277),'tltp-always'],{'data-tltp-text':_0x2a98ea['helps'][_0x376d72(0x1c9)][_0x376d72(0x262)]}),newElem('th',['備考'],[_0x376d72(0x1da),_0x376d72(0x277),_0x376d72(0x1c7)],{'data-tltp-text':_0x2a98ea[_0x376d72(0x225)][_0x376d72(0x1c9)][_0x376d72(0x184)]}),newElem('th',[_0x476912])])),_0x476912[_0x376d72(0x1e1)](_0x376d72(0x1ac),async()=>{const _0x24965b=_0x376d72,_0x1669bf={'id':_0x25339a['maxIdNumber']+0x1},_0x381268=await _0x435e3f('追加',_0x1669bf);_0x381268&&(_0x25339a['maxIdNumber']+=0x1,_0x25339a['logEntries'][_0x24965b(0x183)](_0x1669bf),_0x25339a[_0x24965b(0x209)](),_0x34552f());}),_0x34552f();}document['querySelector'](_0x376d72(0x23f))['addEventListener'](_0x376d72(0x1ac),async()=>{const _0x491c61=_0x376d72;removeChildren(document[_0x491c61(0x172)](_0x491c61(0x23a)));}),document[_0x376d72(0x172)](_0x376d72(0x220))[_0x376d72(0x1e1)]('click',async()=>{const _0x11494b=_0x376d72;if(window[_0x11494b(0x1d8)]){const _0x3c7b9e={'userName':_0xb2e328[_0x11494b(0x251)],'randomStamping':_0xf36078['checked'],'logEntries':_0x25339a[_0x11494b(0x174)],'imageType':_0x5020e7[_0x11494b(0x251)]===_0x11494b(0x1b2)?_0x11494b(0x26e):_0x5020e7[_0x11494b(0x251)]};window[_0x11494b(0x1d8)][_0x11494b(0x181)](StorageKey,JSON[_0x11494b(0x267)](_0x3c7b9e));}}),_0x50ac63['addEventListener'](_0x376d72(0x1ac),async()=>{const _0x59eae7=_0x376d72,_0x4a4fad=Object[_0x59eae7(0x221)]({},_0x2a98ea[_0x59eae7(0x1c6)][_0x59eae7(0x207)]),_0x54d5d1={'randomStamping':_0xf36078[_0x59eae7(0x232)],'fontName':_0x2a98ea[_0x59eae7(0x266)][_0x59eae7(0x272)],'userName':_0xb2e328[_0x59eae7(0x251)]||_0x59eae7(0x18c),'logEntries':_0x25339a[_0x59eae7(0x174)][_0x59eae7(0x17e)](0x0,0x64)};_0x2c6ec7();let _0x20b39d,_0x8dbacb;const _0x2da9fd=_0x5020e7['value'];if(_0x2da9fd==='simple')[_0x20b39d,_0x8dbacb]=generateCardAndStampImage(_0x4a4fad);else{const _0x347834=[{'fileInput':_0x5c9bf2},{'fileInput':_0x585874}],_0x56b94d=(await Promise['all'](_0x347834[_0x59eae7(0x162)](_0x3c8e85=>readInputFileSrc(_0x3c8e85[_0x59eae7(0x271)][_0x59eae7(0x16f)][0x0])['then'](loadSyncImage)[_0x59eae7(0x1a5)](_0x5636f4=>({'error':_0x5636f4})))))['reduce']((_0x35f6eb,_0x1c5f48,_0x375721)=>{const _0x572e74=_0x59eae7;return _0x1c5f48 instanceof HTMLImageElement?_0x347834[_0x375721][_0x572e74(0x175)]=_0x1c5f48:_0x35f6eb[_0x572e74(0x183)](_0x347834[_0x375721][_0x572e74(0x271)][_0x572e74(0x16f)][0x0][_0x572e74(0x1d6)]),_0x35f6eb;},[]);if(_0x56b94d[_0x59eae7(0x1a8)]>0x0){_0x444e85([_0x59eae7(0x229)]['concat'](_0x56b94d));return;}[_0x20b39d,_0x8dbacb]=_0x347834[_0x59eae7(0x162)](_0x58d904=>_0x58d904[_0x59eae7(0x175)]);}const _0x34d78d=document[_0x59eae7(0x172)](_0x59eae7(0x23a));removeChildren(_0x34d78d);const _0x3386eb=await generateReportCanvas(_0x20b39d,_0x8dbacb,_0x54d5d1,_0x4a4fad);await showReportImage(_0x34d78d,_0x3386eb);}),_0x2a98ea[_0x376d72(0x268)][_0x376d72(0x1f0)]&&_0x50ac63['click']();})(getInitValues());
    
    function getInitValues() {
      return {
        helps: {
          tltpTexts: {
            settingsRandomStamping: 'onの場合、ポポちゃんらしく元気に押印します！\noffの場合、正確に中心＆回転無しで押印します。',
            showReportOKMesage: '表示されたレポートをクリックで画像として保存できます。',
            
            logEntryDate: 'ポポイントを貰った日付 (土曜は２倍)',
            logEntryURL: 'ポポイントを貰ったことを確認できる配信やツイートのURL',
            logEntryRemarks: '配信のタイムスタンプや貰った理由・メモなど',
          },
        },
        
        defaultValues: {
          userName: '',
          imageType:'simple',
          fontName: '',
          //fontName: 'たぬき油性マジック',
          randomStamping: true,
        },
        debugValues: {
          debugMode: false,
          dummyStampCount: 100,
          dummyLogEntryURL: 'https://twitter.com/Popo_Ieiri/status/1464024238676144129',
        },
        pageOptions: {
          // 1カード20スタンプ＆最大100ポポイントは決め打ちで変更不可能とします
          layout: {
            // 参考にしたカード画像のサイズ
            cardWidth  : 1074,
            cardHeight :  649,
            stampWidth :  300,
            stampHeight:  250,
            // カード内の配置
            stampOffsetXRightMarginForNumber: 20, // スタンプが数字に被らないようにマス目の中心から左にずらす
            stampOffsetX:  70,
            stampOffsetY:  25,
            stampStepX  : 196, //192, 198, 203, 191
            stampStepY  : 125,
            stampSizeRate: 0.50,
            stampCenterX: 75,
            stampCenterY: 75,
            stampRandomPosHalfRange: 6,
            userNameCenterX: 800,
            userNameBottomY: 616,
            userNameAreaWidth : 444,
            userNameAreaHeight:  64,
            userNameFontSize: 60, // 最大値
            // レポート全体
            reportWidth : 1200,
            reportMaxHeight: 2800,
            reportBottomMargin: 5,
            reportBackgroundColor: '#FFFFFF',
            reportTextColor: '#333333',
            titleText: 'ポポイントカード履歴',
            titleFontSize: 72,
            titleBottomY:  96,
            cardStartY: 135,
            cardOffset: 15,
            logSummaryYOffset: 80,
            logSummaryFontSize: 32,
            logEntryYOffset: 36,
            logEntryFontSize: 14,
            logEntryLineHeight: 18,
            logItemIndexTextRight  : 40,
            logItemDateTextLeft    : 65,
            logItemURLTextLeft     : 175,
            logItemRemarksTextLeft : 680,
            logItemURLTextWidth    : 470,
            logItemRemarksTextWidth: 480,
            
            // カード画像自前作成
            selfmadeCard: {
              backgroundColor: '#FFC803',
              outerBorderColor: '#999999',
              innerBorderColor: '#CCCCCC',
              outerBorderWidth: 8,
              innerBorderWidth: 3,
              numberFontColor: '#CCCCCC',
              numberFontHeightRate: 0.34,
              numberPaddingRight: 5,
              numberPaddingBottom: 10,
              nameLabelColor: '#888888',
              nameLabelBorderWidth: 8,
              nameLabelPaddingRight: 8,
              nameLabelPaddingBottom: 12,
              nameLabelMarginHorizontal: 6,
              nameLabelText: 'なまえ',
              nameLabelFontSize: 42,
              nameLabelFontName: '',
            },
            // スタンプ画像自前作成
            selfmadeStamp: {
              color: '#EE9900',
              circleRadius: 110,
              circleLineWidth: 3,
              fontSize: 160,
              text: 'ポ',
            },
          },
          
          imageSets: [
            // 今のところ未実装
          ],
        },
      };
    }
  </script>
</body>
</html>
