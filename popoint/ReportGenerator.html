<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:title" content="ポポイントカード履歴管理">
  <meta property="og:url"   content="https://pecmm.github.io/popoint/ReportGenerator.html" />
  <meta property="og:image" content="https://pecmm.github.io/popoint/thumb/ReportGenerator.png?08226fe9">
  <title>ポポイントカード履歴管理</title>
  <link rel='stylesheet' href='../assets/accordion.css' />
  <link rel='stylesheet' href='../assets/tooltip.css' />
  <style>
    #userInputArea {
      margin-bottom: 1em;
    }
    #userInputArea label {
      user-select: none;
    }
    #userInputArea #settingTable th {
      text-align: right;
    }
    #userInputArea > table {
      margin-bottom: 1em;
    }
    #imageTypeUserImageArea > #files {
      text-align: right;
    }
    #imageTypeUserImageArea input[type='file'] {
      margin-top: 5px;
      padding: 20px;
      width: 360px;
      background-color: #DDDDDD;
    }
    
    .numberinput {
      width: 6em;
      text-align: right;
    }
    .textinput {
      min-width: 32em;
    }
    
    #logEntryTable {
      margin-top: 1em;
      border-collapse: collapse;
      white-space: nowrap;
    }
    #logEntryTable thead {
      border-bottom-style: double;
    }
    #logEntryTable tr:hover td {
      background-color: #FFFFCC;
    }
    #logEntryTable button {
      font-size: 75%;
    }
    #logEntryTable .number-cell {
      text-align: right;
      padding-left : 0.5em;
      padding-right: 0.5em;
    }
    #logEntryTable .text-cell {
      padding-left : 0.5em;
      padding-right: 0.5em;
    }
    
    #resultArea canvas {
      border: solid 2px blue;
    }
    #resultArea canvas:hover {
      border-color: red;
    }
    
    #helpArea * {
      font-size: 0.95em;
    }
    #helpArea .titleHeader {
      border-bottom: solid #999999 1px;
      margin-bottom: 0.2em;
      padding-left: 0.5em;
      background-color: #EEEEEE;
    }
    #helpArea #accordion-ontime-item > ul {
      margin-top    : 0px;
      margin-bottom : 0.5em;
      padding-top   : 0.2em;
      padding-bottom: 0.2em;
    }
  </style>
</head>

<body>
  <h1>ポポイントカード履歴管理</h1>
  
  <div>ver: <span id="version"></span></div>
  <div id='helpArea' class='accordion-box'>
    <input id='help-accordion-check' class='accordion-check' type='checkbox' />
    <label for='help-accordion-check' class='accordion-ontime' >■Helpを隠す</label>
    <label for='help-accordion-check' class='accordion-offtime'>■Helpを表示</label>
    <div class='accordion-ontime'>
      <div class='accordion-ontime-item'>
        <span class='titleHeader' style='display:block;'>ログの保存・公開</span>
        <ul>
          <li>ブラウザの機能でログを記録しているので、複数環境でのログ共有は対応していません。<br />(ページ表示以降は通信によるデータ送受信はしていま
          せん)</li>
          <li>他ユーザへのログ公開はレポートの画像保存機能のみで対応しています。</li>
        </ul>
        <span class='titleHeader' style='display:block;'>操作</span>
        <ul>
          <li>元に戻す機能はないので、『入力をブラウザに保存』せずに画面リロードなどで前回保存直後に戻してください。</li>
        </ul>
        <span class='titleHeader' style='display:block;'>カード・スタンプの画像について</span>
        <ul>
          <li>サイズおよびスタンプ・名前の位置さえ合っていれば、好きな画像を使用できます。
            <ul>
              <li>カードの画像： 1074x649(px)</li>
              <li>スタンプ画像： 300x250(px)</li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </div>
  
  <div id='userInputArea'>
    <table id='logEntryTable' border='1'>
      <caption>ログ</caption>
      <thead></thead>
      <tbody></tbody>
    </table>
    <table id='settingTable' border='1' cellpadding='5'>
      <caption>レポート設定</caption>
      <tr> <th>なまえ</th> <td><input type='text' id='userName' /></td> </tr>
      <tr> <th>スタンプ</th> <td><label><input type='checkbox' id='randomStamping' class='tltp-on-hover tltp-always'>雑にスタンプを押す</label></td> </tr>
      <tr> <th>フォント名</th> <td><input type='text' id='fontName' /><div class='tltp-for-prev-input tltp-right'>レポートのフォント名<br />(windows であれば、メモ帳(notepad)を起動して、書式→フォント変更ダイアログからフォント名コピペ等で取得)</div></td> </tr>
      <tr> <th>画像タイプ</th> <td>
        <select id='imageTypeSelector'>
          <option value='simple'>シンプル</option>
          <option value='userImage'>ユーザの画像</option>
        </select>
        <div id='imageTypeUserImageArea'>
          <hr />
          <div id='files'>
              <label>カード画像：<input type='file' accept='image/*' id='cardUserImage' ></label><br />
            <label>スタンプ画像：<input type='file' accept='image/*' id='stampUserImage'></label><br />
          </div>
          <div id='errorMessageArea'></div>
        </div>
      </td> </tr>
    </table>
    
    <hr />
    <button id='saveInput'>入力をブラウザに保存</button>
    <button id='showReport' class='tltp-on-hover tltp-always tltp-top' data-tltp-text=''>レポート表示</button>
    <button id='clearReport'>表示クリア</button>
  </div>
  <div id='resultArea'>
  </div>
  
  
  <script>
    const AppVersion = "1.2.0";
    
    // ここから
const _0x252c6c=_0x5000;(function(_0x3fc5e6,_0x18dea5){const _0x46c223=_0x5000,_0xad50d9=_0x3fc5e6();while(!![]){try{const _0x192692=parseInt(_0x46c223(0x1bf))/0x1+-parseInt(_0x46c223(0x291))/0x2*(-parseInt(_0x46c223(0x2b5))/0x3)+parseInt(_0x46c223(0x23f))/0x4*(-parseInt(_0x46c223(0x274))/0x5)+-parseInt(_0x46c223(0x1d5))/0x6*(parseInt(_0x46c223(0x20c))/0x7)+-parseInt(_0x46c223(0x25c))/0x8+parseInt(_0x46c223(0x23a))/0x9+-parseInt(_0x46c223(0x2a3))/0xa*(-parseInt(_0x46c223(0x1c7))/0xb);if(_0x192692===_0x18dea5)break;else _0xad50d9['push'](_0xad50d9['shift']());}catch(_0xa35710){_0xad50d9['push'](_0xad50d9['shift']());}}}(_0x1ca6,0xb19ef),document[_0x252c6c(0x244)](_0x252c6c(0x259))[_0x252c6c(0x2a1)]=AppVersion);function randomRangedInt(_0x4b1372,_0x5a9152){const _0x408d3c=_0x252c6c;return Math['floor'](Math[_0x408d3c(0x1d9)]()*(_0x5a9152-_0x4b1372+0x1))+_0x4b1372;}function newElem(_0x4c4ff3,_0x123b06=[],_0xb6fb2e=[],_0x36629c={}){const _0x115cb7=_0x252c6c,_0x2c77ab=document[_0x115cb7(0x25d)](_0x4c4ff3);return _0xb6fb2e[_0x115cb7(0x281)]>0x0&&_0x2c77ab[_0x115cb7(0x248)][_0x115cb7(0x1db)](..._0xb6fb2e),Object[_0x115cb7(0x218)](_0x36629c)[_0x115cb7(0x2a2)](_0x53509b=>{const _0x37799f=_0x115cb7;_0x2c77ab[_0x37799f(0x1fd)](_0x53509b,_0x36629c[_0x53509b]);}),_0x123b06[_0x115cb7(0x2a2)](_0x1147a4=>{const _0x217ebb=_0x115cb7;typeof _0x1147a4===_0x217ebb(0x1f9)?_0x2c77ab['appendChild'](document[_0x217ebb(0x229)](_0x1147a4)):_0x2c77ab[_0x217ebb(0x25f)](_0x1147a4);}),_0x2c77ab;}function _0x1ca6(){const _0x3ba9cd=['measureText','drawingStampCount','getMinutes','catch','#randomStamping','join','reportTextColor','URL','dummyLogEntryURL','font-weight:bold;','土曜は２倍デー！','globalAlpha','337945MLUgQp','getContext','getSeconds','exec','Cancel','ppt.\x20','top','key','#imageTypeUserImageArea','\x22,\x20','position','color','strokeStyle','length','margin','actualBoundingBoxAscent','createObjectURL','削除しますか？','userName','stopPropagation','stampCount','getItem','display:inline-block;\x20padding:0.5em;\x20color:#FF0000;\x20background-color:#FFFF00;\x20white-space:pre;','now','logItemIndexTextRight','cardWidth','keydown','#clearReport','thead','808558pdhEwO','stampWidth','fontName','toDataURL','nameLabelFontName','nameLabelPaddingRight','fileInput','fillRect','stampCenterY','addEventListener','userImage','logEntryPopoint','20px','solid\x20#DDDDDD\x203px','logItemURLTextWidth','minWidth','textContent','forEach','100Kolyqa','cardOffset','none','center','canvas','map','#showReport','min','getDate','defaultValues','parse','popointCard-lastInputValues','stampHeight','from','split','stampStepY','trim','logEntryRemarks','3idRWQF','ceil','userNameAreaHeight','altKey','onerror','helps','url','font','12px\x200','numberPaddingBottom','fillText','translate','備考\x20','ctrlKey','focus','fixed','stampRandomPosHalfRange','sortLogEntries','debugValues','splice','noLabel','left','number','tltpTexts','src','reduce','marginTop','showReportOKMesage','style','5px\x2030px\x2010px','border','stampCenterX','logEntryLineHeight','assign','ポポイントカード履歴-','getDay','imageType','nameLabelMarginHorizontal','370789DGQBsM','getHours','lineWidth','value','div','tltp-on-hover','cardStartY','logSummaryYOffset','1603514ccrJJT','nameLabelPaddingBottom','img','max','confirmDialog','shiftKey','userNameFontSize','#errorMessageArea','logEntries','getFullYear','240px','...','reportWidth','px\x20','6Mmspej','100%','input','userNameCenterX','random','fillStyle','add','circleLineWidth','logEntryFontSize','stampSizeRate','getBoundingClientRect','simple','Tab','nameLabelBorderWidth','justifyContent','logItemRemarksTextLeft','pageOptions','borderRadius','layout','remarks','height','outerBorderColor','beginPath','#resultArea','opacity','concat','disabled','removeChild','text','number-cell','width','logEntryURL','stampStepX','#saveInput','lineTo','logSummaryFontSize','string','tltp-always','clip','numberPaddingRight','setAttribute','click','localStorage','selfmadeCard','#cardUserImage','更新日：','画像の読み込みに失敗しました','keypress','target','space-around','push','logEntryYOffset','logItemPopointRight','numberFontColor','nameLabelColor','8597701mLPUzg','text-cell','randomStamping','baseElement','debugMode','zIndex','nameLabelText','textinput','maxIdNumber','label','#666666','rotate','getOwnPropertyNames','#FFFFFF','preventDefault','selfmadeStamp','outerBorderWidth','button','rect','readonly','stampOffsetXRightMarginForNumber','localeCompare','arc','titleFontSize','files','innerWidth','defaultIsYes','indexOf','0px','createTextNode','right','cardHeight','#logEntryTable','ppt','tbody','stampOffsetY','drawImage','textAlign','tltp-for-prev-input','userNameBottomY','data-tltp-text','change','focusable','reportBackgroundColor','checked','firstChild','12884157WWLqrt','#userName','save','padding','isArray','68QKzmdP','moveTo','textBaseline','backgroundColor','stampOffsetX','querySelector','all','display','actualBoundingBoxDescent','classList','onload','toString','settingsRandomStamping','numberFontHeightRate','result','restore','selectedIndex','dataset','logItemPopointPadding','表示確認用','bottom','date','logEntryDate','#stampUserImage','reportTempHeight','ログ追加','#version','flex','block','4476720roEhJs','createElement','getMonth','appendChild','userNameAreaWidth','logItemRemarksTextWidth','titleBottomY','nameLabelFontSize','No.','removeAttribute','#333333','stroke'];_0x1ca6=function(){return _0x3ba9cd;};return _0x1ca6();}function loadSyncImage(_0x226e9d){return new Promise((_0x301a10,_0x271618)=>{const _0x1cccae=_0x5000,_0x4c5fcb=new Image();_0x4c5fcb[_0x1cccae(0x249)]=()=>_0x301a10(_0x4c5fcb),_0x4c5fcb[_0x1cccae(0x2b9)]=_0x1c9402=>_0x271618(_0x1c9402),_0x4c5fcb[_0x1cccae(0x1b1)]=_0x226e9d;});}function readInputFileSrc(_0x553d08){return new Promise((_0x1b49a0,_0x2926c4)=>{const _0x2d782a=_0x5000,_0x4abe77=new FileReader();_0x4abe77[_0x2d782a(0x249)]=()=>_0x1b49a0(_0x4abe77[_0x2d782a(0x24d)]),_0x4abe77[_0x2d782a(0x2b9)]=_0x50778c=>_0x2926c4(_0x50778c),_0x4abe77['readAsDataURL'](_0x553d08);});}function srcToURL(_0x43d731){const _0x173a01=_0x252c6c,_0x451993=atob(_0x43d731[_0x173a01(0x2b1)](',')[0x1]),_0x3064d3=/:([a-zA-Z\/]+);/[_0x173a01(0x277)](_0x43d731)[0x1],_0x21a414=Uint8Array[_0x173a01(0x2b0)](_0x451993[_0x173a01(0x2b1)](''),_0x521045=>_0x521045['charCodeAt']()),_0x22b05e=new Blob([_0x21a414],{'type':_0x3064d3});return URL[_0x173a01(0x284)](_0x22b05e);}function pad0String(_0x457619,_0x174c73){const _0x5a01b9=_0x252c6c;return _0x174c73[_0x5a01b9(0x24a)]()['padStart'](_0x457619,'0');}function getDateStringForFile(_0x3cec08){const _0x3a4b64=_0x252c6c;return _0x3cec08[_0x3a4b64(0x1d0)]()+'年'+pad0String(0x2,_0x3cec08['getMonth']()+0x1)+'月'+pad0String(0x2,_0x3cec08['getDate']())+'日-'+pad0String(0x2,_0x3cec08[_0x3a4b64(0x1c0)]())+'時'+pad0String(0x2,_0x3cec08[_0x3a4b64(0x26a)]())+'分'+pad0String(0x2,_0x3cec08[_0x3a4b64(0x276)]())+'秒';}function getDateForDisplay(_0x378657){const _0x58359f=_0x252c6c;return _0x378657[_0x58359f(0x1d0)]()+'/'+pad0String(0x2,_0x378657[_0x58359f(0x25e)]()+0x1)+'/'+pad0String(0x2,_0x378657[_0x58359f(0x2ab)]());}function toValueFromDate(_0x182c59){const _0x30b583=_0x252c6c;return _0x182c59[_0x30b583(0x1d0)]()+'-'+pad0String(0x2,_0x182c59['getMonth']()+0x1)+'-'+pad0String(0x2,_0x182c59['getDate']());}const parseIntOr=(_0x53a6bd,_0x455118,_0x4f5582)=>{const _0x1d8207=parseInt(_0x53a6bd,_0x455118);return Number['isNaN'](_0x1d8207)?_0x4f5582:_0x1d8207;};function getInnerValue(_0x440c91,_0x103819,_0x39091c){if(_0x440c91<_0x103819)return _0x103819;if(_0x440c91>_0x39091c)return _0x39091c;return _0x440c91;}function toSignedIntString(_0x10df1b){return(_0x10df1b<0x0?'':'+')+_0x10df1b;}function removeChildren(_0x14e5e3){const _0x511b31=_0x252c6c;while(_0x14e5e3[_0x511b31(0x239)]){_0x14e5e3[_0x511b31(0x1f0)](_0x14e5e3[_0x511b31(0x239)]);}}function showConfirmTextDialog(_0x17416f,_0x38f83c){const _0x381c70=_0x252c6c,_0x56dc86=newElem('p',[_0x17416f]);return _0x56dc86[_0x381c70(0x1b5)]['whiteSpace']='pre-line',showConfirmDialog(_0x56dc86,_0x38f83c);}function showConfirmDialog(_0x33b8db,_0x2be072){const _0x32e5cf=_0x252c6c;_0x2be072=Object[_0x32e5cf(0x1ba)]({'baseElement':document['body'],'focusable':![],'yesLabel':'OK','noLabel':_0x32e5cf(0x278),'defaultIsYes':!![],'positionElement':window},_0x2be072);const _0x3460b1=_0x2be072[_0x32e5cf(0x20f)],_0x6174c9=_0x2be072[_0x32e5cf(0x236)],_0x46879a=_0x2be072['yesLabel'],_0x534887=_0x2be072[_0x32e5cf(0x1ad)],_0x402c51=_0x2be072[_0x32e5cf(0x226)],_0x198043=_0x2be072['positionElement'],_0x333f8c=_0x534887==='',_0x26e464=newElem('button',[_0x46879a]),_0x294b17=newElem('button',[_0x534887]);_0x333f8c&&(_0x294b17[_0x32e5cf(0x1b5)][_0x32e5cf(0x246)]='none');const _0x59de7e=_0x333f8c?[_0x26e464]:[_0x26e464,_0x294b17],_0x249f94=newElem(_0x32e5cf(0x1c3),_0x59de7e),_0x363962=newElem(_0x32e5cf(0x1c3),[_0x33b8db,newElem('hr'),_0x249f94],[_0x32e5cf(0x1cb)]),_0x2c9756=newElem(_0x32e5cf(0x1c3)),_0x1d79ac=0xf423f;_0x363962['style'][_0x32e5cf(0x27e)]='fixed',_0x363962[_0x32e5cf(0x1b5)][_0x32e5cf(0x211)]=_0x1d79ac,_0x363962[_0x32e5cf(0x1b5)][_0x32e5cf(0x2a0)]=_0x32e5cf(0x1d1),_0x363962['style']['boxSizing']='border-box',_0x363962[_0x32e5cf(0x1b5)][_0x32e5cf(0x1b7)]=_0x32e5cf(0x29e),_0x363962[_0x32e5cf(0x1b5)][_0x32e5cf(0x1e6)]=_0x32e5cf(0x29d),_0x363962[_0x32e5cf(0x1b5)][_0x32e5cf(0x282)]=0x0,_0x363962[_0x32e5cf(0x1b5)][_0x32e5cf(0x23d)]=_0x32e5cf(0x1b6),_0x363962[_0x32e5cf(0x1b5)][_0x32e5cf(0x242)]=_0x32e5cf(0x219),_0x249f94[_0x32e5cf(0x1b5)][_0x32e5cf(0x246)]=_0x32e5cf(0x25a),_0x249f94[_0x32e5cf(0x1b5)][_0x32e5cf(0x1e3)]=_0x32e5cf(0x206),_0x2c9756[_0x32e5cf(0x1b5)][_0x32e5cf(0x27e)]=_0x32e5cf(0x1a8),_0x2c9756[_0x32e5cf(0x1b5)][_0x32e5cf(0x211)]=_0x1d79ac-0x1,_0x2c9756['style']['top']=0x0,_0x2c9756[_0x32e5cf(0x1b5)][_0x32e5cf(0x1ae)]=0x0,_0x2c9756[_0x32e5cf(0x1b5)][_0x32e5cf(0x1f3)]=_0x32e5cf(0x1d6),_0x2c9756[_0x32e5cf(0x1b5)][_0x32e5cf(0x1e9)]=_0x32e5cf(0x1d6),_0x2c9756[_0x32e5cf(0x1b5)][_0x32e5cf(0x1b7)]=_0x32e5cf(0x228),_0x2c9756[_0x32e5cf(0x1b5)][_0x32e5cf(0x23d)]=_0x32e5cf(0x228),_0x2c9756[_0x32e5cf(0x1b5)][_0x32e5cf(0x282)]=_0x32e5cf(0x228),_0x2c9756[_0x32e5cf(0x1b5)]['backgroundColor']='#000000',_0x2c9756[_0x32e5cf(0x1b5)][_0x32e5cf(0x1ed)]=0.3;!_0x33b8db['style'][_0x32e5cf(0x282)]&&!_0x33b8db[_0x32e5cf(0x1b5)][_0x32e5cf(0x1b3)]&&!_0x33b8db['style']['marginBottom']&&(_0x33b8db[_0x32e5cf(0x1b5)][_0x32e5cf(0x282)]=_0x32e5cf(0x2bd));const _0x1ac241=function(_0x248d39){const _0x316e18=_0x32e5cf,_0x1db141=_0x248d39[0x0],_0x4e4053=_0x248d39[_0x248d39[_0x316e18(0x281)]-0x1],_0x491a60=[_0x4e4053,_0x248d39,_0x1db141]['flat']();return _0x2c3c9b=>{const _0x22778b=_0x316e18;if(_0x2c3c9b[_0x22778b(0x27b)]===_0x22778b(0x1e1)&&!_0x2c3c9b[_0x22778b(0x2b8)]&&!_0x2c3c9b[_0x22778b(0x1a6)]&&!_0x2c3c9b['metaKey']){_0x2c3c9b[_0x22778b(0x287)](),_0x2c3c9b[_0x22778b(0x21a)]();const _0x10ba6c=_0x491a60[_0x22778b(0x227)](_0x2c3c9b[_0x22778b(0x205)],0x1);_0x10ba6c===-0x1?(_0x2c3c9b[_0x22778b(0x1cc)]?_0x4e4053:_0x1db141)['focus']():_0x491a60[_0x10ba6c+(_0x2c3c9b['shiftKey']?-0x1:0x1)]['focus']();}else _0x2c3c9b[_0x22778b(0x27b)]==='Escape'&&!_0x2c3c9b[_0x22778b(0x2b8)]&&!_0x2c3c9b['ctrlKey']&&!_0x2c3c9b[_0x22778b(0x1cc)]&&!_0x2c3c9b['metaKey']&&(_0x2c3c9b[_0x22778b(0x287)](),_0x2c3c9b[_0x22778b(0x21a)](),_0x294b17[_0x22778b(0x1fe)]());};},_0x371db1=Array[_0x32e5cf(0x23e)](_0x6174c9)?_0x6174c9['concat'](_0x59de7e):_0x59de7e,_0x29b233=_0x1ac241(_0x371db1);_0x371db1[_0x32e5cf(0x1ee)](_0x363962,_0x2c9756)['forEach'](_0x2d79f0=>{const _0x27fce6=_0x32e5cf;_0x2d79f0[_0x27fce6(0x29a)](_0x27fce6(0x28e),_0x29b233),_0x2d79f0[_0x27fce6(0x29a)](_0x27fce6(0x204),_0x29b233);}),_0x3460b1['appendChild'](_0x2c9756),_0x3460b1[_0x32e5cf(0x25f)](_0x363962);const _0x13770a=window['getComputedStyle'](_0x363962),_0x1b6b06=_0x198043===window?{'width':window[_0x32e5cf(0x225)],'height':window['innerHeight']}:_0x198043[_0x32e5cf(0x1df)]();return _0x363962[_0x32e5cf(0x1b5)]['top']=(_0x1b6b06[_0x32e5cf(0x1e9)]-parseInt(_0x13770a[_0x32e5cf(0x1e9)],0xa))/0x2+'px',_0x363962[_0x32e5cf(0x1b5)][_0x32e5cf(0x1ae)]=(_0x1b6b06[_0x32e5cf(0x1f3)]-parseInt(_0x13770a[_0x32e5cf(0x1f3)],0xa))/0x2+'px',_0x333f8c||_0x402c51?_0x26e464[_0x32e5cf(0x1a7)]():_0x294b17[_0x32e5cf(0x1a7)](),new Promise((_0x53acbe,_0x224815)=>{const _0x5b9342=_0x32e5cf;_0x26e464[_0x5b9342(0x29a)](_0x5b9342(0x1fe),()=>{const _0x2fde9d=_0x5b9342;_0x59de7e['forEach'](_0x3f56c9=>_0x3f56c9[_0x2fde9d(0x1fd)](_0x2fde9d(0x1ef),'disabled')),_0x3460b1[_0x2fde9d(0x1f0)](_0x2c9756),_0x3460b1[_0x2fde9d(0x1f0)](_0x363962),_0x53acbe(!![]);}),_0x294b17[_0x5b9342(0x29a)](_0x5b9342(0x1fe),()=>{const _0x9271b1=_0x5b9342;_0x59de7e[_0x9271b1(0x2a2)](_0x23cdf9=>_0x23cdf9[_0x9271b1(0x1fd)](_0x9271b1(0x1ef),_0x9271b1(0x1ef))),_0x3460b1[_0x9271b1(0x1f0)](_0x2c9756),_0x3460b1[_0x9271b1(0x1f0)](_0x363962),_0x53acbe(![]);});});}const StorageKey=_0x252c6c(0x2ae),toReportFont=(_0x4efe77,_0xe9aed8)=>{const _0x412be2=_0x252c6c,_0x2311ca='sans-serif',_0x426091=!_0xe9aed8||_0xe9aed8===_0x2311ca?_0x2311ca:'\x22'+_0xe9aed8+_0x412be2(0x27d)+_0x2311ca;return _0x4efe77+_0x412be2(0x1d4)+_0x426091;};async function generateReportCanvas(_0x1aaf07,_0x4947cf,_0x5882d4,_0x406377){const _0x42176a=_0x252c6c,_0x267a7c=newElem(_0x42176a(0x2a7));{_0x267a7c['width']=_0x406377[_0x42176a(0x28d)],_0x267a7c[_0x42176a(0x1e9)]=_0x406377[_0x42176a(0x22b)];const _0x2a6892=_0x267a7c[_0x42176a(0x275)]('2d');_0x2a6892[_0x42176a(0x1da)]=_0x42176a(0x219),_0x2a6892[_0x42176a(0x298)](0x0,0x0,_0x406377[_0x42176a(0x28d)],_0x406377[_0x42176a(0x22b)]),_0x2a6892[_0x42176a(0x230)](_0x1aaf07,0x0,0x0,_0x406377[_0x42176a(0x28d)],_0x406377[_0x42176a(0x22b)]),_0x2a6892[_0x42176a(0x273)]=0.5,_0x2a6892[_0x42176a(0x1c1)]=0x1,_0x2a6892['strokeStyle']=_0x42176a(0x266),_0x2a6892[_0x42176a(0x240)](0x0,0x0),_0x2a6892[_0x42176a(0x1f7)](_0x267a7c['width'],0x0),_0x2a6892[_0x42176a(0x1f7)](_0x267a7c[_0x42176a(0x1f3)],_0x267a7c[_0x42176a(0x1e9)]),_0x2a6892[_0x42176a(0x1f7)](0x0,_0x267a7c['height']),_0x2a6892[_0x42176a(0x1f7)](0x0,0x0),_0x2a6892[_0x42176a(0x267)]();}const _0x4c09d0=newElem(_0x42176a(0x2a7));{_0x4c09d0[_0x42176a(0x1f3)]=_0x267a7c['width'],_0x4c09d0[_0x42176a(0x1e9)]=_0x267a7c[_0x42176a(0x1e9)];const _0x55cc59=_0x4c09d0[_0x42176a(0x275)]('2d');_0x55cc59['drawImage'](_0x267a7c,0x0,0x0);{_0x55cc59[_0x42176a(0x23c)](),_0x55cc59['font']=toReportFont(_0x406377['userNameFontSize'],_0x5882d4[_0x42176a(0x293)]);const _0x153cd3=_0x55cc59[_0x42176a(0x268)](_0x5882d4[_0x42176a(0x286)]),_0x3b939a=_0x406377[_0x42176a(0x1cd)]*Math['min'](0x1,Math[_0x42176a(0x2aa)](_0x406377['userNameAreaWidth']/_0x153cd3[_0x42176a(0x1f3)],_0x406377[_0x42176a(0x2b7)]/(_0x153cd3[_0x42176a(0x283)]+_0x153cd3[_0x42176a(0x247)])));_0x55cc59[_0x42176a(0x231)]='center',_0x55cc59[_0x42176a(0x241)]=_0x42176a(0x253),_0x55cc59['fillStyle']=_0x42176a(0x216),_0x55cc59['font']=toReportFont(_0x3b939a,_0x5882d4['fontName']);const _0x4e1c79=_0x55cc59['measureText'](_0x5882d4[_0x42176a(0x286)]);_0x55cc59[_0x42176a(0x2bf)](_0x5882d4[_0x42176a(0x286)],_0x406377[_0x42176a(0x1d8)],_0x406377['userNameBottomY']-_0x4e1c79[_0x42176a(0x247)]),_0x55cc59['restore']();}const _0x1a945e=newElem('canvas');{const _0x48ea18=_0x406377[_0x42176a(0x292)]*_0x406377[_0x42176a(0x1de)],_0x2c363a=_0x406377[_0x42176a(0x2af)]*_0x406377[_0x42176a(0x1de)];_0x1a945e[_0x42176a(0x1f3)]=_0x1a945e[_0x42176a(0x1e9)]=Math[_0x42176a(0x1ca)](_0x48ea18,_0x2c363a);const _0x58be3e=_0x1a945e[_0x42176a(0x275)]('2d');_0x58be3e['drawImage'](_0x4947cf,(_0x1a945e[_0x42176a(0x1f3)]-_0x48ea18)/0x2,(_0x1a945e[_0x42176a(0x1e9)]-_0x2c363a)/0x2,_0x48ea18,_0x2c363a);}let _0x10230c=(_0x58d794=>_0x58d794%0x14===0x0&&_0x58d794>=0x14?0x14:_0x58d794%0x14)(_0x5882d4[_0x42176a(0x269)]);for(let _0x3a1536=0x0;_0x10230c>0x0;_0x10230c-=0x5,_0x3a1536++){const _0x5c51cf=Math[_0x42176a(0x2aa)](_0x10230c,0x5);for(let _0x465585=0x0;_0x465585<_0x5c51cf;_0x465585++){const _0x981426=_0x406377['stampOffsetX']+_0x406377['stampStepX']*_0x465585-_0x406377[_0x42176a(0x220)]/0x2,_0x46c843=_0x406377[_0x42176a(0x22f)]+_0x406377['stampStepY']*_0x3a1536,_0x36e36d=_0x406377[_0x42176a(0x1b8)]+randomRangedInt(-_0x406377['stampRandomPosHalfRange'],_0x406377[_0x42176a(0x1a9)]),_0x3339de=_0x406377[_0x42176a(0x299)]+randomRangedInt(-_0x406377['stampRandomPosHalfRange'],_0x406377[_0x42176a(0x1a9)]);_0x5882d4[_0x42176a(0x20e)]?(_0x55cc59[_0x42176a(0x23c)](),_0x55cc59[_0x42176a(0x2c0)](_0x981426+_0x36e36d,_0x46c843+_0x3339de),_0x55cc59[_0x42176a(0x217)](0x2*Math['PI']*Math[_0x42176a(0x1d9)]()),_0x55cc59['drawImage'](_0x1a945e,-_0x36e36d,-_0x3339de),_0x55cc59[_0x42176a(0x24e)]()):_0x55cc59[_0x42176a(0x230)](_0x1a945e,_0x981426,_0x46c843);}}}{const _0x35bc80=newElem(_0x42176a(0x2a7));_0x35bc80[_0x42176a(0x1f3)]=_0x406377[_0x42176a(0x1d3)],_0x35bc80[_0x42176a(0x1e9)]=_0x406377[_0x42176a(0x257)];let _0x5f00f8=_0x35bc80[_0x42176a(0x275)]('2d');{_0x5f00f8['save'](),_0x5f00f8[_0x42176a(0x1da)]=_0x406377['reportTextColor'],_0x5f00f8[_0x42176a(0x2bc)]=toReportFont(_0x406377[_0x42176a(0x223)],_0x5882d4[_0x42176a(0x293)]),_0x5f00f8[_0x42176a(0x231)]=_0x42176a(0x2a6),_0x5f00f8[_0x42176a(0x241)]='bottom';const _0x3f3dd0=_0x5f00f8['measureText'](_0x406377['titleText']);_0x5f00f8[_0x42176a(0x2bf)](_0x406377['titleText'],_0x406377['reportWidth']/0x2,_0x406377[_0x42176a(0x262)]-_0x3f3dd0[_0x42176a(0x247)]),_0x5f00f8[_0x42176a(0x24e)]();}const _0x4bb2ff=Math[_0x42176a(0x1ca)](Math[_0x42176a(0x2b6)](_0x5882d4['drawingStampCount']/0x14),0x1);let _0xde668b;{const _0x5bd7f6=_0x406377['cardWidth']+(_0x4bb2ff-0x1)*_0x406377[_0x42176a(0x2a4)];_0xde668b=(_0x406377[_0x42176a(0x1d3)]-_0x5bd7f6)/0x2,Array[_0x42176a(0x2b0)]({'length':_0x4bb2ff-0x1},_0x2f0175=>_0x267a7c)['concat'](_0x4c09d0)['forEach']((_0x437282,_0x284770)=>{const _0x3b700e=_0x42176a;_0x5f00f8[_0x3b700e(0x230)](_0x437282,_0xde668b+_0x284770*_0x406377[_0x3b700e(0x2a4)],_0x406377[_0x3b700e(0x1c5)]+_0x284770*_0x406377['cardOffset']);});}const _0x23b5c7=_0x406377[_0x42176a(0x1c5)]+_0x406377['cardHeight']+_0x406377[_0x42176a(0x2a4)]*_0x4bb2ff+_0x406377[_0x42176a(0x1c6)];{_0x5f00f8[_0x42176a(0x23c)](),_0x5f00f8[_0x42176a(0x1da)]=_0x406377[_0x42176a(0x26e)],_0x5f00f8[_0x42176a(0x2bc)]=toReportFont(_0x406377[_0x42176a(0x1f8)],_0x5882d4[_0x42176a(0x293)]),_0x5f00f8[_0x42176a(0x241)]=_0x42176a(0x27a),_0x5f00f8['textAlign']=_0x42176a(0x1ae);const _0x2f8832=_0x42176a(0x202)+getDateForDisplay(new Date()),_0x4a0377=_0x5f00f8[_0x42176a(0x268)](_0x2f8832);_0x5f00f8[_0x42176a(0x2bf)](_0x2f8832,_0xde668b,_0x23b5c7-_0x4a0377[_0x42176a(0x247)]),_0x5f00f8[_0x42176a(0x231)]='right';const _0xd1bcfd='総スタンプ数：'+_0x5882d4[_0x42176a(0x288)],_0x4266f0=_0x5f00f8[_0x42176a(0x268)](_0xd1bcfd);_0x5f00f8['fillText'](_0xd1bcfd,_0x406377[_0x42176a(0x1d3)]-_0xde668b,_0x23b5c7-_0x4266f0[_0x42176a(0x247)]),_0x5f00f8[_0x42176a(0x24e)]();}const _0x9e8749=_0x23b5c7+_0x406377[_0x42176a(0x208)],_0x7d056d=newElem(_0x42176a(0x2a7));_0x7d056d[_0x42176a(0x1f3)]=_0x35bc80[_0x42176a(0x1f3)],_0x7d056d[_0x42176a(0x1e9)]=_0x9e8749+_0x5882d4[_0x42176a(0x1cf)]['length']*_0x406377[_0x42176a(0x1b9)]+_0x406377['reportBottomMargin'],_0x5f00f8=_0x7d056d[_0x42176a(0x275)]('2d'),_0x5f00f8[_0x42176a(0x1da)]=_0x406377[_0x42176a(0x237)],_0x5f00f8['fillRect'](0x0,0x0,_0x406377[_0x42176a(0x1d3)],_0x7d056d[_0x42176a(0x1e9)]),_0x5f00f8[_0x42176a(0x230)](_0x35bc80,0x0,0x0);{_0x5f00f8['save'](),_0x5f00f8[_0x42176a(0x1da)]=_0x406377[_0x42176a(0x26e)],_0x5f00f8['font']=toReportFont(_0x406377[_0x42176a(0x1dd)],_0x5882d4['fontName']);const _0x2f573b=(_0x5ba2e3,_0xc0080a,_0x9834c7,_0x5401cc,_0x552eac)=>{const _0x767baa=_0x42176a;_0x5f00f8['measureText'](_0x5ba2e3)[_0x767baa(0x1f3)]>_0x5401cc?(_0x5f00f8[_0x767baa(0x23c)](),_0x5f00f8[_0x767baa(0x1eb)](),_0x5f00f8[_0x767baa(0x21e)](_0xc0080a,_0x9834c7-_0x552eac,_0x5401cc,_0x552eac*0x2),_0x5f00f8[_0x767baa(0x1fb)](),_0x5f00f8[_0x767baa(0x2bf)](_0x5ba2e3,_0xc0080a,_0x9834c7),_0x5f00f8[_0x767baa(0x24e)](),_0x5f00f8[_0x767baa(0x2bf)](_0x767baa(0x1d2),_0xc0080a+_0x5401cc+0x3,_0x9834c7)):_0x5f00f8[_0x767baa(0x2bf)](_0x5ba2e3,_0xc0080a,_0x9834c7);},_0x29464b=Array[_0x42176a(0x2b0)](new Set(_0x5882d4[_0x42176a(0x1cf)][_0x42176a(0x2a8)](_0x2007f5=>_0x2007f5[_0x42176a(0x22d)])))[_0x42176a(0x1b2)]((_0x52b76f,_0xa568cd)=>_0x5f00f8[_0x42176a(0x268)](toSignedIntString(_0xa568cd))['width'],0x0)+_0x406377[_0x42176a(0x251)],_0x5aa25d=_0x406377[_0x42176a(0x1dd)];_0x5882d4[_0x42176a(0x1cf)][_0x42176a(0x1b2)]((_0x4841e3,_0x3dc344,_0x2f0dcb)=>{const _0x3dcc0d=_0x42176a;return _0x5f00f8[_0x3dcc0d(0x231)]='right',_0x5f00f8[_0x3dcc0d(0x2bf)](_0x2f0dcb+0x1,_0x406377[_0x3dcc0d(0x28c)],_0x4841e3),_0x5f00f8[_0x3dcc0d(0x231)]=_0x3dcc0d(0x1ae),_0x5f00f8[_0x3dcc0d(0x2bf)](_0x3dc344[_0x3dcc0d(0x254)],_0x406377['logItemDateTextLeft'],_0x4841e3),_0x5f00f8[_0x3dcc0d(0x231)]=_0x3dcc0d(0x22a),_0x5f00f8['fillText'](toSignedIntString(_0x3dc344['ppt']),_0x406377[_0x3dcc0d(0x209)]+_0x29464b,_0x4841e3),_0x5f00f8[_0x3dcc0d(0x231)]='left',_0x2f573b(_0x3dc344['url'],_0x406377['logItemURLTextLeft']+_0x29464b,_0x4841e3,_0x406377[_0x3dcc0d(0x29f)],_0x5aa25d),_0x2f573b(_0x3dc344[_0x3dcc0d(0x1e8)],_0x406377[_0x3dcc0d(0x1e4)]+_0x29464b,_0x4841e3,_0x406377[_0x3dcc0d(0x261)]-_0x29464b,_0x5aa25d),_0x4841e3+_0x406377[_0x3dcc0d(0x1b9)];},_0x9e8749),_0x5f00f8[_0x42176a(0x24e)]();}return _0x7d056d;}}async function showReportImage(_0x41a50a,_0x25c592){const _0x11d1a4=_0x252c6c,_0x175fa6=newElem(_0x11d1a4(0x2a7));_0x175fa6['width']=_0x25c592[_0x11d1a4(0x1f3)],_0x175fa6[_0x11d1a4(0x1e9)]=_0x25c592[_0x11d1a4(0x1e9)],_0x175fa6[_0x11d1a4(0x275)]('2d')[_0x11d1a4(0x230)](_0x25c592,0x0,0x0),_0x175fa6[_0x11d1a4(0x29a)]('contextmenu',_0x2fe44a=>{const _0x457e10=_0x11d1a4;_0x2fe44a[_0x457e10(0x21a)]();}),document[_0x11d1a4(0x244)](_0x11d1a4(0x1ec))[_0x11d1a4(0x25f)](newElem('a',[_0x175fa6],[],{'download':_0x11d1a4(0x1bb)+getDateStringForFile(new Date()),'href':srcToURL(_0x175fa6[_0x11d1a4(0x294)]())}));}function generateCardAndStampImage(_0x7cf53b){const _0x2af04c=_0x252c6c,_0x26412b=newElem(_0x2af04c(0x2a7));{_0x26412b['width']=_0x7cf53b['cardWidth'],_0x26412b[_0x2af04c(0x1e9)]=_0x7cf53b[_0x2af04c(0x22b)];const _0x406af6=_0x26412b['getContext']('2d');_0x406af6[_0x2af04c(0x1da)]=_0x7cf53b[_0x2af04c(0x200)]['backgroundColor'],_0x406af6[_0x2af04c(0x298)](0x0,0x0,_0x7cf53b[_0x2af04c(0x28d)],_0x7cf53b[_0x2af04c(0x22b)]);{const _0x73db17=_0x7cf53b[_0x2af04c(0x243)]+_0x7cf53b[_0x2af04c(0x1b8)]-_0x7cf53b[_0x2af04c(0x1f5)]/0x2,_0x4695dd=_0x7cf53b['stampOffsetY']+_0x7cf53b[_0x2af04c(0x299)]-_0x7cf53b[_0x2af04c(0x2b2)]/0x2,_0x18136a=0x5*_0x7cf53b[_0x2af04c(0x1f5)],_0x1e8ea1=0x4*_0x7cf53b[_0x2af04c(0x2b2)],_0x4fb8ea=_0x7cf53b[_0x2af04c(0x200)][_0x2af04c(0x21c)];_0x406af6[_0x2af04c(0x23c)](),_0x406af6[_0x2af04c(0x1da)]=_0x7cf53b[_0x2af04c(0x200)][_0x2af04c(0x1ea)],_0x406af6['fillRect'](_0x73db17-_0x4fb8ea,_0x4695dd-_0x4fb8ea,_0x18136a+0x2*_0x4fb8ea,_0x1e8ea1+0x2*_0x4fb8ea),_0x406af6[_0x2af04c(0x1da)]=_0x2af04c(0x219),_0x406af6['fillRect'](_0x73db17,_0x4695dd,_0x18136a,_0x1e8ea1),_0x406af6[_0x2af04c(0x280)]=_0x7cf53b[_0x2af04c(0x200)]['innerBorderColor'],_0x406af6[_0x2af04c(0x1c1)]=_0x7cf53b[_0x2af04c(0x200)]['innerBorderWidth'],_0x406af6[_0x2af04c(0x1eb)]();for(let _0x7a26a9=0x1;_0x7a26a9<0x5;_0x7a26a9++){_0x406af6[_0x2af04c(0x240)](_0x73db17+_0x7a26a9*_0x7cf53b[_0x2af04c(0x1f5)],_0x4695dd),_0x406af6['lineTo'](_0x73db17+_0x7a26a9*_0x7cf53b[_0x2af04c(0x1f5)],_0x4695dd+_0x1e8ea1);}for(let _0x46d22c=0x1;_0x46d22c<0x4;_0x46d22c++){_0x406af6[_0x2af04c(0x240)](_0x73db17,_0x4695dd+_0x46d22c*_0x7cf53b[_0x2af04c(0x2b2)]),_0x406af6['lineTo'](_0x73db17+_0x18136a,_0x4695dd+_0x46d22c*_0x7cf53b[_0x2af04c(0x2b2)]);}_0x406af6[_0x2af04c(0x1da)]=_0x7cf53b[_0x2af04c(0x200)][_0x2af04c(0x20a)],_0x406af6['font']=toReportFont(_0x7cf53b[_0x2af04c(0x2b2)]*_0x7cf53b[_0x2af04c(0x200)][_0x2af04c(0x24c)],''),_0x406af6[_0x2af04c(0x231)]=_0x2af04c(0x22a),_0x406af6['textBaseline']=_0x2af04c(0x27a);for(let _0xb45b3d=0x0;_0xb45b3d<0x4;_0xb45b3d++){for(let _0x110267=0x0;_0x110267<0x5;_0x110267++){const _0x2fc2bb=0x5*_0xb45b3d+_0x110267+0x1,_0x1cd7e9=_0x406af6[_0x2af04c(0x268)](_0x2fc2bb);_0x406af6[_0x2af04c(0x2bf)](_0x2fc2bb,_0x73db17+(_0x110267+0x1)*_0x7cf53b[_0x2af04c(0x1f5)]-_0x7cf53b[_0x2af04c(0x200)][_0x2af04c(0x1fc)],_0x4695dd+(_0xb45b3d+0x1)*_0x7cf53b[_0x2af04c(0x2b2)]-_0x7cf53b[_0x2af04c(0x200)][_0x2af04c(0x2be)]-_0x1cd7e9[_0x2af04c(0x247)]);}}_0x406af6['stroke'](),_0x406af6['restore']();}{_0x406af6['save'](),_0x406af6[_0x2af04c(0x2bc)]=toReportFont(_0x7cf53b[_0x2af04c(0x200)][_0x2af04c(0x263)],_0x7cf53b[_0x2af04c(0x200)][_0x2af04c(0x295)]),_0x406af6[_0x2af04c(0x1da)]=_0x7cf53b[_0x2af04c(0x200)][_0x2af04c(0x20b)],_0x406af6['textBaseline']=_0x2af04c(0x27a);const _0x4c4114=_0x406af6[_0x2af04c(0x268)](_0x7cf53b[_0x2af04c(0x200)][_0x2af04c(0x212)]),_0x3f3da8=_0x7cf53b['userNameCenterX']-_0x7cf53b[_0x2af04c(0x260)]/0x2-_0x7cf53b[_0x2af04c(0x200)][_0x2af04c(0x296)]-_0x4c4114[_0x2af04c(0x1f3)],_0x599721=_0x7cf53b[_0x2af04c(0x1d8)]+_0x7cf53b[_0x2af04c(0x260)]/0x2;_0x406af6['fillText'](_0x7cf53b[_0x2af04c(0x200)][_0x2af04c(0x212)],_0x3f3da8,_0x7cf53b[_0x2af04c(0x233)]-_0x4c4114[_0x2af04c(0x247)]);const _0x38791e=_0x7cf53b['userNameBottomY']+_0x7cf53b[_0x2af04c(0x200)][_0x2af04c(0x1c8)];_0x406af6[_0x2af04c(0x280)]=_0x7cf53b[_0x2af04c(0x200)]['nameLabelColor'],_0x406af6[_0x2af04c(0x1c1)]=_0x7cf53b[_0x2af04c(0x200)][_0x2af04c(0x1e2)],_0x406af6['beginPath'](),_0x406af6[_0x2af04c(0x240)](_0x3f3da8-_0x7cf53b[_0x2af04c(0x200)][_0x2af04c(0x1be)],_0x38791e),_0x406af6['lineTo'](_0x599721+_0x7cf53b[_0x2af04c(0x200)]['nameLabelMarginHorizontal'],_0x38791e),_0x406af6[_0x2af04c(0x267)](),_0x406af6[_0x2af04c(0x24e)]();}}const _0xfae107=newElem(_0x2af04c(0x2a7));{_0xfae107['width']=_0x7cf53b[_0x2af04c(0x292)],_0xfae107[_0x2af04c(0x1e9)]=_0x7cf53b[_0x2af04c(0x2af)];const _0x7dfd46=_0xfae107[_0x2af04c(0x275)]('2d');_0x7dfd46[_0x2af04c(0x280)]=_0x7cf53b[_0x2af04c(0x21b)][_0x2af04c(0x27f)],_0x7dfd46[_0x2af04c(0x1c1)]=_0x7cf53b[_0x2af04c(0x21b)][_0x2af04c(0x1dc)],_0x7dfd46[_0x2af04c(0x1eb)](),_0x7dfd46[_0x2af04c(0x222)](_0x7cf53b['stampWidth']/0x2,_0x7cf53b[_0x2af04c(0x2af)]/0x2,_0x7cf53b[_0x2af04c(0x21b)]['circleRadius'],0x0,Math['PI']*0x2),_0x7dfd46[_0x2af04c(0x267)](),_0x7dfd46[_0x2af04c(0x1da)]=_0x7cf53b['selfmadeStamp'][_0x2af04c(0x27f)],_0x7dfd46['textAlign']=_0x2af04c(0x2a6),_0x7dfd46[_0x2af04c(0x241)]=_0x2af04c(0x27a),_0x7dfd46[_0x2af04c(0x2bc)]=toReportFont(_0x7cf53b[_0x2af04c(0x21b)]['fontSize'],'');const _0x2f230b=_0x7dfd46[_0x2af04c(0x268)](_0x7cf53b[_0x2af04c(0x21b)][_0x2af04c(0x1f1)]);_0x7dfd46[_0x2af04c(0x2bf)](_0x7cf53b[_0x2af04c(0x21b)][_0x2af04c(0x1f1)],_0x7cf53b[_0x2af04c(0x292)]/0x2,_0x7cf53b[_0x2af04c(0x2af)]/0x2+(_0x2f230b[_0x2af04c(0x283)]-_0x2f230b[_0x2af04c(0x247)])/0x2);}return[_0x26412b,_0xfae107];}function _0x5000(_0x52df79,_0x31208f){const _0x1ca647=_0x1ca6();return _0x5000=function(_0x500046,_0x16b05c){_0x500046=_0x500046-0x1a5;let _0x86fdc0=_0x1ca647[_0x500046];return _0x86fdc0;},_0x5000(_0x52df79,_0x31208f);}(async _0x12d5eb=>{const _0x9bba6e=_0x252c6c,_0x39f82f=document[_0x9bba6e(0x244)](_0x9bba6e(0x23b)),_0x3b1344=document[_0x9bba6e(0x244)](_0x9bba6e(0x26c)),_0x1111c7=document[_0x9bba6e(0x244)]('#imageTypeSelector'),_0x2ffb50=document[_0x9bba6e(0x244)](_0x9bba6e(0x27c)),_0x34a9cc=document[_0x9bba6e(0x244)](_0x9bba6e(0x201)),_0x5e9419=document[_0x9bba6e(0x244)](_0x9bba6e(0x256)),_0x12868b=document[_0x9bba6e(0x244)]('#fontName'),_0x5b5bc2=document[_0x9bba6e(0x244)](_0x9bba6e(0x2a9)),_0x2354f4=document[_0x9bba6e(0x244)](_0x9bba6e(0x1ce)),_0x46c7eb=()=>{const _0x311186=_0x9bba6e;while(_0x2354f4['firstChild'])_0x2354f4[_0x311186(0x1f0)](_0x2354f4[_0x311186(0x239)]);_0x2354f4[_0x311186(0x2a1)]='';},_0x1bf577=_0x4d33d2=>{const _0x2a4ad6=_0x9bba6e,_0x3a44b2=_0x4d33d2[_0x2a4ad6(0x26d)]('\x0a')[_0x2a4ad6(0x2b3)]();_0x2354f4[_0x2a4ad6(0x25f)](newElem('p',[_0x3a44b2],[],{'style':_0x2a4ad6(0x28a)}));},_0x46aabe={};_0x46aabe[_0x9bba6e(0x1cf)]=[],_0x46aabe[_0x9bba6e(0x214)]=null;{const _0x3311d6=window[_0x9bba6e(0x1ff)]?JSON[_0x9bba6e(0x2ad)](window[_0x9bba6e(0x1ff)][_0x9bba6e(0x289)](StorageKey)):null,_0x15318b=(_0x98cd5e,_0x571f79)=>_0x3311d6?_0x3311d6[_0x98cd5e]??_0x571f79:_0x571f79,_0x3b455a=()=>{const _0x239f37=_0x9bba6e,_0x203e70=(_0x10be21,_0x1cd9f6)=>{const _0x35488a=_0x5000;return _0x10be21?(_0x5b5bc2[_0x35488a(0x265)](_0x35488a(0x1ef)),_0x5b5bc2[_0x35488a(0x1fd)](_0x35488a(0x234),_0x12d5eb[_0x35488a(0x2ba)][_0x35488a(0x1b0)][_0x35488a(0x1b4)])):(_0x5b5bc2[_0x35488a(0x1fd)]('disabled',_0x35488a(0x1ef)),_0x5b5bc2['setAttribute'](_0x35488a(0x234),_0x1cd9f6)),_0x10be21;};if(_0x1111c7[_0x239f37(0x1c2)]===_0x239f37(0x29b)){if(_0x34a9cc[_0x239f37(0x224)][_0x239f37(0x281)]<0x1)return _0x203e70(![],'カード画像が選択されていません。');if(_0x5e9419[_0x239f37(0x224)][_0x239f37(0x281)]<0x1)return _0x203e70(![],'スタンプ画像が選択されていません。');}return _0x203e70(!![]);};_0x12d5eb[_0x9bba6e(0x1ab)][_0x9bba6e(0x210)]?_0x39f82f[_0x9bba6e(0x1c2)]='的ちゃん':_0x39f82f[_0x9bba6e(0x1c2)]=_0x15318b('userName',_0x12d5eb[_0x9bba6e(0x2ac)][_0x9bba6e(0x286)]);_0x3b1344[_0x9bba6e(0x238)]=_0x15318b(_0x9bba6e(0x20e),_0x12d5eb[_0x9bba6e(0x2ac)][_0x9bba6e(0x20e)]),_0x3b1344[_0x9bba6e(0x250)]['tltpText']=_0x12d5eb[_0x9bba6e(0x2ba)][_0x9bba6e(0x1b0)][_0x9bba6e(0x24b)],_0x1111c7[_0x9bba6e(0x1c2)]=_0x15318b(_0x9bba6e(0x1bd),_0x12d5eb[_0x9bba6e(0x2ac)][_0x9bba6e(0x1bd)]);_0x1111c7[_0x9bba6e(0x24f)]===-0x1&&(_0x1111c7[_0x9bba6e(0x24f)]=0x0);const _0x30f44f=_0x15a5ee=>{const _0x51469f=_0x9bba6e;_0x2ffb50[_0x51469f(0x1b5)][_0x51469f(0x246)]=_0x1111c7['value']===_0x51469f(0x29b)?_0x51469f(0x25b):_0x51469f(0x2a5),_0x46c7eb(),_0x3b455a();};_0x1111c7[_0x9bba6e(0x29a)](_0x9bba6e(0x235),_0x30f44f),_0x30f44f(),[_0x34a9cc,_0x5e9419][_0x9bba6e(0x2a2)](_0x2538a6=>_0x2538a6[_0x9bba6e(0x29a)](_0x9bba6e(0x235),_0x3b455a)),_0x12868b['value']=_0x15318b(_0x9bba6e(0x293),_0x12d5eb[_0x9bba6e(0x2ac)]['fontName']);{_0x12d5eb[_0x9bba6e(0x1ab)][_0x9bba6e(0x210)]?(_0x46aabe['logEntries']=[],Array['from']({'length':_0x12d5eb['debugValues']['dummyStampCount']??0x64})[_0x9bba6e(0x1b2)]((_0x264383,_0x2b3701,_0x47e756)=>{const _0xbf4f2=_0x9bba6e,_0x2fc7ad=new Date(_0x264383);return _0x46aabe[_0xbf4f2(0x1cf)]['push']({'id':_0x47e756+0x1,'date':toValueFromDate(_0x2fc7ad),'ppt':_0x2fc7ad[_0xbf4f2(0x1bc)]()===0x6?0x2:0x1,'url':_0x12d5eb[_0xbf4f2(0x1ab)][_0xbf4f2(0x270)],'remarks':_0x2fc7ad[_0xbf4f2(0x1bc)]()===0x6?_0xbf4f2(0x272):_0xbf4f2(0x252)}),_0x264383+0x5265c00;},(_0x7635b0=>_0x7635b0-_0x7635b0%0x5265c00)(Date[_0x9bba6e(0x28b)]()))):(_0x46aabe[_0x9bba6e(0x1cf)]=_0x15318b(_0x9bba6e(0x1cf),[]),_0x46aabe[_0x9bba6e(0x1cf)]['forEach'](_0x5cff58=>_0x5cff58['ppt']=_0x5cff58[_0x9bba6e(0x22d)]??0x1)),_0x46aabe[_0x9bba6e(0x214)]=_0x46aabe[_0x9bba6e(0x1cf)]['reduce']((_0x3d09a4,_0xa6aa0e)=>Math[_0x9bba6e(0x1ca)](_0x3d09a4,_0xa6aa0e['id']),0x1),_0x46aabe['sortLogEntries']=()=>{_0x46aabe['logEntries']['sort']((_0x1ccebe,_0x4f2229)=>{const _0x4eae9f=_0x5000,_0x2475c1=_0x1ccebe[_0x4eae9f(0x254)][_0x4eae9f(0x221)](_0x4f2229[_0x4eae9f(0x254)]);return _0x2475c1===0x0?_0x1ccebe['id']-_0x4f2229['id']:_0x2475c1;});};}}{const _0x4c78f7=async(_0x5b3eb0,_0x5c37c2,_0x4b73fe=![])=>{const _0x2aceb0=_0x9bba6e,_0x146d55=newElem(_0x2aceb0(0x1d7),[],[],{'type':_0x2aceb0(0x254),'value':_0x5c37c2[_0x2aceb0(0x254)]??toValueFromDate(new Date())}),_0x51ada0=newElem(_0x2aceb0(0x1d7),[],['numberinput'],{'type':_0x2aceb0(0x1af),'value':_0x5c37c2['ppt']??0x1}),_0x5f307d=newElem(_0x2aceb0(0x1d7),[],['textinput'],{'type':_0x2aceb0(0x1f1),'value':_0x5c37c2['url']??''}),_0x14df6a=newElem(_0x2aceb0(0x1d7),[],[_0x2aceb0(0x213)],{'type':'text','value':_0x5c37c2['remarks']??''});_0x4b73fe&&(_0x146d55[_0x2aceb0(0x1fd)]('readonly',_0x2aceb0(0x21f)),_0x51ada0[_0x2aceb0(0x1fd)](_0x2aceb0(0x21f),_0x2aceb0(0x21f)),_0x5f307d['setAttribute'](_0x2aceb0(0x21f),_0x2aceb0(0x21f)),_0x14df6a[_0x2aceb0(0x1fd)](_0x2aceb0(0x21f),'readonly'));const _0x4fb888=newElem(_0x2aceb0(0x1c3),[newElem('p',[_0x5b3eb0],[],{'style':_0x2aceb0(0x271)}),newElem('label',['日付\x20',_0x146d55]),newElem('br'),newElem('label',[_0x2aceb0(0x279),_0x51ada0,newElem(_0x2aceb0(0x1c3),[_0x12d5eb[_0x2aceb0(0x2ba)][_0x2aceb0(0x1b0)][_0x2aceb0(0x29c)]],['tltp-for-prev-input'])]),newElem('br'),newElem(_0x2aceb0(0x215),['URL\x20',_0x5f307d,newElem(_0x2aceb0(0x1c3),[_0x12d5eb[_0x2aceb0(0x2ba)][_0x2aceb0(0x1b0)]['logEntryURL']],[_0x2aceb0(0x232)])]),newElem('br'),newElem(_0x2aceb0(0x215),[_0x2aceb0(0x1a5),_0x14df6a,newElem(_0x2aceb0(0x1c3),[_0x12d5eb[_0x2aceb0(0x2ba)][_0x2aceb0(0x1b0)][_0x2aceb0(0x2b4)]],[_0x2aceb0(0x232)])])]),_0x49e3a5=_0x4b73fe?![]:[_0x146d55,_0x51ada0,_0x5f307d,_0x14df6a],_0x991706=await showConfirmDialog(_0x4fb888,{'focusable':_0x49e3a5,'defaultIsYes':![]});if(_0x991706){if(!_0x146d55[_0x2aceb0(0x1c2)])return![];_0x5c37c2[_0x2aceb0(0x254)]=_0x146d55[_0x2aceb0(0x1c2)],_0x5c37c2[_0x2aceb0(0x22d)]=parseIntOr(_0x51ada0[_0x2aceb0(0x1c2)],0xa,0x0),_0x5c37c2[_0x2aceb0(0x2bb)]=_0x5f307d[_0x2aceb0(0x1c2)],_0x5c37c2[_0x2aceb0(0x1e8)]=_0x14df6a[_0x2aceb0(0x1c2)];}return _0x991706;},_0x4079a4=document[_0x9bba6e(0x244)](_0x9bba6e(0x22c)),_0xfb47ad=()=>{const _0x4152bf=_0x9bba6e;_0x4079a4[_0x4152bf(0x1f0)](_0x4079a4[_0x4152bf(0x244)](_0x4152bf(0x22e)));const _0x35733d=newElem(_0x4152bf(0x22e),_0x46aabe[_0x4152bf(0x1cf)][_0x4152bf(0x2a8)]((_0x1efaba,_0x5cfa65)=>{const _0x1c5c79=_0x4152bf,_0x11c571=newElem(_0x1c5c79(0x21d),['編集']);_0x11c571[_0x1c5c79(0x29a)](_0x1c5c79(0x1fe),async()=>{const _0x46ed7b=_0x1c5c79,_0x56db88=await _0x4c78f7('編集',_0x1efaba);_0x56db88&&(_0x46aabe[_0x46ed7b(0x1aa)](),_0xfb47ad());});const _0xed0f91=newElem('button',['削除']);return _0xed0f91['addEventListener'](_0x1c5c79(0x1fe),async()=>{const _0x319eb=_0x1c5c79,_0x3f1e26=_0x46aabe[_0x319eb(0x1cf)][_0x319eb(0x227)](_0x1efaba);if(_0x3f1e26!==-0x1){const _0x2ef892=await _0x4c78f7(_0x319eb(0x285),_0x1efaba,!![]);_0x2ef892&&(_0x46aabe[_0x319eb(0x1cf)][_0x319eb(0x1ac)](_0x3f1e26,0x1),_0xfb47ad());}}),newElem('tr',[newElem('td',[_0x5cfa65+0x1+''],[_0x1c5c79(0x1f2)]),newElem('td',[_0x1efaba[_0x1c5c79(0x254)]],['text-cell']),newElem('td',[toSignedIntString(_0x1efaba[_0x1c5c79(0x22d)])],[_0x1c5c79(0x1f2)]),newElem('td',[newElem('a',[_0x1efaba[_0x1c5c79(0x2bb)]],[_0x1c5c79(0x20d)],{'href':_0x1efaba[_0x1c5c79(0x2bb)]})]),newElem('td',[_0x1efaba['remarks']],[_0x1c5c79(0x20d)]),newElem('td',[_0x11c571,_0xed0f91])]);}));_0x4079a4['appendChild'](_0x35733d);},_0x5da25b=newElem('button',[_0x9bba6e(0x258)]);_0x4079a4[_0x9bba6e(0x244)](_0x9bba6e(0x290))[_0x9bba6e(0x25f)](newElem('tr',[newElem('th',[_0x9bba6e(0x264)]),newElem('th',['日付'],[_0x9bba6e(0x1c4),_0x9bba6e(0x1fa)],{'data-tltp-text':_0x12d5eb[_0x9bba6e(0x2ba)][_0x9bba6e(0x1b0)][_0x9bba6e(0x255)]}),newElem('th',[_0x9bba6e(0x22d)],[_0x9bba6e(0x1c4),_0x9bba6e(0x1fa)],{'data-tltp-text':_0x12d5eb[_0x9bba6e(0x2ba)][_0x9bba6e(0x1b0)][_0x9bba6e(0x29c)]}),newElem('th',[_0x9bba6e(0x26f)],['textinput',_0x9bba6e(0x1c4),'tltp-always'],{'data-tltp-text':_0x12d5eb[_0x9bba6e(0x2ba)][_0x9bba6e(0x1b0)][_0x9bba6e(0x1f4)]}),newElem('th',['備考'],[_0x9bba6e(0x213),_0x9bba6e(0x1c4),'tltp-always'],{'data-tltp-text':_0x12d5eb['helps']['tltpTexts'][_0x9bba6e(0x2b4)]}),newElem('th',[_0x5da25b])])),_0x5da25b[_0x9bba6e(0x29a)](_0x9bba6e(0x1fe),async()=>{const _0x59327a=_0x9bba6e,_0x2ca68e={'id':_0x46aabe[_0x59327a(0x214)]+0x1},_0x5d1b7f=await _0x4c78f7('追加',_0x2ca68e);_0x5d1b7f&&(_0x46aabe[_0x59327a(0x214)]+=0x1,_0x46aabe[_0x59327a(0x1cf)][_0x59327a(0x207)](_0x2ca68e),_0x46aabe[_0x59327a(0x1aa)](),_0xfb47ad());}),_0xfb47ad();}document[_0x9bba6e(0x244)](_0x9bba6e(0x28f))['addEventListener'](_0x9bba6e(0x1fe),async()=>{const _0x288d65=_0x9bba6e;removeChildren(document[_0x288d65(0x244)](_0x288d65(0x1ec)));}),document['querySelector'](_0x9bba6e(0x1f6))[_0x9bba6e(0x29a)]('click',async()=>{const _0x4b981e=_0x9bba6e;if(window['localStorage']){const _0x5dadc5={'userName':_0x39f82f[_0x4b981e(0x1c2)],'randomStamping':_0x3b1344['checked'],'logEntries':_0x46aabe[_0x4b981e(0x1cf)],'imageType':_0x1111c7['value']===_0x4b981e(0x29b)?_0x4b981e(0x1e0):_0x1111c7['value'],'fontName':_0x12868b[_0x4b981e(0x1c2)]};window['localStorage']['setItem'](StorageKey,JSON['stringify'](_0x5dadc5));}}),_0x5b5bc2[_0x9bba6e(0x29a)]('click',async()=>{const _0x322fa3=_0x9bba6e,_0x1a4e34=Object[_0x322fa3(0x1ba)]({},_0x12d5eb[_0x322fa3(0x1e5)][_0x322fa3(0x1e7)]),_0x34b25d=_0x46aabe[_0x322fa3(0x1cf)][_0x322fa3(0x1b2)]((_0x5e7b40,_0x48d5ce)=>_0x5e7b40+_0x48d5ce['ppt'],0x0),_0x52fdec={'randomStamping':_0x3b1344[_0x322fa3(0x238)],'fontName':_0x12868b['value'],'userName':_0x39f82f[_0x322fa3(0x1c2)]||'的ちゃん','logEntries':_0x46aabe['logEntries'],'stampCount':_0x34b25d,'drawingStampCount':getInnerValue(_0x34b25d,0x0,0x64)};_0x46c7eb();let _0x3ad59e,_0x718f95;const _0x250e30=_0x1111c7['value'];if(_0x250e30==='simple')[_0x3ad59e,_0x718f95]=generateCardAndStampImage(_0x1a4e34);else{const _0x5d757f=[{'fileInput':_0x34a9cc},{'fileInput':_0x5e9419}],_0x29b278=(await Promise[_0x322fa3(0x245)](_0x5d757f[_0x322fa3(0x2a8)](_0x560d72=>readInputFileSrc(_0x560d72[_0x322fa3(0x297)]['files'][0x0])['then'](loadSyncImage)[_0x322fa3(0x26b)](_0x1e6b93=>({'error':_0x1e6b93})))))['reduce']((_0x545a66,_0x456210,_0x26011e)=>{const _0x5d72f6=_0x322fa3;return _0x456210 instanceof HTMLImageElement?_0x5d757f[_0x26011e][_0x5d72f6(0x1c9)]=_0x456210:_0x545a66[_0x5d72f6(0x207)](_0x5d757f[_0x26011e][_0x5d72f6(0x297)][_0x5d72f6(0x224)][0x0]['name']),_0x545a66;},[]);if(_0x29b278[_0x322fa3(0x281)]>0x0){_0x1bf577([_0x322fa3(0x203)][_0x322fa3(0x1ee)](_0x29b278));return;}[_0x3ad59e,_0x718f95]=_0x5d757f[_0x322fa3(0x2a8)](_0x71b53c=>_0x71b53c[_0x322fa3(0x1c9)]);}const _0x2c5804=document[_0x322fa3(0x244)](_0x322fa3(0x1ec));removeChildren(_0x2c5804);const _0x418823=await generateReportCanvas(_0x3ad59e,_0x718f95,_0x52fdec,_0x1a4e34);await showReportImage(_0x2c5804,_0x418823);}),_0x12d5eb[_0x9bba6e(0x1ab)][_0x9bba6e(0x210)]&&_0x5b5bc2['click']();})(getInitValues());
    
    function getInitValues() {
      return {
        helps: {
          tltpTexts: {
            settingsRandomStamping: 'onの場合、ポポちゃんらしく元気に押印します！\noffの場合、正確に中心＆回転無しで押印します。',
            showReportOKMesage: '表示されたレポートをクリックで画像として保存できます。',
            
            logEntryDate: 'ポポイントを貰った日付 (土曜は２倍)',
            logEntryPopoint: 'ポポイント',
            logEntryURL: 'ポポイントを貰ったことを確認できる配信やツイートのURL',
            logEntryRemarks: '配信のタイムスタンプや貰った理由・メモなど',
          },
        },
        
        defaultValues: {
          userName: '',
          imageType:'simple',
          fontName: '',
          //fontName: 'たぬき油性マジック',
          randomStamping: true,
        },
        debugValues: {
          debugMode: false,
          dummyStampCount: 88, // 土曜日2倍を考慮して必ず100pptを超える日数
          dummyLogEntryURL: 'https://twitter.com/Popo_Ieiri/status/1464024238676144129',
        },
        pageOptions: {
          // 1カード20スタンプ＆最大100ポポイントは決め打ちで変更不可能とします
          layout: {
            // 参考にしたカード画像のサイズ
            cardWidth  : 1074,
            cardHeight :  649,
            stampWidth :  300,
            stampHeight:  250,
            // カード内の配置
            stampOffsetXRightMarginForNumber: 20, // スタンプが数字に被らないようにマス目の中心から左にずらす
            stampOffsetX:  70,
            stampOffsetY:  25,
            stampStepX  : 196, //192, 198, 203, 191
            stampStepY  : 125,
            stampSizeRate: 0.50,
            stampCenterX: 75,
            stampCenterY: 75,
            stampRandomPosHalfRange: 6,
            userNameCenterX: 800,
            userNameBottomY: 616,
            userNameAreaWidth : 444,
            userNameAreaHeight:  64,
            userNameFontSize: 60, // 最大値
            // レポート全体
            reportWidth : 1200,
            reportTempHeight: 2000,
            reportBottomMargin: 5,
            reportBackgroundColor: '#FFFFFF',
            reportTextColor: '#333333',
            titleText: 'ポポイントカード履歴',
            titleFontSize: 72,
            titleBottomY:  96,
            cardStartY: 135,
            cardOffset: 15,
            logSummaryYOffset: 80,
            logSummaryFontSize: 32,
            logEntryYOffset: 36,
            logEntryFontSize: 14,
            logEntryLineHeight: 18,
            logItemIndexTextRight  : 40,
            logItemDateTextLeft    : 65,
            logItemPopointRight    : 158,
            logItemPopointPadding  :   5,
            logItemURLTextLeft     : 175,
            logItemRemarksTextLeft : 680,
            logItemURLTextWidth    : 470,
            logItemRemarksTextWidth: 480,
            
            // カード画像自前作成
            selfmadeCard: {
              backgroundColor: '#FFC803',
              outerBorderColor: '#999999',
              innerBorderColor: '#CCCCCC',
              outerBorderWidth: 8,
              innerBorderWidth: 3,
              numberFontColor: '#CCCCCC',
              numberFontHeightRate: 0.34,
              numberPaddingRight: 5,
              numberPaddingBottom: 10,
              nameLabelColor: '#888888',
              nameLabelBorderWidth: 8,
              nameLabelPaddingRight: 8,
              nameLabelPaddingBottom: 12,
              nameLabelMarginHorizontal: 6,
              nameLabelText: 'なまえ',
              nameLabelFontSize: 42,
              nameLabelFontName: '',
            },
            // スタンプ画像自前作成
            selfmadeStamp: {
              color: '#EE9900',
              circleRadius: 110,
              circleLineWidth: 3,
              fontSize: 160,
              text: 'ポ',
            },
          },
          
          imageSets: [
            // 今のところ未実装
          ],
        },
      };
    }
  </script>
</body>
</html>
