<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>
  <title>コラ画像作るやつ (矩形で顔ハメ的な)</title>
  <link rel='stylesheet' href='../assets/tooltip.css' />
  <link rel='stylesheet' href='../assets/accordion.css' />
  <script src='../assets/opencv-v4.2.0.js'></script>
  <style>
    body {
      padding: 10px 10px 30px;
      margin: 0;
      overflow-y: scroll;
      font-size: 10pt;
    }
    h2 {
      margin-top: 0px;
    }
    
    #help .titleHeader {
      display: block;
      font-size: 1em;
      border-bottom: solid #999999 1px;
      margin-bottom: 0.2em;
      padding-left: 0.5em;
      background-color: #EEEEEE;
    }
    #help ul {
      margin-top: 0.2em;
      margin-bottom: 1em;
    }
    #help #supplementalHelpTitle {
      display: none;
    }
    #help #supplementalHelps {
      display: none;
    }
    
    #controller * {
      vertical-align: middle;
    }
    #controller input.size {
      text-align: right;
      width: 4em;
    }
    #controller > label {
      margin-bottom: 10px;
    }
    #controller select {
      padding-top   : 3px;
      padding-bottom: 3px;
    }
    #controller input[type="number"] {
      width: 4em;
      text-align: right;
    }
    #controller th {
     text-align: right;
    }
    #controller #supplement:not(:empty) {
      margin-top: 0.7em;
    }
    #overlapFile {
      display: inline-block;
      padding: 20px 120px 20px 20px;
      background-color: #CCCCCC;
    }
    
    #trimInputArea {
      display: none;
      padding: 10px;
    }
    #trimInputArea .line {
      margin-left:20%;
      width:80%;
    }
    #trimInputArea .line.top-and-bottom {
      display:flex;
      justify-content:center;
    }
    #trimInputArea .line.left-and-right {
      display:flex;
      justify-content:space-between;
    }
  </style>
</head>
<body>
  <h2>コラ画像作るやつ ver<span id='version'></span></h2>
  <div id='help' class='accordion-box'>
    <input id='help-accordion-check' class='accordion-check' type='checkbox' />
    <label for='help-accordion-check' class='accordion-ontime' >■Helpを隠す</label>
    <label for='help-accordion-check' class='accordion-offtime'>■Helpを表示</label>
    <div class='accordion-ontime' id='helpBody'>
      <div class='titleHeader'>全般的な注意</div>
      <ul>
        <li>任意の画像を重ねることができますが、自動で拡大縮小されるため<br>横縦の比率が適正でないと不自然に見える可能性があります。</li>
      </ul>
      <div class='titleHeader' id='supplementalHelpTitle'></div>
      <ul id='supplementalHelps'></ul>
    </div>
  </div>
  <div id='controller'>
    <table cellpadding='2' border='1'>
      <tr>
        <th>ベースの画像：</th>
        <td>
          <select id='collageSetSelector'></select>
          <div id='supplement'></div>
        </td>
      </tr>
      <tr>
        <th>重ねる画像：</th>
        <td>
          <label><input id='recurse' type='checkbox' />ベース画像自身を再帰的に重ねる</label>
          <div id='recurseArea'>
            <label><input id='recurseCount' type='number' min='1' /> 回</label><br />
            <label>回転：<select id='rotateOverlayImage'><option value=''>しない</option><option value='clockwise'>時計回り</option><option value='counterclockwise'>反時計回り</option></select></label>
          </div>
          <div id='overlapArea'>
            <input type='file' id='overlapFile' accept='image/*' /><br />
            <div id='trimInputArea'>
              <span>トリミングした範囲を重ねる：</span>
              <div class='line top-and-bottom'>
                <label>上 <input type='number' min='0' class='size' id='trimTop' /></label>
              </div>
              <div class='line left-and-right'>
                <label>左 <input type='number' min='0' class='size' id='trimLeft' /></label>
                <label>右 <input type='number' min='0' class='size' id='trimRight' /></label>
              </div>
              <div class='line top-and-bottom'>
                <label>下 <input type='number' min='0' class='size' id='trimBottom' /></label>
              </div>
            </div>
          </div>
        </td>
      </tr>
      <tr> <th>OpenCVの設定：</th> <td><label>interpolation <select id='interpolationSelector'></select></label></td> </tr>
      <tr> <th>画像処理の設定：</th> <td>
        <label>作業領域の倍率 <input id='workingMatRate' type='number' />倍</label><br />
        <label><input id='blur4Antialias' type='checkbox' />アンチエイリアスのために重ねた矩形箇所をぼかす</label>
      </td> </tr>
    </table>
    <button id='layerButton' class='tltp-on-hover tltp-disabled tltp-right' data-tltp-text=''>重ねる</button>
  </div>
  <hr />
  <div id='main'>
  </div>
  
  <script>
    const AppVersion = "1.0.0";
    document.querySelector('#version').textContent = AppVersion;
    
const _0x400a=['counterclockwise','baseImage','unexpected\x20mode=','#trimInputArea','clockwise','collageSets','resolve','targetMat','minY','height','checked','preventDefault','overSrcOrgMat','readAsDataURL','maxX','GaussianBlur','getPerspectiveTransform','min','interpolations','#supplementalHelpTitle','1jALxIh','onerror','push','test','Tokens','removeAttribute','default','722523OhElTJ','get','FileSelected','paramScript','firstChild','99LojScA','dstTri','workingMatRate','setAttribute','openHelp','INTER_CUBIC','width','#layerButton','#help-accordion-check','getDate','BORDER_TRANSPARENT','replace','Mat','split','has','overTargetRoiMat','max','35UWhqQs','beforeend','exec','persMat','drawImage','supplement','Rect','1041982bALaxK','#supplementalHelps','#recurse','forEach','overMat','map','block','CV_32FC2','overSrcRoiMat','getElementById','imread','appendChild','isFinite','#trimTop','set','minX','main','includes','画像に変換して保存','load','interpolation','donwload-help','defaultCount','error','hash','zeros','top','0px','#supplement','selected','#rotateOverlayImage','paramScriptName','copyTo','src','INTER_AREA','files','createElement','delete','from','rotateOverImage','left','span','7Eucfwc','#overlapFile','location','resize','cols','button','removeChild','srcTri','createTextNode','htmlHelps','recurse','padding','writebackArray','splice','charCodeAt','reduce','result','getSeconds','collage-','imshow','23763sLzTEo','roi','value','#overlapArea','Modes','textContent','display','ファイルを選択してください。','処理中です。しばらくお待ちください。','INTER_LINEAR','step','Size','getFullYear','string','InitialWait','CV_8UC4','add','unexpected\x20token=','find','baseMat','#trimBottom','data','keys','#collageSetSelector','getOwnPropertyNames','basePath','#recurseArea','none','classList','226508kTbIHR','userImage','#trimRight','writeback','canvasOutput','change','1027765PwCfSG','channels','style','toDataURL','disabled','blur4Antialias','boxSizing','createDocumentFragment','name','addEventListener','#workingMatRate','click','padStart','margin','BORDER_REPLICATE','querySelector','size','rows','warpPerspective','option','overlayPos4','#blur4Antialias','matFromArray','use','ucharPtr','blurMat','right','getHours','data-tltp-text','length','37031sMTQkp','171641oCXbir','Processing','canvas','searchParams'];const _0x1ea6=function(_0x3bd863,_0x456dce){_0x3bd863=_0x3bd863-0x1a2;let _0x400a75=_0x400a[_0x3bd863];return _0x400a75;};const _0x384b09=_0x1ea6;(function(_0x21da51,_0x118faa){const _0x46fcf3=_0x1ea6;while(!![]){try{const _0x4a945e=-parseInt(_0x46fcf3(0x1b1))*-parseInt(_0x46fcf3(0x236))+parseInt(_0x46fcf3(0x1b8))+-parseInt(_0x46fcf3(0x213))*-parseInt(_0x46fcf3(0x1ce))+-parseInt(_0x46fcf3(0x230))+parseInt(_0x46fcf3(0x1d5))+-parseInt(_0x46fcf3(0x255))*-parseInt(_0x46fcf3(0x1ff))+-parseInt(_0x46fcf3(0x254))*parseInt(_0x46fcf3(0x1bd));if(_0x4a945e===_0x118faa)break;else _0x21da51['push'](_0x21da51['shift']());}catch(_0x51468e){_0x21da51['push'](_0x21da51['shift']());}}}(_0x400a,0xe3c15));function loadSyncImage(_0x586a32,_0x4171df=new Image()){return new Promise((_0x300284,_0x1dba4c)=>{const _0x437dd5=_0x1ea6;_0x4171df['addEventListener'](_0x437dd5(0x1e8),()=>_0x300284(_0x4171df)),_0x4171df[_0x437dd5(0x23f)](_0x437dd5(0x1ec),_0x16b355=>_0x1dba4c(_0x16b355)),_0x4171df[_0x437dd5(0x1f6)]=_0x586a32;});}function readInputFileSrc(_0x40692a){return new Promise((_0x1ce61,_0x4392fe)=>{const _0x385eb5=_0x1ea6,_0x19ff4b=new FileReader();_0x19ff4b['onload']=()=>_0x1ce61(_0x19ff4b[_0x385eb5(0x20f)]),_0x19ff4b[_0x385eb5(0x1b2)]=_0x56c856=>_0x4392fe(_0x56c856),_0x19ff4b[_0x385eb5(0x1aa)](_0x40692a);});}function pad0String(_0x534e87,_0x3de36f){const _0xd86cf6=_0x1ea6;return _0x3de36f['toString']()[_0xd86cf6(0x242)](_0x534e87,'0');}function getDateStringForFile(_0x1121eb){const _0xb9137d=_0x1ea6;return''+_0x1121eb[_0xb9137d(0x21f)]()+pad0String(0x2,_0x1121eb['getMonth']()+0x1)+pad0String(0x2,_0x1121eb[_0xb9137d(0x1c6)]())+'-'+pad0String(0x2,_0x1121eb[_0xb9137d(0x251)]())+pad0String(0x2,_0x1121eb['getMinutes']())+pad0String(0x2,_0x1121eb[_0xb9137d(0x210)]());}function coalesce(){for(let _0x4512f4 of arguments){if(_0x4512f4!=null)return _0x4512f4;}return null;}function newElem(_0x45a7ef,_0x55af98=[],_0x41e4fe=[],_0x438faa={}){const _0x25dfc8=_0x1ea6,_0x21e438=document[_0x25dfc8(0x1f9)](_0x45a7ef);return _0x41e4fe[_0x25dfc8(0x253)]>0x0&&_0x21e438[_0x25dfc8(0x22f)]['add'](..._0x41e4fe),Object[_0x25dfc8(0x22b)](_0x438faa)['forEach'](_0x453fba=>{_0x21e438['setAttribute'](_0x453fba,_0x438faa[_0x453fba]);}),_0x55af98[_0x25dfc8(0x1d8)](_0xabb28a=>{const _0x28896d=_0x25dfc8;typeof _0xabb28a===_0x28896d(0x220)?_0x21e438[_0x28896d(0x1e0)](document[_0x28896d(0x207)](_0xabb28a)):_0x21e438['appendChild'](_0xabb28a);}),_0x21e438;}function createWatchDog(_0x111e87,_0x567774,_0xc12993){const _0x2b0861=_0x1ea6,_0x133dce=Object[_0x2b0861(0x229)](_0x567774),_0x44bcd2=Object[_0x2b0861(0x229)](_0xc12993),_0x251ec2=_0x133dce['reduce']((_0x2871c0,_0x2987c7)=>{return _0x2871c0[_0x2987c7]=_0x2987c7,_0x2871c0;},{}),_0x2c9d61=_0x44bcd2[_0x2b0861(0x20e)]((_0x298850,_0x1a3662)=>{return _0x298850[_0x1a3662]=_0x1a3662,_0x298850;},{}),_0x58c944=new Set();let _0x25572d,_0x16789c;function _0x223310(){const _0x3b690c=_0x2b0861,_0x2ca979=_0x16789c[_0x3b690c(0x225)](_0x5e7997=>!_0x58c944[_0x3b690c(0x1cb)](_0x5e7997));_0x2ca979?_0x111e87[_0x3b690c(0x1d8)](_0x34a8c2=>{const _0x2d2f8f=_0x3b690c;_0x34a8c2[_0x2d2f8f(0x1c0)](_0x2d2f8f(0x23a),_0x2d2f8f(0x23a)),_0x34a8c2[_0x2d2f8f(0x1c0)](_0x2d2f8f(0x252),_0x567774[_0x2ca979]);}):_0x111e87[_0x3b690c(0x1d8)](_0x5834d5=>{const _0x3276dc=_0x3b690c;_0x5834d5[_0x3276dc(0x1b6)](_0x3276dc(0x23a)),_0x5834d5[_0x3276dc(0x1c0)]('data-tltp-text','');});}function _0x4ed7a4(_0x47f7ec){const _0x52a5d7=_0x2b0861;if(!_0x44bcd2[_0x52a5d7(0x1e6)](_0x47f7ec))throw new Error(_0x52a5d7(0x25b)+_0x47f7ec);if(_0x47f7ec===_0x25572d)return null;else{const _0x25ec4b=_0x25572d;return _0x25572d=_0x47f7ec,_0x16789c=_0xc12993[_0x25572d],_0x223310(),_0x25ec4b;}}function _0x5026dc(_0x20fef4){const _0x15bd14=_0x2b0861;if(!_0x133dce[_0x15bd14(0x1e6)](_0x20fef4))throw new Error(_0x15bd14(0x224)+_0x20fef4);_0x58c944[_0x15bd14(0x223)](_0x20fef4),_0x223310();}function _0x22881c(_0x553e86){const _0x31804b=_0x2b0861;if(!_0x133dce['includes'](_0x553e86))throw new Error(_0x31804b(0x224)+_0x553e86);_0x58c944[_0x31804b(0x1fa)](_0x553e86),_0x223310();}function _0x4558bb(){_0x58c944['clear'](),_0x223310();}return _0x4ed7a4(_0x44bcd2[0x0]),_0x4558bb(),{'Tokens':_0x251ec2,'Modes':_0x2c9d61,'resolve':_0x5026dc,'wait':_0x22881c,'close':_0x4558bb,'use':_0x4ed7a4};}function overlay(_0x508ada,_0x26c9d1,_0x39ec96,_0x40553c,_0x33cd61=0x0,_0x58fc05=0x0){const _0x26be57=_0x1ea6,_0x575b1c=Math[_0x26be57(0x1ae)](_0x508ada[_0x26be57(0x203)]-_0x33cd61,_0x26c9d1[_0x26be57(0x203)]),_0x5c7831=Math[_0x26be57(0x1ae)](_0x508ada[_0x26be57(0x247)]-_0x58fc05,_0x26c9d1[_0x26be57(0x247)]),_0x51748f=_0x508ada[_0x26be57(0x203)],_0x2689e2=_0x508ada[_0x26be57(0x237)]();_0x508ada[_0x26be57(0x1f5)](_0x39ec96);for(let _0x4b1ab2=0x0;_0x4b1ab2<_0x575b1c;_0x4b1ab2+=0x1){for(let _0x2eb215=0x0;_0x2eb215<_0x5c7831;_0x2eb215+=0x1){const _0x1c8b69=_0x26c9d1[_0x26be57(0x24e)](_0x2eb215,_0x4b1ab2),_0x414743=_0x4b1ab2+_0x33cd61,_0x12b010=_0x2eb215+_0x58fc05;_0x1c8b69[0x3]!==0x0&&(!_0x40553c[_0x26be57(0x1cb)](_0x414743)||!_0x40553c[_0x26be57(0x1b9)](_0x414743)[_0x26be57(0x1e6)](_0x12b010))&&(_0x39ec96[_0x26be57(0x228)][_0x12b010*_0x51748f*_0x2689e2+_0x414743*_0x2689e2+0x0]=_0x1c8b69[0x0],_0x39ec96[_0x26be57(0x228)][_0x12b010*_0x51748f*_0x2689e2+_0x414743*_0x2689e2+0x1]=_0x1c8b69[0x1],_0x39ec96[_0x26be57(0x228)][_0x12b010*_0x51748f*_0x2689e2+_0x414743*_0x2689e2+0x2]=_0x1c8b69[0x2],_0x39ec96[_0x26be57(0x228)][_0x12b010*_0x51748f*_0x2689e2+_0x414743*_0x2689e2+0x3]=_0x1c8b69[0x3]);}}}function pos(_0x3c6fba,_0x388cdf){return{'x':_0x3c6fba,'y':_0x388cdf};}function createOverlayedImage(_0x1b6b07,_0x8f5b0b,_0x570678,_0x316022,_0x22aea5,_0x24db9d,_0x2532ad={},_0x59689a={}){const _0x14fd1c=_0x1ea6,_0x1bb90d={},_0x2f7d91=coalesce(_0x59689a[_0x14fd1c(0x1e9)],cv[_0x14fd1c(0x1f7)]),_0x4bbb9b=_0x2532ad[_0x14fd1c(0x1bf)]>0x0?_0x2532ad['workingMatRate']:0x1,_0x56ec08=_0x2532ad[_0x14fd1c(0x23b)]&&!![];_0x24db9d[_0x14fd1c(0x1c3)]=_0x24db9d[_0x14fd1c(0x250)]-_0x24db9d[_0x14fd1c(0x1fd)],_0x24db9d[_0x14fd1c(0x1a6)]=_0x24db9d['bottom']-_0x24db9d['top'];const _0x1a6b0a=[pos(0x0,0x0),pos(0x0,_0x24db9d[_0x14fd1c(0x1a6)]),pos(_0x24db9d['width'],_0x24db9d[_0x14fd1c(0x1a6)]),pos(_0x24db9d[_0x14fd1c(0x1c3)],0x0)];if(_0x2532ad[_0x14fd1c(0x1fc)]){if(_0x2532ad[_0x14fd1c(0x1fc)]===_0x14fd1c(0x25d))_0x1a6b0a[_0x14fd1c(0x20c)](_0x1a6b0a[_0x14fd1c(0x253)],0x0,_0x1a6b0a[_0x14fd1c(0x20c)](0x0,0x1)[0x0]);else _0x2532ad[_0x14fd1c(0x1fc)]===_0x14fd1c(0x259)&&_0x1a6b0a[_0x14fd1c(0x20c)](0x0,0x0,_0x1a6b0a[_0x14fd1c(0x20c)](-0x1,0x1)[0x0]);}const _0xe2f29a=(()=>{const _0x4d5e4d=_0x14fd1c,_0x480b05={'minX':_0x570678[_0x4d5e4d(0x1da)](_0x1928f4=>_0x1928f4['x'])[_0x4d5e4d(0x20e)]((_0x164555,_0x2fab6d)=>_0x164555<_0x2fab6d?_0x164555:_0x2fab6d),'minY':_0x570678[_0x4d5e4d(0x1da)](_0x3ae489=>_0x3ae489['y'])[_0x4d5e4d(0x20e)]((_0xedea4c,_0x1c79f3)=>_0xedea4c<_0x1c79f3?_0xedea4c:_0x1c79f3),'maxX':_0x570678[_0x4d5e4d(0x1da)](_0x154331=>_0x154331['x'])[_0x4d5e4d(0x20e)]((_0x437ba4,_0x5dafda)=>_0x437ba4>_0x5dafda?_0x437ba4:_0x5dafda),'maxY':_0x570678[_0x4d5e4d(0x1da)](_0x33ddce=>_0x33ddce['y'])['reduce']((_0x102787,_0x2bf941)=>_0x102787>_0x2bf941?_0x102787:_0x2bf941)};return _0x480b05[_0x4d5e4d(0x1c3)]=_0x480b05[_0x4d5e4d(0x1ab)]-_0x480b05['minX'],_0x480b05[_0x4d5e4d(0x1a6)]=_0x480b05['maxY']-_0x480b05[_0x4d5e4d(0x1a5)],_0x480b05;})(),_0x5cc999=_0x570678[_0x14fd1c(0x1da)](_0x4c45ae=>pos(_0x4c45ae['x']-_0xe2f29a[_0x14fd1c(0x1e4)],_0x4c45ae['y']-_0xe2f29a[_0x14fd1c(0x1a5)]))['map'](_0x5d1b00=>pos(_0x5d1b00['x']*_0x4bbb9b,_0x5d1b00['y']*_0x4bbb9b));try{_0x1bb90d[_0x14fd1c(0x226)]=cv['imread'](_0x1b6b07),_0x1bb90d[_0x14fd1c(0x1a9)]=cv[_0x14fd1c(0x1df)](_0x8f5b0b),_0x1bb90d[_0x14fd1c(0x1dd)]=_0x1bb90d['overSrcOrgMat'][_0x14fd1c(0x214)](new cv[(_0x14fd1c(0x1d4))](_0x24db9d['left'],_0x24db9d[_0x14fd1c(0x1ef)],_0x24db9d['width'],_0x24db9d[_0x14fd1c(0x1a6)])),_0x1bb90d[_0x14fd1c(0x1d1)]=cv[_0x14fd1c(0x1c9)][_0x14fd1c(0x1ee)](_0xe2f29a[_0x14fd1c(0x1a6)]*_0x4bbb9b,_0xe2f29a['width']*_0x4bbb9b,cv['CV_8UC4']),_0x1bb90d['blurMat']=cv[_0x14fd1c(0x1c9)][_0x14fd1c(0x1ee)](_0xe2f29a[_0x14fd1c(0x1a6)]*_0x4bbb9b,_0xe2f29a[_0x14fd1c(0x1c3)]*_0x4bbb9b,cv[_0x14fd1c(0x222)]),_0x1bb90d[_0x14fd1c(0x1d9)]=cv[_0x14fd1c(0x1c9)][_0x14fd1c(0x1ee)](_0xe2f29a[_0x14fd1c(0x1a6)],_0xe2f29a[_0x14fd1c(0x1c3)],cv['CV_8UC4']),_0x1bb90d['targetMat']=cv[_0x14fd1c(0x1c9)][_0x14fd1c(0x1ee)](_0x1b6b07['height'],_0x1b6b07['width'],cv[_0x14fd1c(0x222)]),_0x1bb90d[_0x14fd1c(0x206)]=cv[_0x14fd1c(0x24c)](0x4,0x1,cv['CV_32FC2'],[_0x1a6b0a[0x0]['x'],_0x1a6b0a[0x0]['y'],_0x1a6b0a[0x3]['x'],_0x1a6b0a[0x3]['y'],_0x1a6b0a[0x1]['x'],_0x1a6b0a[0x1]['y'],_0x1a6b0a[0x2]['x'],_0x1a6b0a[0x2]['y']]),_0x1bb90d['dstTri']=cv[_0x14fd1c(0x24c)](0x4,0x1,cv[_0x14fd1c(0x1dc)],[_0x5cc999[0x0]['x'],_0x5cc999[0x0]['y'],_0x5cc999[0x3]['x'],_0x5cc999[0x3]['y'],_0x5cc999[0x1]['x'],_0x5cc999[0x1]['y'],_0x5cc999[0x2]['x'],_0x5cc999[0x2]['y']]),_0x1bb90d['M']=cv[_0x14fd1c(0x1ad)](_0x1bb90d[_0x14fd1c(0x206)],_0x1bb90d[_0x14fd1c(0x1be)]),cv[_0x14fd1c(0x248)](_0x1bb90d[_0x14fd1c(0x1dd)],_0x1bb90d[_0x14fd1c(0x1d1)],_0x1bb90d['M'],_0x1bb90d[_0x14fd1c(0x1d1)][_0x14fd1c(0x246)](),_0x2f7d91,cv[_0x14fd1c(0x1c7)]),_0x4bbb9b===0x1?_0x1bb90d['persMat'][_0x14fd1c(0x1f5)](_0x1bb90d[_0x14fd1c(0x1d9)]):(cv[_0x14fd1c(0x1ac)](_0x1bb90d[_0x14fd1c(0x1d1)],_0x1bb90d[_0x14fd1c(0x24f)],new cv[(_0x14fd1c(0x21e))](0x3,0x3),0x0,0x0,cv[_0x14fd1c(0x244)]),cv[_0x14fd1c(0x202)](_0x1bb90d[_0x14fd1c(0x24f)],_0x1bb90d[_0x14fd1c(0x1d9)],_0x1bb90d['overMat'][_0x14fd1c(0x246)](),0x0,0x0,_0x2f7d91)),overlay(_0x1bb90d[_0x14fd1c(0x226)],_0x1bb90d[_0x14fd1c(0x1d9)],_0x1bb90d[_0x14fd1c(0x1a4)],_0x316022,_0xe2f29a['minX'],_0xe2f29a[_0x14fd1c(0x1a5)]),_0x56ec08&&(_0x1bb90d[_0x14fd1c(0x1cc)]=_0x1bb90d[_0x14fd1c(0x1a4)]['roi'](new cv[(_0x14fd1c(0x1d4))](_0xe2f29a[_0x14fd1c(0x1e4)],_0xe2f29a[_0x14fd1c(0x1a5)],_0xe2f29a[_0x14fd1c(0x1c3)],_0xe2f29a['height'])),cv['GaussianBlur'](_0x1bb90d[_0x14fd1c(0x1cc)],_0x1bb90d[_0x14fd1c(0x24f)],new cv[(_0x14fd1c(0x21e))](0x3,0x3),0x0,0x0,cv[_0x14fd1c(0x244)]),cv[_0x14fd1c(0x202)](_0x1bb90d[_0x14fd1c(0x24f)],_0x1bb90d[_0x14fd1c(0x1d9)],_0x1bb90d['overMat'][_0x14fd1c(0x246)](),0x0,0x0,_0x2f7d91),overlay(_0x1bb90d[_0x14fd1c(0x226)],_0x1bb90d[_0x14fd1c(0x1d9)],_0x1bb90d['targetMat'],_0x316022,_0xe2f29a[_0x14fd1c(0x1e4)],_0xe2f29a[_0x14fd1c(0x1a5)])),cv[_0x14fd1c(0x212)](_0x22aea5,_0x1bb90d[_0x14fd1c(0x1a4)]);}finally{for(let _0x2ae179 of Object['getOwnPropertyNames'](_0x1bb90d)){const _0x4dd99e=_0x1bb90d[_0x2ae179];_0x4dd99e&&_0x4dd99e[_0x14fd1c(0x1fa)]&&_0x4dd99e['delete']();}}}function toRelativeName(_0x3619f4){const _0x3f7eb4=_0x1ea6;return/:\/\//[_0x3f7eb4(0x1b4)](_0x3619f4)?_0x3619f4:/^[.\/]/[_0x3f7eb4(0x1b4)](_0x3619f4)?_0x3619f4:'./'+_0x3619f4;}const mainAreaId=_0x384b09(0x1e5),targetCanvasId=_0x384b09(0x234),parentAreaDiv=document[_0x384b09(0x1de)](mainAreaId);async function generateImageLink(_0x4f74a0,_0x482786){const _0x3a03d9=_0x384b09,_0x581e95=_0x3a03d9(0x1ea),_0x30c006=(_0x3d5e2b,_0x451a82)=>{const _0x38daaf=_0x3a03d9,_0x29eb3d=atob(_0x3d5e2b[_0x38daaf(0x1f6)]['split'](',')[0x1]),_0x2780c2=/:([a-zA-Z\/]+);/[_0x38daaf(0x1d0)](_0x3d5e2b[_0x38daaf(0x1f6)])[0x1],_0x4a2ce5=Uint8Array[_0x38daaf(0x1fb)](_0x29eb3d[_0x38daaf(0x1ca)](''),_0x21a14d=>_0x21a14d[_0x38daaf(0x20d)]()),_0x572284=new Blob([_0x4a2ce5],{'type':_0x2780c2});return newElem('a',[_0x3d5e2b],[],{'download':_0x451a82+getDateStringForFile(new Date()),'href':URL['createObjectURL'](_0x572284)});},_0x2c4467=document[_0x3a03d9(0x23d)]();_0x2c4467['appendChild'](newElem('p',['画像を右クリックなどで保存してください。'],[],{'id':_0x581e95})),_0x2c4467['appendChild'](_0x30c006(await loadSyncImage(_0x482786[_0x3a03d9(0x239)]()),_0x3a03d9(0x211)));while(_0x4f74a0[_0x3a03d9(0x1bc)]){_0x4f74a0['removeChild'](_0x4f74a0['firstChild']);}_0x4f74a0[_0x3a03d9(0x1e0)](_0x2c4467),window['location'][_0x3a03d9(0x1ed)]=_0x581e95;}(async function(_0x3c7369){const _0x81a691=_0x384b09,_0x5d33d2=new URL(window[_0x81a691(0x201)])[_0x81a691(0x258)][_0x81a691(0x1b9)](_0x81a691(0x1bb))||_0x3c7369[_0x81a691(0x1f4)],_0x411e44=toRelativeName(_0x5d33d2),_0x5b67dc=_0x411e44[_0x81a691(0x1c8)](/[^/]+$/,''),_0x4fba24=await import(_0x411e44);_0x3c7369[_0x81a691(0x1a2)]=_0x4fba24[_0x81a691(0x1b7)];function _0x44f843(){const _0x12d507=_0x81a691;while(parentAreaDiv[_0x12d507(0x1bc)]){parentAreaDiv[_0x12d507(0x205)](parentAreaDiv[_0x12d507(0x1bc)]);}const _0x564406=newElem(_0x12d507(0x257),[],[],{'id':targetCanvasId});_0x564406[_0x12d507(0x23f)]('contextmenu',_0x54c89e=>{const _0x1aef32=_0x12d507;_0x54c89e[_0x1aef32(0x1a8)]();}),_0x564406['style'][_0x12d507(0x23c)]='border-box',_0x564406[_0x12d507(0x238)][_0x12d507(0x243)]=_0x12d507(0x1f0),_0x564406[_0x12d507(0x238)][_0x12d507(0x20a)]=_0x12d507(0x1f0);const _0x5a87d7=newElem(_0x12d507(0x204),[_0x12d507(0x1e7)]);_0x5a87d7[_0x12d507(0x23f)](_0x12d507(0x241),()=>{generateImageLink(parentAreaDiv,_0x564406);}),parentAreaDiv[_0x12d507(0x1e0)](_0x564406),parentAreaDiv[_0x12d507(0x1e0)](newElem('br')),parentAreaDiv[_0x12d507(0x1e0)](_0x5a87d7),window[_0x12d507(0x201)][_0x12d507(0x1ed)]='';}{const _0x59fc6b=document['querySelector'](_0x81a691(0x1c5)),_0x1b509b=document[_0x81a691(0x245)](_0x81a691(0x1b0)),_0x2aee3b=document[_0x81a691(0x245)](_0x81a691(0x1d6)),_0x2791af=document[_0x81a691(0x245)](_0x81a691(0x22a)),_0x5db18e=document[_0x81a691(0x245)](_0x81a691(0x1f1)),_0xf9c4fa=document[_0x81a691(0x245)](_0x81a691(0x1d7)),_0x59ee07=document[_0x81a691(0x245)](_0x81a691(0x22d)),_0x46f231=document[_0x81a691(0x245)]('#recurseCount'),_0x5b1b72=document[_0x81a691(0x245)](_0x81a691(0x1f3)),_0x5a8472=document[_0x81a691(0x245)](_0x81a691(0x216)),_0x2b956b=document[_0x81a691(0x245)](_0x81a691(0x200)),_0x4c212d=document[_0x81a691(0x245)](_0x81a691(0x25c)),_0x47f091=document[_0x81a691(0x245)](_0x81a691(0x1e2)),_0x4a4817=document['querySelector']('#trimLeft'),_0x510a17=document[_0x81a691(0x245)](_0x81a691(0x232)),_0x56a0af=document[_0x81a691(0x245)](_0x81a691(0x227)),_0x3378d6=document['querySelector']('#interpolationSelector'),_0x20fbfa=document[_0x81a691(0x245)](_0x81a691(0x240)),_0x5a5e92=document['querySelector'](_0x81a691(0x24b)),_0x12c369=document['querySelector'](_0x81a691(0x1c4)),_0x4a0308=createWatchDog([_0x12c369],{'InitialWait':'画面初期化中です。','FileSelected':_0x81a691(0x21a),'Processing':_0x81a691(0x21b)},{'userImage':[_0x81a691(0x221),_0x81a691(0x1ba)],'recurse':['InitialWait'],'processing':[_0x81a691(0x221),_0x81a691(0x256)]}),_0x3f0395=()=>{const _0x5ea596=_0x81a691;_0xf9c4fa[_0x5ea596(0x1a7)]?(_0x59ee07['style']['display']=_0x5ea596(0x1db),_0x5a8472['style']['display']='none',_0x4a0308['use'](_0x4a0308[_0x5ea596(0x217)][_0x5ea596(0x209)])):(_0x59ee07['style'][_0x5ea596(0x219)]=_0x5ea596(0x22e),_0x5a8472['style']['display']='block',_0x4a0308['use'](_0x4a0308['Modes'][_0x5ea596(0x231)]));};_0xf9c4fa[_0x81a691(0x1a7)]=_0x3c7369[_0x81a691(0x209)][_0x81a691(0x1a7)],_0x46f231[_0x81a691(0x215)]=_0x3c7369[_0x81a691(0x209)][_0x81a691(0x1eb)],_0x3f0395(),_0xf9c4fa[_0x81a691(0x23f)]('input',_0x3f0395),_0x20fbfa[_0x81a691(0x215)]=0x1,_0x20fbfa[_0x81a691(0x1ae)]='0.1',_0x20fbfa[_0x81a691(0x21d)]=_0x20fbfa[_0x81a691(0x1ae)],_0x5a5e92['checked']=_0x3c7369[_0x81a691(0x23b)],_0x59fc6b['checked']=_0x3c7369[_0x81a691(0x1c1)];for(let _0x4a7170 of _0x3c7369[_0x81a691(0x1a2)]){_0x2791af['appendChild'](newElem(_0x81a691(0x249),[_0x4a7170['name']],[],{'value':_0x4a7170['id']}));}_0x2791af[_0x81a691(0x215)]=(_0x3c7369['collageSets'][_0x81a691(0x225)](_0x4ca1b9=>_0x4ca1b9['selected'])||_0x3c7369['collageSets'][0x0])['id'];let _0x1bfe21;const _0x3803f5=async function(){const _0x38cbff=_0x81a691;_0x1bfe21=_0x3c7369[_0x38cbff(0x1a2)][_0x38cbff(0x225)](_0x5cee10=>_0x5cee10['id']===_0x2791af[_0x38cbff(0x215)]);if(!_0x1bfe21['baseImage']){_0x1bfe21[_0x38cbff(0x25a)]=await loadSyncImage(_0x5b67dc+_0x1bfe21[_0x38cbff(0x22c)]),_0x1bfe21[_0x38cbff(0x233)]=new Map();while(_0x1bfe21[_0x38cbff(0x20b)]['length']>0x0){const _0x432752=_0x1bfe21[_0x38cbff(0x20b)][_0x38cbff(0x20c)](0x0,0x2);_0x1bfe21[_0x38cbff(0x233)][_0x38cbff(0x1cb)](_0x432752[0x0])?_0x1bfe21[_0x38cbff(0x233)][_0x38cbff(0x1b9)](_0x432752[0x0])[_0x38cbff(0x1b3)](_0x432752[0x1]):_0x1bfe21[_0x38cbff(0x233)][_0x38cbff(0x1e3)](_0x432752[0x0],[_0x432752[0x1]]);}}Number[_0x38cbff(0x1e1)](_0x1bfe21[_0x38cbff(0x1bf)])&&(_0x20fbfa[_0x38cbff(0x215)]=_0x1bfe21['workingMatRate']);{while(_0x5db18e[_0x38cbff(0x1bc)]){_0x5db18e['removeChild'](_0x5db18e['firstChild']);}_0x1bfe21[_0x38cbff(0x1d3)]&&_0x5db18e[_0x38cbff(0x1e0)](newElem(_0x38cbff(0x1fe),[_0x1bfe21[_0x38cbff(0x1d3)]]));if(_0x1bfe21[_0x38cbff(0x208)]&&_0x1bfe21['htmlHelps'][_0x38cbff(0x253)]>0x0){_0x1b509b[_0x38cbff(0x238)]['display']='block',_0x2aee3b[_0x38cbff(0x238)][_0x38cbff(0x219)]=_0x38cbff(0x1db),_0x1b509b[_0x38cbff(0x218)]=_0x1bfe21['name'];while(_0x2aee3b[_0x38cbff(0x1bc)]){_0x2aee3b[_0x38cbff(0x205)](_0x2aee3b['firstChild']);}_0x2aee3b[_0x38cbff(0x1e0)](_0x1bfe21[_0x38cbff(0x208)][_0x38cbff(0x20e)]((_0x794308,_0x1bbd44)=>{const _0x7532b2=_0x38cbff,_0x5bf464=newElem('li');return _0x5bf464['insertAdjacentHTML'](_0x7532b2(0x1cf),_0x1bbd44),_0x794308[_0x7532b2(0x1e0)](_0x5bf464),_0x794308;},document[_0x38cbff(0x23d)]()));}else{_0x1b509b['style'][_0x38cbff(0x219)]=_0x38cbff(0x22e),_0x2aee3b[_0x38cbff(0x238)][_0x38cbff(0x219)]=_0x38cbff(0x22e),_0x1b509b['textContent']='';while(_0x2aee3b['firstChild']){_0x2aee3b[_0x38cbff(0x205)](_0x2aee3b[_0x38cbff(0x1bc)]);}}}!document[_0x38cbff(0x245)](targetCanvasId)&&_0x44f843();const _0xf79671=document[_0x38cbff(0x1de)](targetCanvasId);_0xf79671[_0x38cbff(0x1c3)]=_0x1bfe21[_0x38cbff(0x25a)][_0x38cbff(0x1c3)],_0xf79671['height']=_0x1bfe21[_0x38cbff(0x25a)][_0x38cbff(0x1a6)];const _0xdcdb91=_0xf79671['getContext']('2d');_0xdcdb91[_0x38cbff(0x1d2)](_0x1bfe21['baseImage'],0x0,0x0);};_0x2791af[_0x81a691(0x23f)](_0x81a691(0x235),_0x3803f5),_0x3803f5();let _0x24a506;_0x2b956b['addEventListener']('change',async()=>{const _0x24cee4=_0x81a691;_0x2b956b[_0x24cee4(0x1f8)]['length']===0x1?(_0x24a506=await loadSyncImage(await readInputFileSrc(_0x2b956b[_0x24cee4(0x1f8)][0x0])),_0x4c212d['style'][_0x24cee4(0x219)]='block',_0x47f091[_0x24cee4(0x215)]='0',_0x47f091['max']=_0x24a506[_0x24cee4(0x1a6)],_0x4a4817[_0x24cee4(0x215)]='0',_0x4a4817[_0x24cee4(0x1cd)]=_0x24a506[_0x24cee4(0x1c3)],_0x510a17[_0x24cee4(0x215)]=_0x24a506['width'],_0x510a17[_0x24cee4(0x1cd)]=_0x24a506['width'],_0x56a0af[_0x24cee4(0x215)]=_0x24a506[_0x24cee4(0x1a6)],_0x56a0af[_0x24cee4(0x1cd)]=_0x24a506[_0x24cee4(0x1a6)],_0x4a0308[_0x24cee4(0x1a3)](_0x4a0308[_0x24cee4(0x1b5)]['FileSelected'])):(_0x4a0308['wait'](_0x4a0308[_0x24cee4(0x1b5)]['FileSelected']),_0x4c212d[_0x24cee4(0x238)][_0x24cee4(0x219)]=_0x24cee4(0x22e));});for(let _0x2c9f64 of _0x3c7369['interpolations']){_0x3378d6['appendChild'](newElem(_0x81a691(0x249),[_0x2c9f64[_0x81a691(0x23e)]],[],{'value':_0x2c9f64[_0x81a691(0x23e)]}));}_0x3378d6['value']=(_0x3c7369[_0x81a691(0x1af)][_0x81a691(0x225)](_0x26fef8=>_0x26fef8[_0x81a691(0x1f2)])||_0x3c7369[_0x81a691(0x1af)][0x0])[_0x81a691(0x23e)],_0x12c369[_0x81a691(0x23f)]('click',async function(){const _0x3cd892=_0x81a691,_0x12f63f=_0x4a0308['use'](_0x4a0308['Modes']['processing']);_0x2791af['setAttribute'](_0x3cd892(0x23a),_0x3cd892(0x23a));if(!document[_0x3cd892(0x1de)](targetCanvasId)){_0x44f843();const _0x1d7c74=document[_0x3cd892(0x1de)](targetCanvasId);_0x1d7c74[_0x3cd892(0x1c3)]=_0x1bfe21[_0x3cd892(0x25a)][_0x3cd892(0x1c3)],_0x1d7c74[_0x3cd892(0x1a6)]=_0x1bfe21[_0x3cd892(0x25a)][_0x3cd892(0x1a6)];}if(_0xf9c4fa[_0x3cd892(0x1a7)]){const _0x514461=parseInt(_0x46f231['value'],0xa);let _0x6ae2ae,_0x6739a3;_0x6739a3=document[_0x3cd892(0x1de)](targetCanvasId);for(let _0x2b1091=0x1;_0x2b1091<=_0x514461;_0x2b1091+=0x1){_0x2b1091==0x1?_0x6ae2ae=_0x1bfe21['baseImage']:_0x6ae2ae=await loadSyncImage(_0x6739a3[_0x3cd892(0x239)]()),_0x6739a3=document[_0x3cd892(0x1de)](targetCanvasId),createOverlayedImage(_0x1bfe21['baseImage'],_0x6ae2ae,_0x1bfe21[_0x3cd892(0x24a)],_0x1bfe21[_0x3cd892(0x233)],_0x6739a3,{'top':0x0,'left':0x0,'right':_0x6ae2ae[_0x3cd892(0x1c3)],'bottom':_0x6ae2ae['height']},{'workingMatRate':Number(_0x20fbfa['value']),'rotateOverImage':_0x5b1b72[_0x3cd892(0x215)],'blur4Antialias':_0x5a5e92[_0x3cd892(0x1a7)]},{'interpolation':cv[_0x3378d6['value']]});}}else createOverlayedImage(_0x1bfe21[_0x3cd892(0x25a)],_0x24a506,_0x1bfe21[_0x3cd892(0x24a)],_0x1bfe21[_0x3cd892(0x233)],document[_0x3cd892(0x1de)](targetCanvasId),{'top':parseInt(_0x47f091[_0x3cd892(0x215)],0xa),'left':parseInt(_0x4a4817[_0x3cd892(0x215)],0xa),'right':parseInt(_0x510a17['value'],0xa),'bottom':parseInt(_0x56a0af[_0x3cd892(0x215)],0xa)},{'workingMatRate':Number(_0x20fbfa['value']),'rotateOverImage':_0x5b1b72[_0x3cd892(0x215)],'blur4Antialias':_0x5a5e92['checked']},{'interpolation':cv[_0x3378d6['value']]});_0x4a0308[_0x3cd892(0x24d)](_0x12f63f),_0x2791af[_0x3cd892(0x1b6)](_0x3cd892(0x23a));}),_0x4a0308[_0x81a691(0x1a3)](_0x4a0308[_0x81a691(0x1b5)][_0x81a691(0x221)]);}}({'openHelp':!![],'recurse':{'checked':![],'defaultCount':0x3},'blur4Antialias':!![],'interpolations':[{'name':'INTER_NEAREST','selected':![]},{'name':_0x384b09(0x21c),'selected':![]},{'name':_0x384b09(0x1f7),'selected':![]},{'name':_0x384b09(0x1c2),'selected':!![]}],'paramScriptName':getDefaultPaamScriptPath()}));
    
    function getDefaultPaamScriptPath() {
      return 'res/collageSets.js';
    }
  </script>
</body>
</html>
